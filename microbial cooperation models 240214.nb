(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    422358,       9516]
NotebookOptionsPosition[    412155,       9340]
NotebookOutlinePosition[    412695,       9359]
CellTagsIndexPosition[    412652,       9356]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Cue-driven microbial cooperation and communication: Evolving quorum sensing \
with honest signalling\
\>", "Title",
 CellChangeTimes->{{3.811655387992401*^9, 3.8116554343424664`*^9}, 
   3.9169048451362042`*^9},ExpressionUUID->"70d7690e-4dc0-4eb2-a4be-\
733c3bf31cac"],

Cell["\<\
By: Cz\[AAcute]r\[AAcute]n, Tam\[AAcute]s and Scheuring, Istv\[AAcute]n and \
Zachar, Istv\[AAcute]n and Sz\[AAcute]mad\[OAcute], Szabolcs\
\>", "Text",
 CellChangeTimes->{
  3.916904893701723*^9},ExpressionUUID->"50f96ca6-1b50-46d9-84e5-\
81dd301c6c9b"],

Cell[TextData[StyleBox["Supplementary material",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.9169047910940323`*^9, 3.9169047950661926`*^9}, {
  3.916904914111879*^9, 
  3.916904943812991*^9}},ExpressionUUID->"a21ef56f-a7df-47a5-a8c8-\
81d8e4a55f51"],

Cell[TextData[{
 StyleBox["Last modified", "Text",
  FontWeight->"Bold"],
 StyleBox[": 2024 2. 14.\n", "Text"],
 StyleBox["Code written by",
  FontWeight->"Bold"],
 ": \n\tIstv\[AAcute]n Zachar\n\tistvan.zachar80@gmail.com \n\tHUN-REN \
Institute of Evolution, Centre for Ecological Research"
}], "Text",
 CellChangeTimes->{{3.9169049454958076`*^9, 
  3.916905012314609*^9}},ExpressionUUID->"863d7be9-c337-4100-8a53-\
5276d881a30d"],

Cell[CellGroupData[{

Cell["Model details", "Section",
 CellChangeTimes->{
  3.8116554452224813`*^9, {3.8116554802135305`*^9, 3.811655481443532*^9}, {
   3.88528353985506*^9, 
   3.885283540722726*^9}},ExpressionUUID->"29c07cb6-1388-4d0c-b2da-\
859cc1f93271"],

Cell["\<\
At the end in parentheses: corresponding parameter names in the stochastic \
simulation.\
\>", "Text",
 CellChangeTimes->{{3.8135532760286393`*^9, 3.81355336943877*^9}, {
   3.8136558393667154`*^9, 3.813655873856764*^9}, {3.813655924176834*^9, 
   3.8136559318368444`*^9}, {3.8610856454119797`*^9, 3.8610857371959095`*^9}, 
   3.8852835449222746`*^9},ExpressionUUID->"cbb891d0-c635-4351-ad2b-\
d133d3c07d5a"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["N", TraditionalForm]],ExpressionUUID->
  "e0ff60cc-7caf-46df-9df1-3fdb9f070b5a"],
 " (",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "ef975a77-4e64-4cd0-bd29-aa44596b1382"],
 "): random interacting group size (neighborhood size, including the focal \
individual);"
}], "Item",
 CellChangeTimes->{{3.8135532760286393`*^9, 3.81355336943877*^9}, {
  3.8136558393667154`*^9, 3.813655873856764*^9}, {3.813655924176834*^9, 
  3.8136559318368444`*^9}, {3.8610856454119797`*^9, 3.8610857371959095`*^9}, {
  3.885283551913409*^9, 
  3.885283561540623*^9}},ExpressionUUID->"2086680c-92a1-4ef2-92d9-\
5f09756b2de2"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "c"], TraditionalForm]],ExpressionUUID->
  "ef718ecb-79a4-4a5d-a64b-f1345943ad09"],
 " (",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],ExpressionUUID->
  "944fb395-2113-4718-93c4-996beb48607c"],
 ", ",
 Cell[BoxData[
  FormBox["\[Kappa]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7fea42ad-2581-40f7-ace0-43a4160f697c"],
 "): cooperation threshold (critical concentration) (",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "a7e59ff7-1cda-42af-890b-09b55bbb8bfb"],
 ");"
}], "Item",
 CellChangeTimes->{{3.8135532760286393`*^9, 3.81355336943877*^9}, {
  3.8136558393667154`*^9, 3.813655873856764*^9}, {3.813655924176834*^9, 
  3.8136559318368444`*^9}, {3.8610856454119797`*^9, 3.8610857371959095`*^9}, {
  3.8852835524967976`*^9, 
  3.8852835703133774`*^9}},ExpressionUUID->"268846a2-de3b-4a74-94de-\
266fb1d06774"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "0"], TraditionalForm]],ExpressionUUID->
  "39c5310d-f45a-44c1-b499-88f026263766"],
 " (",
 Cell[BoxData[
  FormBox["c0", TraditionalForm]],ExpressionUUID->
  "326e2909-61c1-4839-a70c-642fb94ef2bc"],
 "): baseline metabolic cost (",
 Cell[BoxData[
  FormBox["c0", TraditionalForm]],ExpressionUUID->
  "7b7482e6-6d9e-4f66-aa62-398975049e55"],
 ");"
}], "Item",
 CellChangeTimes->{{3.8135532760286393`*^9, 3.81355336943877*^9}, {
  3.8136558393667154`*^9, 3.813655873856764*^9}, {3.813655924176834*^9, 
  3.8136559318368444`*^9}, {3.8610856454119797`*^9, 3.8610857371959095`*^9}, {
  3.8852835530102425`*^9, 
  3.88528357383737*^9}},ExpressionUUID->"339474ea-7745-4a4a-ac08-\
04f3605ef33e"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["c", TraditionalForm]],ExpressionUUID->
  "e30ea18c-c7a2-4c2a-8ec9-255345e67910"],
 ": cost of signal detection (of cooperation) (",
 Cell[BoxData[
  FormBox["L", TraditionalForm]],ExpressionUUID->
  "5bed6999-7b17-4b6a-8ce6-0ccbd7c545bc"],
 ");"
}], "Item",
 CellChangeTimes->{{3.8135532760286393`*^9, 3.81355336943877*^9}, {
  3.8136558393667154`*^9, 3.813655873856764*^9}, {3.813655924176834*^9, 
  3.8136559318368444`*^9}, {3.8610856454119797`*^9, 3.8610857371959095`*^9}, {
  3.885283553537781*^9, 
  3.885283580169236*^9}},ExpressionUUID->"9b54de51-51b9-44a1-9178-\
fc68f6b0075b"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["r", TraditionalForm]],ExpressionUUID->
  "ddfa16b2-d12d-461a-a6b1-77506be02766"],
 " or ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "9cd0d253-f792-40d2-b181-69fa42e2d342"],
 ": signal-detection (response) cost (",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "e3cfb792-50c5-447b-a921-1a966905b3b2"],
 ");"
}], "Item",
 CellChangeTimes->{{3.8135532760286393`*^9, 3.81355336943877*^9}, {
  3.8136558393667154`*^9, 3.813655873856764*^9}, {3.813655924176834*^9, 
  3.8136559318368444`*^9}, {3.8610856454119797`*^9, 3.8610857371959095`*^9}, {
  3.885283554053034*^9, 
  3.885283587273801*^9}},ExpressionUUID->"c86d9cf2-e412-4f48-9554-\
343a4a95e657"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "fb7ad2e2-d6c2-4fc9-a517-80dbaf80e19e"],
 ": benefit of cooperation (",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "10ed8130-b114-4795-bbf6-3b21b44a5f5c"],
 "); Only valid between 0 and 1!"
}], "Item",
 CellChangeTimes->{{3.8135532760286393`*^9, 3.81355336943877*^9}, {
   3.8136558393667154`*^9, 3.813655873856764*^9}, {3.813655924176834*^9, 
   3.8136559318368444`*^9}, {3.8610856454119797`*^9, 
   3.8610857371959095`*^9}, {3.885283554573258*^9, 3.8852835545752583`*^9}, 
   3.885283590129056*^9, {3.9083583257257557`*^9, 
   3.9083583348449636`*^9}},ExpressionUUID->"bc4501cc-a909-4595-a279-\
e4c411289739"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "4dcae1c3-4d4a-4704-8630-f701bcdbaec3"],
 ": dispersion rate (only used in the lattice model);"
}], "Item",
 CellChangeTimes->{{3.8135532760286393`*^9, 3.81355336943877*^9}, {
  3.8136558393667154`*^9, 3.813655873856764*^9}, {3.813655924176834*^9, 
  3.8136559318368444`*^9}, {3.8610856454119797`*^9, 3.8610857371959095`*^9}, {
  3.8852835928490844`*^9, 
  3.885283599684997*^9}},ExpressionUUID->"1799c1da-d2f7-4bbd-ac6c-\
9eb78cfb60e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplex manipulation", "Section",
 CellChangeTimes->{{3.780118250378688*^9, 3.780118253030692*^9}, 
   3.7952507118523684`*^9, {3.79525582942804*^9, 3.7952558426100636`*^9}, {
   3.8142463858905106`*^9, 3.8142463868845673`*^9}, {3.885283604072442*^9, 
   3.8852836068304715`*^9}},ExpressionUUID->"e534b636-9ea2-4e8e-9d87-\
2d8b2c719afa"],

Cell[TextData[{
 "\[OpenCurlyDoubleQuote]simplex\[CloseCurlyDoubleQuote] = 2D Cartesian \
coordinates on an equilateral triangle defined by ",
 Cell[BoxData[
  FormBox[
   StyleBox["coord",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "592cb4af-3c7e-479c-b789-66a4621b14b6"],
 "."
}], "Item",
 CellChangeTimes->{{3.8132984146851187`*^9, 3.8132984958686695`*^9}, {
   3.814257498103983*^9, 3.8142574986539836`*^9}, 3.861177657691004*^9, {
   3.885283340712393*^9, 
   3.8852833407133927`*^9}},ExpressionUUID->"f87658d0-34b4-4a47-a739-\
9bb22d0f674f"],

Cell["\<\
\"ternary\" = 3D simplex coordinates on an equilateral triangle, where \
coordinates total to 1.\
\>", "Item",
 CellChangeTimes->{{3.8132984146851187`*^9, 3.8132984958686695`*^9}, {
   3.814257498103983*^9, 3.8142574986539836`*^9}, 3.861177657691004*^9, {
   3.8852833413029966`*^9, 
   3.885283341303996*^9}},ExpressionUUID->"9c0393a7-193a-45a1-9ccc-\
319828ab561b"],

Cell["\<\
\"Cartesian\" = 2D Cartesian coordinates on a lower orthogonal triangle.\
\>", "Item",
 CellChangeTimes->{{3.8132984146851187`*^9, 3.8132984958686695`*^9}, {
   3.814257498103983*^9, 3.8142574986539836`*^9}, 
   3.861177657691004*^9},ExpressionUUID->"b039fcc2-020b-4973-a2fe-\
1e91ffd2dd92"],

Cell[CellGroupData[{

Cell["Definitions", "Subsection",
 CellChangeTimes->{{3.9079209832952943`*^9, 
  3.907920984372529*^9}},ExpressionUUID->"3441cbe2-3af0-4df4-aeea-\
ef08821e10c8"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "cartesianToSimplex", ",", "ternaryToSimplex", ",", "ternaryToCartesian",
       ",", "cartesianToTernary", ",", "simplexToTernary"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "randomTernaryPoint", ",", "randomSimplexPoint", ",", 
      "randomCartesianPoint"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"cartesianGrid", ",", "simplexGrid", ",", "ternaryGrid"}], "]"}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "graphicsToSimplex", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coord", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", 
         RowBox[{
          RowBox[{"Sqrt", "@", "3"}], "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coordCartesian", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SimplexPlotRange", "=", 
     RowBox[{"MinMax", "/@", 
      RowBox[{"Transpose", "@", "coord"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xmax", ",", "ymax"}], "}"}], "=", 
     RowBox[{"Max", "/@", "$SimplexPlotRange"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SimplexCenter", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{
        RowBox[{"Sqrt", "@", "3"}], "/", "4"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SimplexAspectRatio", "=", 
     RowBox[{"ymax", "/", "xmax"}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"aspect", " ", "ratio"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SimplexLabels", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<Lazy\>\"", ",", "\"\<Trusty\>\"", ",", "\"\<Smart\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SimplexCornerLabels", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"#1", ",", "#2", ",", "#3", ",", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "14"}], "]"}]}]}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"$SimplexLabels", ",", "coord", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "*", "1.5"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SimplexCornersCartesian", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"AbsolutePointSize", "@", "1"}], ",", 
          RowBox[{"Point", "@", "#2"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{"#1", ",", "#2", ",", "#3", ",", 
            RowBox[{"BaseStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Black", ",", "14"}], "]"}]}]}], "]"}]}], "}"}], "&"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"$SimplexLabels", ",", "coordCartesian", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "*", "1.5"}]}], "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SimplexBoundary", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsoluteThickness", "@", "2"}], ",", 
       RowBox[{"AbsolutePointSize", "@", "2"}], ",", 
       RowBox[{"Line", "@", 
        RowBox[{"PadRight", "[", 
         RowBox[{"coord", ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "2"}], "}"}], ",", "coord"}], "]"}]}], ",", 
       RowBox[{"Point", "@", "coord"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SimplexPolygon", "=", 
     RowBox[{"Polygon", "@", "coord"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SimplexRegion", "=", 
     RowBox[{"RegionConvert", "[", 
      RowBox[{"$SimplexPolygon", ",", "\"\<Implicit\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SimplexCartesianRegion", "=", 
     RowBox[{"MeshRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SimplexRegionFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            SqrtBox["3"], " ", "x"}], "2"], "+", 
          FractionBox["y", "2"]}], "\[LessEqual]", 
         FractionBox[
          SqrtBox["3"], "2"]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SqrtBox["3"], " ", "x"}], "2"]}], "+", 
          FractionBox["y", "2"]}], "\[LessEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"-", "y"}], "\[LessEqual]", "0"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "converts", " ", "orthogonal", " ", "lower", " ", "triangular", " ", 
     "Cartesian", " ", "2", "D", " ", "from", " ", "to", " ", "equilateral", 
     " ", "triangular", " ", "Cartesian", " ", "2", "D"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cartesianToSimplex", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x_", "?", "AtomQ"}], ",", 
        RowBox[{"y_", "?", "AtomQ"}]}], "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "0"}], "}"}], ".", "coord"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cartesianToSimplex", "[", "c_List", "]"}], ":=", 
     RowBox[{"cartesianToSimplex", "/@", "c"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "converts", " ", "3", "D", " ", "simplex", " ", "coordinates", " ", "to", 
     " ", "equilateral", " ", "triangular", " ", "Cartesian", " ", "2", "D"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ternaryToSimplex", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p_", "?", "AtomQ"}], ",", 
        RowBox[{"q_", "?", "AtomQ"}], ",", 
        RowBox[{"r_", "?", "AtomQ"}]}], "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"coord", "\[Transpose]"}], ".", 
      RowBox[{"Normalize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "q", ",", "r"}], "}"}], ",", "Total"}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ternaryToSimplex", "[", "c_List", "]"}], ":=", 
     RowBox[{"ternaryToSimplex", "/@", "c"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", " ", 
    RowBox[{
    "converts", " ", "3", "D", " ", "simplex", " ", "coordinates", " ", "to", 
     " ", "orthogonal", " ", "lower", " ", "triangular", " ", "Cartesian", 
     " ", "2", "D"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ternaryToCartesian", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p_", "?", "AtomQ"}], ",", 
        RowBox[{"q_", "?", "AtomQ"}], ",", 
        RowBox[{"r_", "?", "AtomQ"}]}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"p", ",", "q"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ternaryToCartesian", "[", "c_List", "]"}], ":=", 
     RowBox[{"ternaryToCartesian", "/@", "c"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "converts", " ", "orthogonal", " ", "lower", " ", "triangular", " ", 
     "Cartesian", " ", "2", "D", " ", "to", " ", "3", "D", " ", "simplex", 
     " ", "coodinates"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cartesianToTernary", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p_", "?", "AtomQ"}], ",", 
        RowBox[{"q_", "?", "AtomQ"}]}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"p", ",", "q", ",", 
       RowBox[{"1", "-", "p", "-", "q"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cartesianToTernary", "[", "c_List", "]"}], ":=", 
     RowBox[{"cartesianToTernary", "/@", "c"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "converts", " ", "equilateral", " ", "triangular", " ", "Cartesian", " ", 
     "2", "D", " ", "coordinates", " ", "to", " ", "3", "D", " ", "simplex", 
     " ", "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simplexToTernary", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x_", "?", "AtomQ"}], ",", 
        RowBox[{"y_", "?", "AtomQ"}]}], "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], "+", 
      RowBox[{"x", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "+", 
      RowBox[{"y", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", 
          RowBox[{"Sqrt", "@", "3"}]}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", 
          RowBox[{"Sqrt", "@", "3"}]}], ",", 
         RowBox[{"2", "/", 
          RowBox[{"Sqrt", "@", "3"}]}]}], "}"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simplexToTernary", "[", "c_List", "]"}], ":=", 
     RowBox[{"simplexToTernary", "/@", "c"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"randomTernaryPoint", "[", "n_Integer", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Normalize", "[", 
        RowBox[{"#", ",", "Total"}], "]"}], "&"}], "/@", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"ExponentialDistribution", "@", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "3"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"randomSimplexPoint", "[", "n_Integer", "]"}], ":=", 
     RowBox[{"ternaryToSimplex", "/@", 
      RowBox[{"randomTernaryPoint", "@", "n"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"randomCartesianPoint", "[", "n_Integer", "]"}], ":=", 
     RowBox[{"ternaryToCartesian", "/@", 
      RowBox[{"randomTernaryPoint", "@", "n"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cartesianGrid", "[", "d_", "]"}], ":=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", "d"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"1", "-", "i"}], ",", "d"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simplexGrid", "[", "d_", "]"}], ":=", 
     RowBox[{"cartesianToSimplex", "/@", 
      RowBox[{"cartesianGrid", "@", "d"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ternaryGrid", "[", "d_", "]"}], ":=", 
     RowBox[{"cartesianToTernary", "/@", 
      RowBox[{"cartesianGrid", "@", "d"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"graphicsToSimplex", "[", "g_", "]"}], ":=", 
     RowBox[{
      RowBox[{"g", "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Arrow", "[", "c_List", "]"}], "\[RuleDelayed]", 
          RowBox[{"Arrow", "[", 
           RowBox[{"cartesianToSimplex", "@", "c"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"y_", ",", "c_List", ",", "x___"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"Text", "[", 
           RowBox[{"y", ",", 
            RowBox[{"cartesianToSimplex", "@", "c"}], ",", "x"}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Point", "[", "c_List", "]"}], "\[RuleDelayed]", 
          RowBox[{"Point", "[", 
           RowBox[{"cartesianToSimplex", "@", "c"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Disk", "[", 
           RowBox[{"c_List", ",", "x___"}], "]"}], ":>", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"cartesianToSimplex", "@", "c"}], ",", "x"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GraphicsComplex", "[", 
         RowBox[{"c_List", ",", "x___"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"GraphicsComplex", "[", 
         RowBox[{
          RowBox[{"cartesianToSimplex", "/@", "c"}], ",", "x"}], "]"}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "ternaryGridCoordinate", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ternaryGridCoordinate", "::", "usage"}], "=", 
     "\"\<ternaryGridCoordinate[d, \[Sigma]] generates a list of equidistant \
ternary points with distance d, wiggling the point around the expected value \
with a Gaussian with SD = \[Sigma].\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ternaryGridCoordinate", "[", 
      RowBox[{
       RowBox[{"d", ":", 
        RowBox[{"(", 
         RowBox[{"_", "?", "NumberQ"}], ")"}], ":", 
        RowBox[{"1", "/", "10"}]}], ",", 
       RowBox[{"\[Sigma]_", ":", "0"}]}], "]"}], ":=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"\[Sigma]", "<=", "0"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "=", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"x", "=", 
                RowBox[{"Clip", "[", 
                 RowBox[{
                  RowBox[{"RandomVariate", "@", 
                   RowBox[{"NormalDistribution", "[", 
                    RowBox[{"i", ",", "\[Sigma]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"y", "=", 
                RowBox[{"Clip", "[", 
                 RowBox[{
                  RowBox[{"RandomVariate", "@", 
                   RowBox[{"NormalDistribution", "[", 
                    RowBox[{"j", ",", "\[Sigma]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"1", "-", "x"}]}], "}"}]}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"1", "-", "x", "-", "y"}]}], "}"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", "d"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"1", "-", "i"}], ",", "d"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7128988524081993`*^9, 3.712898974978279*^9}, 
   3.712899028580853*^9, {3.712899221653963*^9, 3.712899324109664*^9}, {
   3.712901159906414*^9, 3.71290116231283*^9}, {3.7129014439385443`*^9, 
   3.7129015475334697`*^9}, {3.71290157813422*^9, 3.712901587025728*^9}, {
   3.7129016600279036`*^9, 3.71290176556094*^9}, {3.7129063938416624`*^9, 
   3.7129063942876883`*^9}, {3.7129064441575403`*^9, 3.712906598999397*^9}, {
   3.712906656487685*^9, 3.7129066924737434`*^9}, {3.712906743308651*^9, 
   3.712906775654501*^9}, 3.7129068534269495`*^9, {3.712907121673292*^9, 
   3.712907142316473*^9}, {3.7129074406225348`*^9, 3.71290767569598*^9}, {
   3.712907720498543*^9, 3.7129077272569294`*^9}, {3.7129090481414795`*^9, 
   3.712909131880269*^9}, {3.7129091623960147`*^9, 3.7129091633200674`*^9}, {
   3.71290921615609*^9, 3.7129094106892166`*^9}, {3.7129094478093395`*^9, 
   3.7129094951910496`*^9}, 3.712909544708882*^9, {3.712913601397911*^9, 
   3.71291362166007*^9}, {3.7129136595882397`*^9, 3.7129136858847437`*^9}, {
   3.7129143788083763`*^9, 3.712914425919071*^9}, {3.712914465046309*^9, 
   3.7129144746738596`*^9}, {3.712914511027939*^9, 3.7129145575345993`*^9}, {
   3.7129146335589476`*^9, 3.7129146572113*^9}, {3.7129148106180744`*^9, 
   3.7129148617249975`*^9}, {3.7129151281482363`*^9, 3.712915177096036*^9}, {
   3.712916516783662*^9, 3.712916569938702*^9}, {3.712917832098893*^9, 
   3.7129178986467*^9}, {3.712917959513181*^9, 3.7129179715088673`*^9}, {
   3.7129184680392675`*^9, 3.712918528042699*^9}, {3.7129207085244155`*^9, 
   3.7129207889170136`*^9}, {3.712920907584801*^9, 3.7129210385402913`*^9}, {
   3.712921143800312*^9, 3.7129211949672384`*^9}, {3.71299093755571*^9, 
   3.712991014002537*^9}, {3.712991735499424*^9, 3.712991741302186*^9}, {
   3.71299177843685*^9, 3.712991817085967*^9}, 3.71299184991965*^9, {
   3.712991904037283*^9, 3.712991929784976*^9}, {3.712991967941709*^9, 
   3.7129920540927563`*^9}, {3.712992206729158*^9, 3.712992216853477*^9}, {
   3.7129922795445433`*^9, 3.712992291657662*^9}, {3.712992493258033*^9, 
   3.712992526817498*^9}, {3.71299255910505*^9, 3.712992614473853*^9}, {
   3.7129926472298098`*^9, 3.7129926969276752`*^9}, {3.7129927280595617`*^9, 
   3.7129927350467863`*^9}, {3.712992888611568*^9, 3.7129929821889753`*^9}, 
   3.712996237135991*^9, {3.7129963213540287`*^9, 3.7129963218928823`*^9}, {
   3.71299637394757*^9, 3.7129964782335443`*^9}, {3.712996732244549*^9, 
   3.712996732744384*^9}, {3.7129974236483593`*^9, 3.712997521267351*^9}, {
   3.71299878150066*^9, 3.712998781765644*^9}, {3.712998874235648*^9, 
   3.712998932139945*^9}, {3.7129990471060247`*^9, 3.712999047646446*^9}, {
   3.712999152156479*^9, 3.7129991536284103`*^9}, {3.712999227322372*^9, 
   3.712999230465135*^9}, {3.7129994959441633`*^9, 3.712999500478951*^9}, {
   3.712999543840272*^9, 3.712999574920445*^9}, {3.712999609340633*^9, 
   3.712999618951911*^9}, {3.7798051845285335`*^9, 3.7798051857436028`*^9}, {
   3.7798901732619886`*^9, 3.7798901762883935`*^9}, {3.7798902168640647`*^9, 
   3.779890267127353*^9}, 3.7798905116733828`*^9, {3.780033321771454*^9, 
   3.7800333238150578`*^9}, {3.7800335071153793`*^9, 
   3.7800335446958456`*^9}, {3.780037333838016*^9, 3.780037481382476*^9}, {
   3.78003757468624*^9, 3.780037575419441*^9}, {3.7800377612469673`*^9, 
   3.7800377875954137`*^9}, {3.7800378609623427`*^9, 
   3.7800378953916035`*^9}, {3.7800485755804462`*^9, 
   3.7800485796364527`*^9}, {3.780050509191242*^9, 3.780050559906931*^9}, {
   3.7801152640564423`*^9, 3.780115286130481*^9}, {3.7801154762636147`*^9, 
   3.7801154943908467`*^9}, {3.7801182019562025`*^9, 3.780118232969057*^9}, {
   3.780118269332721*^9, 3.780118272998728*^9}, {3.7801200225558014`*^9, 
   3.780120071352687*^9}, {3.78012060799463*^9, 3.780120608930631*^9}, {
   3.7801291166320376`*^9, 3.780129117643095*^9}, {3.795322718104843*^9, 
   3.7953227184928474`*^9}, {3.8116543086254797`*^9, 3.811654318557048*^9}, {
   3.8116552788422484`*^9, 3.8116552944822702`*^9}, {3.8117426372254457`*^9, 
   3.811742637305446*^9}, {3.811823451923377*^9, 3.8118234561233826`*^9}, {
   3.811826241023572*^9, 3.811826244903578*^9}, {3.8118298876266775`*^9, 
   3.811829887856678*^9}, {3.8118334305427485`*^9, 3.8118334454227695`*^9}, {
   3.8118334814428196`*^9, 3.8118334890428305`*^9}, {3.8118340302195883`*^9, 
   3.8118340667896395`*^9}, {3.811835340182422*^9, 3.8118353715224657`*^9}, {
   3.811835406312515*^9, 3.8118354073625164`*^9}, {3.811835439332561*^9, 
   3.811835496502641*^9}, {3.8118361595535693`*^9, 3.8118361661735783`*^9}, {
   3.81183623173367*^9, 3.8118362431236863`*^9}, {3.8129582344174676`*^9, 
   3.8129582428374796`*^9}, {3.8129583544476357`*^9, 3.8129583872076817`*^9}, 
   3.8129586417880383`*^9, {3.8129587027981234`*^9, 3.8129587085181313`*^9}, {
   3.8129592473208857`*^9, 3.81295927174092*^9}, {3.8129593050519667`*^9, 
   3.812959320181988*^9}, {3.8129593900630856`*^9, 3.812959492283229*^9}, {
   3.8132970845028152`*^9, 3.813297090945174*^9}, {3.8132975495097923`*^9, 
   3.813297550027821*^9}, {3.8132976137203817`*^9, 3.8132976147094374`*^9}, {
   3.813297674267771*^9, 3.8132977493499365`*^9}, {3.813297988902286*^9, 
   3.813298002971073*^9}, {3.8132980606723137`*^9, 3.813298133259378*^9}, {
   3.8132981792809625`*^9, 3.8132982428345118`*^9}, {3.813298346797336*^9, 
   3.813298371437716*^9}, {3.813298520232028*^9, 3.813298520560047*^9}, {
   3.8132988535057554`*^9, 3.8132990288696904`*^9}, {3.813299073324753*^9, 
   3.8132990766047573`*^9}, {3.8132991114858065`*^9, 3.813299145525854*^9}, {
   3.8176342544507327`*^9, 3.817634262690744*^9}, {3.817634305253088*^9, 
   3.8176343128830986`*^9}, {3.8176346099435143`*^9, 3.817634611013516*^9}, {
   3.8450129457821*^9, 3.8450130758829193`*^9}, {3.845013243483037*^9, 
   3.845013387618759*^9}, {3.845013460566865*^9, 3.8450134953266993`*^9}, {
   3.8450136742475414`*^9, 3.8450137359879646`*^9}, {3.845013940653386*^9, 
   3.84501401841671*^9}, {3.845014163458806*^9, 3.8450141746412034`*^9}, {
   3.861164710208809*^9, 3.861164719599571*^9}, {3.8611711836739674`*^9, 
   3.8611711852627325`*^9}, {3.8611720525043807`*^9, 
   3.8611720533694715`*^9}, {3.8611721386282883`*^9, 3.861172146922515*^9}, {
   3.8611785180158777`*^9, 3.8611786267153254`*^9}, {3.8611786594013033`*^9, 
   3.861178659892762*^9}, {3.861243427168317*^9, 3.8612434585355744`*^9}, {
   3.861243490373475*^9, 3.8612434929049187`*^9}, {3.861243524429837*^9, 
   3.8612435287675257`*^9}, {3.861244829076724*^9, 3.8612448299739323`*^9}, {
   3.8612453590240765`*^9, 3.86124543585474*^9}, {3.8612454791661615`*^9, 
   3.861245479318694*^9}, {3.8612459671029043`*^9, 3.861246030606716*^9}, {
   3.861246089911152*^9, 3.8612461195920773`*^9}, {3.8612462683597345`*^9, 
   3.86124628110853*^9}, 3.861247064932356*^9, {3.882437622513697*^9, 
   3.882437623672764*^9}, {3.8850255323714933`*^9, 3.8850255335593824`*^9}, 
   3.88502557292363*^9, {3.8852854964831705`*^9, 3.8852855188665233`*^9}, {
   3.8852855639421816`*^9, 3.8852855744322505`*^9}, {3.8852856511834345`*^9, 
   3.8852856743757257`*^9}, 3.9077450510638704`*^9, 3.9085248429498186`*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"abbfc219-d2db-4e84-9f80-a1ab6a4479eb"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mean-field model (analytic)", "Section",
 CellChangeTimes->{{3.9077435809657507`*^9, 
  3.907743587352319*^9}},ExpressionUUID->"e041ea1c-78ce-4044-bee5-\
1c7d582d2471"],

Cell[TextData[{
 "Coordinates are ALWAYS in the form: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"Lazy", ",", " ", "Trusty", ",", " ", "Smart"}], "}"}]}], 
   TraditionalForm]],ExpressionUUID->"d4c7ae93-5e7b-4726-b03c-9a444b379dc6"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", " ", "=", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "x", "-", "y"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"76b97405-8524-4fcd-a72f-f1009648d60d"],
 "."
}], "Item",
 CellChangeTimes->{{3.9077437575015917`*^9, 3.907743764478917*^9}, {
   3.9077438226869726`*^9, 3.907743831419729*^9}, {3.907744174564625*^9, 
   3.907744174564625*^9}, {3.907744316061431*^9, 3.9077443376202536`*^9}, {
   3.907744589923594*^9, 3.907744589923594*^9}, {3.907748108033249*^9, 
   3.90774812352587*^9}, 
   3.9079264678089056`*^9},ExpressionUUID->"5b6f323f-0447-4d33-b391-\
a505ed746527"],

Cell["Total concentration is rescaled to (0,1).", "Item",
 CellChangeTimes->{{3.9077437575015917`*^9, 3.907743764478917*^9}, {
  3.9077438226869726`*^9, 3.907743831419729*^9}, {3.90774417536521*^9, 
  3.907744183520088*^9}, {3.907750405921075*^9, 
  3.907750405921075*^9}},ExpressionUUID->"44f0b048-050e-4f3c-9387-\
254d37db0f76"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"X", " ", 
    RowBox[{"(", "a", ")"}]}], TraditionalForm]],ExpressionUUID->
  "66ea3720-85fa-4e77-85d4-322d80c58999"],
 ": sum of Tr and Sm: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "==", 
    RowBox[{"y", "+", 
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"7f77f6d6-b1c2-4884-9ea7-73ee18ded750"]
}], "Item",
 CellChangeTimes->{{3.9077437575015917`*^9, 3.907743764478917*^9}, {
  3.9077438226869726`*^9, 3.907743831419729*^9}, {3.907744174564625*^9, 
  3.907744174564625*^9}, {3.907744316061431*^9, 3.9077443376202536`*^9}, {
  3.9077445907089944`*^9, 3.9077445993018694`*^9}, {3.9077446478104963`*^9, 
  3.907744657396387*^9}, {3.907749805212676*^9, 3.9077498107370553`*^9}, {
  3.907750727664116*^9, 
  3.9077507434021454`*^9}},ExpressionUUID->"23c64fba-9dc1-40d5-934c-\
8ab4210e12ca"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "k"], " ", 
    RowBox[{"(", "k", ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "50a8984d-e2db-4ab9-8b43-1f8ae219c41d"],
 ": the cooperation threshold concentration"
}], "Item",
 CellChangeTimes->{{3.9077437575015917`*^9, 3.907743764478917*^9}, {
  3.9077438226869726`*^9, 3.907743831419729*^9}, {3.90774417536521*^9, 
  3.907744183520088*^9}, {3.90775040619112*^9, 3.9077504330904975`*^9}, {
  3.907750704263342*^9, 
  3.9077507501565647`*^9}},ExpressionUUID->"688b2df6-417b-4126-ac21-\
19975288786f"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"N", " ", 
    RowBox[{"(", "n", ")"}]}], TraditionalForm]],ExpressionUUID->
  "3b7b1845-d8bb-4961-9170-2803e8618e5e"],
 ": the neighborhood size, which is assumed to be small in this limit"
}], "Item",
 CellChangeTimes->{{3.9077437575015917`*^9, 3.907743764478917*^9}, {
  3.9077438226869726`*^9, 3.907743831419729*^9}, {3.90774417536521*^9, 
  3.907744183520088*^9}, {3.90775040619112*^9, 3.9077504330904975`*^9}, {
  3.907750704542471*^9, 3.907750762139806*^9}, {3.907753477167847*^9, 
  3.907753477167847*^9}, {3.9077536429885154`*^9, 3.9077536429885154`*^9}, {
  3.91689847606223*^9, 3.916898476463845*^9}, {3.9169023751098776`*^9, 
  3.916902375111867*^9}},ExpressionUUID->"d8a57532-619e-4bb3-94dc-\
ba126d848317"],

Cell[TextData[{
 "Since the cooperator density ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"y", " ", "+", " ", "z"}], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b727655b-f1b3-4adb-86e1-8a95d9bfea6b"],
 " is between ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", ",", "1"}], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "24ceb68f-667e-4728-9103-7122d76c7aed"],
 ", therefore ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a5ca838f-2456-4c25-9e16-6f1b30c5c655"],
 " must be rescaled so that the domain of the sigmoid function \[Sigma] is \
also scaled between ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", ",", "1"}], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d4caa135-914e-4839-9a0e-403c161dd643"],
 " too."
}], "Item",
 CellChangeTimes->{{3.9077437575015917`*^9, 3.907743764478917*^9}, {
  3.9077438226869726`*^9, 3.907743831419729*^9}, {3.90774417536521*^9, 
  3.907744183520088*^9}, {3.90775040619112*^9, 3.9077504330904975`*^9}, {
  3.907750704542471*^9, 3.907750762139806*^9}, {3.907753477167847*^9, 
  3.907753477167847*^9}, {3.9077536429885154`*^9, 3.9077536429885154`*^9}, {
  3.91689847606223*^9, 3.916898476463845*^9}, {3.916902376850668*^9, 
  3.9169024754830956`*^9}},ExpressionUUID->"0a90f1be-d92e-4de0-be71-\
c04995dfb716"],

Cell[CellGroupData[{

Cell["Definitions", "Subsection",
 CellChangeTimes->{{3.9077480910561466`*^9, 
  3.907748092543558*^9}},ExpressionUUID->"da53e5d3-a203-4658-be4c-\
c7425d3f10d0"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "w0", ",", "r", ",", "k", ",", "c", ",", "c0", ",", "b", ",", "n", ",", 
      "mf\[Theta]", ",", "mf\[Sigma]", ",", "mfwLa", ",", "mfwTr", ",", 
      "mfwSm", ",", "mfw", ",", "dLa", ",", "dTr", ",", "dSm", ",", "x", ",", 
      "y"}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mf\[Theta]", "[", "coop_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"coop", "\[GreaterEqual]", "k"}], ",", "1", ",", "0"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mf\[Sigma]", "[", "coop_", "]"}], ":=", 
     RowBox[{"LogisticSigmoid", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"coop", "-", "k"}], ")"}], "*", "100"}], "]"}]}], ";"}], " ", 
   
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"NOTE", ":", " ", 
      RowBox[{
      "If", " ", "Solve", " ", "chokes", " ", "on", " ", "the", " ", 
       "continuous", " ", "sigmoid", " ", "function", " ", "when", " ", 
       "calculating", " ", "fixed", " ", "points"}]}], ",", " ", 
     RowBox[{"use", " ", "mf\[Theta]", " ", 
      RowBox[{"instead", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Lazy", ",", " ", "Trusty", ",", " ", "Smart"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mfwLa", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"w0", "-", 
      RowBox[{"c0", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"b", "*", 
          RowBox[{"mf\[Sigma]", "[", 
           RowBox[{"y", "+", 
            RowBox[{"(", 
             RowBox[{"1", "-", "x", "-", "y"}], ")"}]}], "]"}]}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mfwTr", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"w0", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c0", "+", "c"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"b", "*", 
          RowBox[{"mf\[Sigma]", "[", 
           RowBox[{"y", "+", 
            RowBox[{"(", 
             RowBox[{"1", "-", "x", "-", "y"}], ")"}], "+", 
            RowBox[{"1", "/", "n"}]}], "]"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mfwSm", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"w0", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c0", "+", "r", "+", "c"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "b"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"mf\[Sigma]", "[", 
         RowBox[{"y", "+", 
          RowBox[{"(", 
           RowBox[{"1", "-", "x", "-", "y"}], ")"}], "+", 
          RowBox[{"1", "/", "n"}]}], "]"}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c0", "+", "r"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"mf\[Sigma]", "[", 
          RowBox[{"y", "+", 
           RowBox[{"(", 
            RowBox[{"1", "-", "x", "-", "y"}], ")"}], "+", 
           RowBox[{"1", "/", "n"}]}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Mean", " ", "fitness"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mfw", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"x", "*", 
       RowBox[{"mfwLa", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{"y", "*", 
       RowBox[{"mfwTr", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", 
       RowBox[{"mfwSm", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Growth", " ", "equations"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"dLa", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mfwLa", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "-", 
        RowBox[{"mfw", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], ")"}], "*", "x"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dTr", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mfwTr", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "-", 
        RowBox[{"mfw", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], ")"}], "*", "y"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dSm", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mfwSm", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "-", 
        RowBox[{"mfw", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"NOITE", ":", " ", 
      RowBox[{"Parameter", " ", 
       StyleBox["n",
        FontSlant->"Italic"], " ", "is", " ", "the", " ", "interction", " ", 
       "size"}]}], ",", " ", 
     RowBox[{"not", " ", "population", " ", "size"}], ",", " ", 
     RowBox[{"hence", " ", "it", " ", "is", " ", "set", " ", "to", " ", 
      RowBox[{"small", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$MFParameterSets", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<MF A\>\""}], ",", 
          RowBox[{"n", "\[Rule]", "9"}], ",", 
          RowBox[{"k", "\[Rule]", 
           RowBox[{"3", "/", "10"}]}], ",", 
          RowBox[{"c", "\[Rule]", 
           RowBox[{"3", "/", "10"}]}], ",", 
          RowBox[{"r", "\[Rule]", 
           RowBox[{"1", "/", "100"}]}], ",", 
          RowBox[{"b", "\[Rule]", 
           RowBox[{"3", "/", "10"}]}], ",", 
          RowBox[{"c0", "\[Rule]", "1"}], ",", 
          RowBox[{"w0", "->", "0"}]}], "\[RightAssociation]"}], ","}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<MF A\>\""}], ",", 
         RowBox[{"n", "\[Rule]", "9"}], ",", 
         RowBox[{"k", "\[Rule]", 
          RowBox[{"3", "/", "10"}]}], ",", 
         RowBox[{"c", "\[Rule]", 
          RowBox[{"3", "/", "10"}]}], ",", 
         RowBox[{"r", "\[Rule]", 
          RowBox[{"1", "/", "100"}]}], ",", 
         RowBox[{"b", "\[Rule]", 
          RowBox[{"1", "/", "10"}]}], ",", 
         RowBox[{"c0", "\[Rule]", "1"}], ",", 
         RowBox[{"w0", "->", "0"}]}], "\[RightAssociation]"}], ",", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"NOTE", ":", " ", 
          RowBox[{
          "This", " ", "is", " ", "not", " ", "the", " ", "same", " ", "as", 
           " ", "the", " ", "usual", " ", "\"\<A\>\""}]}], ",", " ", 
         RowBox[{
         "as", " ", "we", " ", "wanted", " ", "to", " ", "show", " ", "a", 
          " ", "case", " ", "where", " ", "La", " ", "does", " ", "not", " ", 
          
          RowBox[{"win", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<MF B\>\""}], ",", 
         RowBox[{"n", "\[Rule]", "9"}], ",", 
         RowBox[{"k", "\[Rule]", 
          RowBox[{"3", "/", "10"}]}], ",", 
         RowBox[{"c", "\[Rule]", 
          RowBox[{"3", "/", "10"}]}], ",", 
         RowBox[{"r", "\[Rule]", 
          RowBox[{"1", "/", "100"}]}], ",", 
         RowBox[{"b", "\[Rule]", 
          RowBox[{"1", "/", "2"}]}], ",", 
         RowBox[{"c0", "\[Rule]", "1"}], ",", 
         RowBox[{"w0", "->", "0"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<MF C\>\""}], ",", 
         RowBox[{"n", "\[Rule]", "9"}], ",", 
         RowBox[{"k", "\[Rule]", 
          RowBox[{"3", "/", "10"}]}], ",", 
         RowBox[{"c", "\[Rule]", 
          RowBox[{"3", "/", "10"}]}], ",", 
         RowBox[{"r", "\[Rule]", 
          RowBox[{"2", "/", "10"}]}], ",", 
         RowBox[{"b", "\[Rule]", 
          RowBox[{"65", "/", "100"}]}], ",", 
         RowBox[{"c0", "\[Rule]", "1"}], ",", 
         RowBox[{"w0", "->", "0"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<MF D\>\""}], ",", 
         RowBox[{"n", "\[Rule]", "9"}], ",", 
         RowBox[{"k", "\[Rule]", 
          RowBox[{"3", "/", "10"}]}], ",", 
         RowBox[{"c", "\[Rule]", 
          RowBox[{"3", "/", "10"}]}], ",", 
         RowBox[{"r", "\[Rule]", 
          RowBox[{"1", "/", "100"}]}], ",", 
         RowBox[{"b", "\[Rule]", 
          RowBox[{"6", "/", "10"}]}], ",", 
         RowBox[{"c0", "\[Rule]", "1"}], ",", 
         RowBox[{"w0", "->", "0"}]}], "\[RightAssociation]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"mf\[Sigma]", "@", "c"}], "/.", 
      RowBox[{"$MFParameterSets", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "0", ",", "1"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"NOTE", ":", " ", 
     RowBox[{
      RowBox[{"Condition", " ", "for", " ", "non"}], "-", "La", "-", 
      RowBox[{"win", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "/", "c"}], "<", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"c0", "+", "c"}], ")"}]}]}], "/.", "$MFParameterSets"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9077435887903137`*^9, 3.907743878494142*^9}, {
   3.907743973616173*^9, 3.907744152288514*^9}, {3.907744187341714*^9, 
   3.90774431451114*^9}, {3.907744378530224*^9, 3.907744404950953*^9}, {
   3.9077444919202924`*^9, 3.907744492672645*^9}, {3.907744540396998*^9, 
   3.9077445830019703`*^9}, {3.907744669766604*^9, 3.907744708057372*^9}, {
   3.9077451669406147`*^9, 3.9077452490155907`*^9}, {3.9077453383185053`*^9, 
   3.9077453385187902`*^9}, {3.907745956336579*^9, 3.907745981945143*^9}, {
   3.9077465698876276`*^9, 3.9077465746231556`*^9}, {3.9077486505332775`*^9, 
   3.9077486512011642`*^9}, {3.907750131294078*^9, 3.9077501313786044`*^9}, {
   3.9079288813439417`*^9, 3.907928897120862*^9}, 3.90852409127739*^9, {
   3.908524353614213*^9, 3.908524357528404*^9}, {3.9085244514015517`*^9, 
   3.908524451622182*^9}, {3.908525287190053*^9, 3.9085253053414907`*^9}, 
   3.9168962129039135`*^9, 3.916896370834584*^9, {3.916896458324762*^9, 
   3.916896466989169*^9}, {3.916896518435048*^9, 3.916896550407897*^9}, {
   3.9168971609701877`*^9, 3.9168971854683385`*^9}, {3.916897365659907*^9, 
   3.9168974156465244`*^9}, 3.9168975722913957`*^9, 3.9168978228221164`*^9, {
   3.9168979257677517`*^9, 3.9168979262970996`*^9}, {3.916897970232242*^9, 
   3.916898051774742*^9}, 3.916898155030133*^9, {3.916898319940359*^9, 
   3.916898328055642*^9}, {3.9168983960788946`*^9, 3.916898490811058*^9}, {
   3.916900910260716*^9, 3.916900940536788*^9}, {3.916901193863307*^9, 
   3.916901207343759*^9}, {3.9169012888403625`*^9, 3.9169013104896655`*^9}, {
   3.9169013768611393`*^9, 3.9169013897447186`*^9}, {3.9169014321786847`*^9, 
   3.9169014326970787`*^9}, {3.9169015167648573`*^9, 3.916901525133311*^9}, {
   3.91690194045306*^9, 3.916901943613511*^9}, {3.91690198274662*^9, 
   3.9169019921802845`*^9}, {3.9169020688045464`*^9, 
   3.9169020897078013`*^9}, {3.916902138090317*^9, 3.916902248715785*^9}},
 CellLabel->
  "In[465]:=",ExpressionUUID->"4cb064fb-5714-4cd8-9464-99c05db5a5e0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Seek", "Subsection",
 CellChangeTimes->{{3.9085964471328096`*^9, 
  3.9085964475061507`*^9}},ExpressionUUID->"d2cdc98f-99e0-4f93-b2e7-\
d5d42a756b9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "n", ",", "k", ",", "r", ",", "c", ",", "b", ",", "c0", ",", "w0", ",", 
     "la", ",", "tr"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"par2", "=", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "9999"}], ",", 
     RowBox[{"k", "\[Rule]", "3"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"c", "\[Rule]", 
        RowBox[{"3", "/", "10"}]}], ","}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"r", "\[Rule]", 
        RowBox[{"1", "/", "100"}]}], ","}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"b", "\[Rule]", 
        RowBox[{"3", "/", "10"}]}], ","}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"c0", "\[Rule]", "1"}], ","}], "*)"}], 
     RowBox[{"w0", "->", "0"}]}], "\[RightAssociation]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eq", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"dLa", "[", 
         RowBox[{"la", ",", "tr"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"dTr", "[", 
         RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{"dSm", "[", 
         RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
       RowBox[{"0", "<", "la", "<", "1"}], ",", 
       RowBox[{"0", "<", "tr", "<", "1"}]}], "}"}], "/.", "par2"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"3", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"1", "/", "100"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"3", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c0", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Grid", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<b\>\"", ",", 
       RowBox[{"Slider", "[", 
        RowBox[{
         RowBox[{"Dynamic", "@", "b"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"Spacer", "@", "10"}], ",", 
       RowBox[{"Dynamic", "@", "b"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<r\>\"", ",", 
       RowBox[{"Slider", "[", 
        RowBox[{
         RowBox[{"Dynamic", "@", "r"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Spacer", "@", "10"}], ",", 
       RowBox[{"Dynamic", "@", "r"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<c\>\"", ",", 
       RowBox[{"Slider", "[", 
        RowBox[{
         RowBox[{"Dynamic", "@", "c"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"Spacer", "@", "10"}], ",", 
       RowBox[{"Dynamic", "@", "c"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<c0\>\"", ",", 
       RowBox[{"Slider", "[", 
        RowBox[{
         RowBox[{"Dynamic", "@", "c0"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"Spacer", "@", "10"}], ",", 
       RowBox[{"Dynamic", "@", "c0"}]}], "}"}]}], "\[IndentingNewLine]", 
    "}"}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{
   RowBox[{"Column", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "r", ",", "c", ",", "c0"}], "}"}], "/.", "par2"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Quiet", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"la", ",", "tr", ",", 
          RowBox[{"1", "-", "la", "-", "tr"}]}], "}"}], "/.", 
        RowBox[{"NSolve", "[", 
         RowBox[{"eq", ",", 
          RowBox[{"{", 
           RowBox[{"la", ",", "tr"}], "}"}], ",", "Reals"}], "]"}]}], "]"}]}],
      "\[IndentingNewLine]", "}"}]}], ",", 
   RowBox[{"TrackedSymbols", ":>", 
    RowBox[{"{", 
     RowBox[{"b", ",", "r"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9085964541819773`*^9, 3.9085965798587775`*^9}, {
  3.908596726563497*^9, 3.9085971089301167`*^9}, {3.90859716898999*^9, 
  3.9085972497037783`*^9}, {3.9085975848087683`*^9, 3.908597630624302*^9}, {
  3.908599510763916*^9, 3.9085998180697465`*^9}, {3.9085999157083116`*^9, 
  3.9086002538596144`*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"ea293745-7669-49a3-86b1-fab1880f5ada"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixed point calculation", "Subsection",
 CellChangeTimes->{{3.9077453318584957`*^9, 
  3.907745333982261*^9}},ExpressionUUID->"15023f5c-8254-4db7-873d-\
c9e31942ad91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Figures\\\\MF\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$save", "=", 
    RowBox[{"Setting", "@", 
     CheckboxBox[False]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"par", "=", "#"}], ",", "fp", ",", "fx", ",", "fy", ",", "x",
          ",", "y", ",", 
         RowBox[{"\[CapitalDelta]", "=", ".1"}], ",", "plot", ",", 
         RowBox[{"name", "=", 
          RowBox[{"#", "@", "\"\<Name\>\""}]}], ",", "la", ",", "tr", ",", 
         "jacobi", ",", "eval"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fp", "=", 
         RowBox[{"N", "@", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"dLa", "[", 
                 RowBox[{"la", ",", "tr"}], "]"}], "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"dTr", "[", 
                 RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
               RowBox[{
                RowBox[{"dSm", "[", 
                 RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}]}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"0", "<=", "la", "<=", "1"}], ",", 
                RowBox[{"0", "<=", "tr", "<=", "1"}]}], "*)"}], "}"}], "/.", 
             "par"}], ",", 
            RowBox[{"{", 
             RowBox[{"la", ",", "tr"}], "}"}], ",", "Reals"}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"jacobi", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"dLa", "[", 
                RowBox[{"la", ",", "tr"}], "]"}], ",", 
               RowBox[{"dTr", "[", 
                RowBox[{"la", ",", "tr"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"la", ",", "tr"}], "}"}], "}"}]}], "]"}], "/.", "fp"}],
           "/.", "par"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eval", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{"MaximalBy", "[", 
             RowBox[{
              RowBox[{"Eigenvalues", "@", "#"}], ",", 
              RowBox[{"Re", "@*", "N"}]}], "]"}]}], "&"}], "/@", "jacobi"}]}],
         ";", 
        RowBox[{"(*", " ", 
         RowBox[{"NOTE", ":", " ", 
          RowBox[{"Get", " ", "dominant", " ", "eigenvalues"}]}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"fp", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"Chop", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"la", ",", "tr", ",", 
                RowBox[{"1", "-", "la", "-", "tr"}]}], "}"}], "/.", "fp"}], 
             ")"}]}], "->", 
           RowBox[{"Thread", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Re", "@", "eval"}], "<", "0"}], ")"}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"fp", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EdgeForm", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"AbsoluteThickness", "@", "2"}], ",", "Black"}], 
             "}"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FaceForm", "@", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Last", "@", "#"}], ",", "Black", ",", "White"}], 
                 "]"}]}], ",", 
               RowBox[{"Disk", "[", 
                RowBox[{
                 RowBox[{"ternaryToSimplex", "@", 
                  RowBox[{"First", "@", "#"}]}], ",", 
                 RowBox[{"Scaled", "@", ".01"}]}], "]"}]}], "}"}], "&"}], "/@",
             "fp"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fx", ",", "fy"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Simplify", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"dLa", "[", 
               RowBox[{"x", ",", "y"}], "]"}], ",", 
              RowBox[{"dTr", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "/.", "par"}], "//",
           "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"plot", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"StreamPlot", "[", 
            RowBox[{
             RowBox[{"Evaluate", "@", 
              RowBox[{"{", 
               RowBox[{"fx", ",", "fy"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"0", "-", "\[CapitalDelta]"}], ",", 
               RowBox[{"1", "+", "\[CapitalDelta]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"0", "-", "\[CapitalDelta]"}], ",", 
               RowBox[{"1", "+", "\[CapitalDelta]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "False"}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"Column", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"name", ",", 
                  RowBox[{"KeyDrop", "[", 
                   RowBox[{"#", ",", "\"\<Name\>\""}], "]"}]}], "}"}], ",", 
                RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "$SimplexBoundary", ",", "fp", ",", "$SimplexCornerLabels"}], 
               "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotRangePadding", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Scaled", "@", "0.05"}], ",", 
                RowBox[{"Scaled", "@", "0.05"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Background", "\[Rule]", "White"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StreamPoints", "\[Rule]", "150"}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Arrow", "[", "c_List", "]"}], "\[RuleDelayed]", 
             RowBox[{"Arrow", "[", 
              RowBox[{"cartesianToSimplex", "/@", "c"}], "]"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"GraphicsComplex", "[", 
             RowBox[{"c_List", ",", "x___"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"GraphicsComplex", "[", 
             RowBox[{
              RowBox[{"cartesianToSimplex", "/@", "c"}], ",", "x"}], "]"}]}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"$save", ",", 
          RowBox[{"Echo", "@", 
           RowBox[{"PathButton", "@", 
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "@", 
               RowBox[{"{", 
                RowBox[{"dir", ",", 
                 RowBox[{"name", "<>", "\"\<_FixedPoints.jpg\>\""}]}], 
                "}"}]}], ",", "plot", ",", "\"\<JPEG\>\"", ",", 
              RowBox[{"ImageResolution", "->", "300"}]}], "]"}]}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", "plot"}]}], "\[IndentingNewLine]", "]"}], 
     "&"}], "/@", "$MFParameterSets"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"$save", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Not", "@", 
       RowBox[{"FileExistsQ", "@", "dir"}]}], ",", 
      RowBox[{"CreateDirectory", "@", "dir"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "@", 
       RowBox[{"{", 
        RowBox[{"dir", ",", "\"\<CF_FixedPoints_All.jpg\>\""}], "}"}]}], ",", 
      
      RowBox[{"Multicolumn", "[", 
       RowBox[{"plots", ",", "2", ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<Horizontal\>\""}]}], "]"}], 
      ",", "\"\<JPEG\>\"", ",", 
      RowBox[{"ImageResolution", "->", "300"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8129569545223513`*^9, 3.8129569572823553`*^9}, {
   3.8129570180224404`*^9, 3.8129570979825525`*^9}, {3.8129599453578634`*^9, 
   3.8129599511978717`*^9}, {3.8129600745990443`*^9, 3.812960125749116*^9}, {
   3.8129601639991693`*^9, 3.8129602164992433`*^9}, {3.8131157515471563`*^9, 
   3.8131157564471626`*^9}, {3.8132037412892327`*^9, 
   3.8132038034637003`*^9}, {3.8139018174515653`*^9, 
   3.8139018186776357`*^9}, {3.814163861190506*^9, 3.8141638828367443`*^9}, {
   3.8851126832935953`*^9, 3.8851126867483797`*^9}, {3.8851139662025857`*^9, 
   3.885114096512355*^9}, {3.8851141670270367`*^9, 3.8851145144293222`*^9}, {
   3.885114799020385*^9, 3.8851148380464973`*^9}, {3.8851148733711786`*^9, 
   3.885114952332509*^9}, {3.8851153335225763`*^9, 3.885115338657236*^9}, {
   3.8851156832851863`*^9, 3.885115703252405*^9}, 3.885116022622884*^9, {
   3.885196144361766*^9, 3.8851961493834352`*^9}, 3.8851962194221177`*^9, {
   3.8851964793080783`*^9, 3.885196501631298*^9}, {3.8851973125668373`*^9, 
   3.8851973243132405`*^9}, {3.8852020495433173`*^9, 3.885202107614574*^9}, {
   3.8852024294063616`*^9, 3.8852024359109764`*^9}, 3.8852795614236403`*^9, {
   3.8852795952225485`*^9, 3.8852796310521007`*^9}, {3.885279664817444*^9, 
   3.8852796852953033`*^9}, 3.8852798189453936`*^9, {3.8852801174773993`*^9, 
   3.8852801259632106`*^9}, {3.8852801570406713`*^9, 3.885280284240474*^9}, {
   3.8852826991717815`*^9, 3.8852828831551514`*^9}, {3.8852829149492035`*^9, 
   3.8852829262677803`*^9}, {3.885282964306138*^9, 3.8852829673879423`*^9}, 
   3.885283181066635*^9, {3.907745066804946*^9, 3.9077451470938425`*^9}, {
   3.9077453463959813`*^9, 3.9077453612126837`*^9}, {3.9077459487548594`*^9, 
   3.907745948839373*^9}, {3.9077480300393534`*^9, 3.907748044575963*^9}, {
   3.9077484946702046`*^9, 3.9077485143872766`*^9}, {3.907926459334357*^9, 
   3.9079264594823437`*^9}, 3.9085244558109765`*^9, 3.9085252695597425`*^9, {
   3.9168961221080933`*^9, 3.9168961432828035`*^9}, {3.916896719463662*^9, 
   3.9168967719341707`*^9}, {3.9168968027948074`*^9, 3.916896805007164*^9}, {
   3.916897439596138*^9, 3.916897442414336*^9}, {3.9168983385467525`*^9, 
   3.9168983435350895`*^9}, {3.91690205384858*^9, 3.9169020773765182`*^9}, {
   3.916902588427303*^9, 
   3.916902589231677*^9}},ExpressionUUID->"c2861478-42fa-4316-8126-\
181eaec65142"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixed point calculation, with hi quality vector-field BG", "Subsection",
 CellChangeTimes->{{3.8139018105161686`*^9, 3.813901811427221*^9}, {
   3.8851164257597013`*^9, 3.8851164367401147`*^9}, {3.8852830805352163`*^9, 
   3.8852830985452986`*^9}, 3.8852836361755652`*^9, {3.9077453717604904`*^9, 
   3.9077453721444397`*^9}},ExpressionUUID->"a217b5a8-5a1e-4bec-8dac-\
ca8b933dc812"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Figures\\\\MF\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$save", "=", 
   RowBox[{"Setting", "@", 
    CheckboxBox[False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$labelled", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$imageSize", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$flowPoints", "=", "500"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "distinct", " ", "flow", " ", "lines"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$streamColorFunction", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"Opacity", "@", ".2"}], ",", 
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<SolarColors\>\"", "]"}], "[", "#3", 
         "]"}]}], "]"}], "&"}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$save", "&&", 
      RowBox[{"Not", "@", 
       RowBox[{"FileExistsQ", "@", "dir"}]}]}], ",", 
     RowBox[{"CreateDirectory", "@", "dir"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"par", "=", "#"}], ",", "dx", ",", "dy", ",", "x", ",", "y", 
       ",", "fp", ",", "plot", ",", 
       RowBox[{"name", "=", 
        RowBox[{"#", "@", "\"\<Name\>\""}]}], ",", "la", ",", "tr", ",", 
       "jacobi", ",", "eval", ",", 
       RowBox[{"gridPts", "=", 
        RowBox[{"randomCartesianPoint", "@", "$flowPoints"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fp", "=", 
       RowBox[{"N", "@", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"dLa", "[", 
               RowBox[{"la", ",", "tr"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"dTr", "[", 
               RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
             RowBox[{
              RowBox[{"dSm", "[", 
               RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}]}], 
            RowBox[{"(*", 
             RowBox[{",", 
              RowBox[{"0", "<=", "la", "<=", "1"}], ",", 
              RowBox[{"0", "<=", "tr", "<=", "1"}]}], "*)"}], "}"}], "/.", 
           "par"}], ",", 
          RowBox[{"{", 
           RowBox[{"la", ",", "tr"}], "}"}], ",", "Reals"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"jacobi", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dLa", "[", 
              RowBox[{"la", ",", "tr"}], "]"}], ",", 
             RowBox[{"dTr", "[", 
              RowBox[{"la", ",", "tr"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"la", ",", "tr"}], "}"}], "}"}]}], "]"}], "/.", "fp"}], "/.",
         "par"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eval", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"MaximalBy", "[", 
           RowBox[{
            RowBox[{"Eigenvalues", "@", "#"}], ",", 
            RowBox[{"Re", "@*", "N"}]}], "]"}]}], "&"}], "/@", "jacobi"}]}], 
      ";", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"Get", " ", "dominant", " ", "eigenvalues"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"fp", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"Chop", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"la", ",", "tr", ",", 
              RowBox[{"1", "-", "la", "-", "tr"}]}], "}"}], "/.", "fp"}], 
           ")"}]}], "->", 
         RowBox[{"Thread", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Re", "@", "eval"}], "<", "0"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fp", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"AbsoluteThickness", "@", "2"}], ",", "Black"}], "}"}]}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FaceForm", "@", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Last", "@", "#"}], ",", "Black", ",", "White"}], 
               "]"}]}], ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"ternaryToSimplex", "@", 
                RowBox[{"First", "@", "#"}]}], ",", 
               RowBox[{"Scaled", "@", ".01"}]}], "]"}]}], "}"}], "&"}], "/@", 
          "fp"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dx", ",", "dy"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "/@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"dLa", "[", 
             RowBox[{"x", ",", "y"}], "]"}], ",", 
            RowBox[{"dTr", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "/.", "par"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StreamPlot", "[", 
            RowBox[{
             RowBox[{"Evaluate", "@", 
              RowBox[{"{", 
               RowBox[{"dx", ",", "dy"}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
              "$SimplexCartesianRegion"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "False"}], ",", 
             RowBox[{"Mesh", "->", "False"}], ",", 
             RowBox[{"FrameTicks", "->", "False"}], ",", 
             RowBox[{"Ticks", "->", "False"}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{"$labelled", ",", 
                RowBox[{"Column", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"name", ",", 
                    RowBox[{"KeyDrop", "[", 
                    RowBox[{"par", ",", "\"\<Name\>\""}], "]"}]}], "}"}], ",", 
                  RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
                "None"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"fp", ",", 
                RowBox[{"{", 
                 RowBox[{"Black", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{"$labelled", ",", "$SimplexCornerLabels", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "$imageSize"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotRangePadding", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Scaled", "@", "0.05"}], ",", 
                RowBox[{"Scaled", "@", "0.05"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"RegionFillingStyle", "->", "None"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
             RowBox[{"Background", "\[Rule]", "White"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "StreamColorFunction", "\[Rule]", "$streamColorFunction"}], ",", 
             
             RowBox[{"StreamColorFunctionScaling", "\[Rule]", "True"}], ",", 
             RowBox[{"StreamStyle", "\[Rule]", "None"}], ",", 
             RowBox[{"StreamPoints", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"gridPts", ",", "Automatic", ",", "20"}], "}"}]}], 
             RowBox[{"(*", "Fine", "*)"}], ",", 
             RowBox[{"StreamMarkers", "\[Rule]", "\"\<Line\>\""}], ",", 
             RowBox[{"StreamScale", "\[Rule]", ".1"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"StreamPlot", "[", 
            RowBox[{
             RowBox[{"Evaluate", "@", 
              RowBox[{"{", 
               RowBox[{"dx", ",", "dy"}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
              "$SimplexCartesianRegion"}], ",", "\[IndentingNewLine]", 
             RowBox[{"RegionFillingStyle", "->", "None"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"BoundaryStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "@", "2"}], ",", 
                RowBox[{"GrayLevel", "@", ".3"}]}], "]"}]}], ",", 
             RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StreamScale", "\[Rule]", ".07"}], ",", 
             RowBox[{"StreamColorFunction", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"GrayLevel", "[", ".37", "]"}], "&"}], ")"}]}], ",", 
             RowBox[{"StreamPoints", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"300", ",", ".01"}], "}"}]}]}], "\[IndentingNewLine]", 
            "]"}]}], "\[IndentingNewLine]", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Arrow", "[", "c_List", "]"}], "\[RuleDelayed]", 
           RowBox[{"Arrow", "[", 
            RowBox[{"cartesianToSimplex", "/@", "c"}], "]"}]}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GraphicsComplex", "[", 
           RowBox[{"c_List", ",", "x___"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"GraphicsComplex", "[", 
           RowBox[{
            RowBox[{"cartesianToSimplex", "/@", "c"}], ",", "x"}], "]"}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"plot", ",", 
        RowBox[{"If", "[", 
         RowBox[{"$save", ",", "\[IndentingNewLine]", 
          RowBox[{"PathButton", "@", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "@", 
              RowBox[{"{", 
               RowBox[{"dir", ",", 
                RowBox[{"name", "<>", 
                 RowBox[{"If", "[", 
                  RowBox[{
                  "$labelled", ",", "\"\<_labelled\>\"", ",", "\"\<\>\""}], 
                  "]"}], "<>", "\"\<.jpg\>\""}]}], "}"}]}], ",", "plot", ",", 
             "\"\<JPEG\>\"", ",", 
             RowBox[{"ImageResolution", "->", "600"}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", "SpanFromLeft"}], "]"}]}], "}"}]}]}], 
    "]"}], "&"}], "/@", "$MFParameterSets"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.7128988524081993`*^9, 3.712898974978279*^9}, 
   3.712899028580853*^9, {3.712899221653963*^9, 3.712899324109664*^9}, {
   3.712901159906414*^9, 3.71290116231283*^9}, {3.7129014439385443`*^9, 
   3.7129015475334697`*^9}, {3.71290157813422*^9, 3.712901587025728*^9}, {
   3.7129016600279036`*^9, 3.71290176556094*^9}, {3.7129063938416624`*^9, 
   3.7129063942876883`*^9}, {3.7129064441575403`*^9, 3.712906598999397*^9}, {
   3.712906656487685*^9, 3.7129066924737434`*^9}, {3.712906743308651*^9, 
   3.712906775654501*^9}, 3.7129068534269495`*^9, {3.712907121673292*^9, 
   3.712907142316473*^9}, {3.7129074406225348`*^9, 3.71290767569598*^9}, {
   3.712907720498543*^9, 3.7129077272569294`*^9}, {3.7129090481414795`*^9, 
   3.712909131880269*^9}, {3.7129091623960147`*^9, 3.7129091633200674`*^9}, {
   3.71290921615609*^9, 3.7129094106892166`*^9}, {3.7129094478093395`*^9, 
   3.7129094951910496`*^9}, 3.712909544708882*^9, {3.712913601397911*^9, 
   3.71291362166007*^9}, {3.7129136595882397`*^9, 3.7129136858847437`*^9}, {
   3.7129143788083763`*^9, 3.712914425919071*^9}, {3.712914465046309*^9, 
   3.7129144746738596`*^9}, {3.712914511027939*^9, 3.7129145575345993`*^9}, {
   3.7129146335589476`*^9, 3.7129146572113*^9}, {3.7129148106180744`*^9, 
   3.7129148617249975`*^9}, {3.7129151281482363`*^9, 3.712915177096036*^9}, {
   3.712916516783662*^9, 3.712916569938702*^9}, {3.712917832098893*^9, 
   3.7129178986467*^9}, {3.712917959513181*^9, 3.7129179715088673`*^9}, {
   3.7129184680392675`*^9, 3.712918528042699*^9}, {3.7129207085244155`*^9, 
   3.7129207889170136`*^9}, {3.712920907584801*^9, 3.7129210385402913`*^9}, {
   3.712921143800312*^9, 3.7129211949672384`*^9}, {3.71299093755571*^9, 
   3.712991014002537*^9}, {3.712991735499424*^9, 3.712991741302186*^9}, {
   3.71299177843685*^9, 3.712991817085967*^9}, 3.71299184991965*^9, {
   3.712991904037283*^9, 3.712991929784976*^9}, {3.712991967941709*^9, 
   3.7129920540927563`*^9}, {3.712992206729158*^9, 3.712992216853477*^9}, {
   3.7129922795445433`*^9, 3.712992291657662*^9}, {3.712992493258033*^9, 
   3.712992526817498*^9}, {3.71299255910505*^9, 3.712992614473853*^9}, {
   3.7129926472298098`*^9, 3.7129926969276752`*^9}, {3.7129927280595617`*^9, 
   3.7129927350467863`*^9}, {3.712992888611568*^9, 3.7129929821889753`*^9}, 
   3.712996237135991*^9, {3.7129963213540287`*^9, 3.7129963218928823`*^9}, {
   3.71299637394757*^9, 3.7129964782335443`*^9}, {3.712996732244549*^9, 
   3.712996732744384*^9}, {3.7129974236483593`*^9, 3.712997521267351*^9}, {
   3.71299878150066*^9, 3.712998781765644*^9}, {3.712998874235648*^9, 
   3.712998932139945*^9}, {3.7129990471060247`*^9, 3.712999047646446*^9}, {
   3.712999152156479*^9, 3.7129991536284103`*^9}, {3.712999227322372*^9, 
   3.712999230465135*^9}, {3.7129994959441633`*^9, 3.712999500478951*^9}, {
   3.712999543840272*^9, 3.712999574920445*^9}, {3.712999609340633*^9, 
   3.712999618951911*^9}, {3.7798051845285335`*^9, 3.7798051857436028`*^9}, {
   3.7798901732619886`*^9, 3.7798901762883935`*^9}, {3.7798902168640647`*^9, 
   3.779890267127353*^9}, 3.7798905116733828`*^9, {3.780033321771454*^9, 
   3.7800333238150578`*^9}, {3.7800335071153793`*^9, 
   3.7800335446958456`*^9}, {3.780037333838016*^9, 3.780037481382476*^9}, {
   3.78003757468624*^9, 3.780037575419441*^9}, {3.7800377612469673`*^9, 
   3.7800377875954137`*^9}, {3.7800378609623427`*^9, 
   3.7800378953916035`*^9}, {3.7800485755804462`*^9, 
   3.7800485796364527`*^9}, {3.780050509191242*^9, 3.780050525696071*^9}, {
   3.780050607487015*^9, 3.780050609842619*^9}, 3.780118235075061*^9, {
   3.7801187844632263`*^9, 3.7801188091736693`*^9}, {3.7801188440085306`*^9, 
   3.780119010887024*^9}, {3.780119188964337*^9, 3.7801192291500072`*^9}, {
   3.7801193548872285`*^9, 3.780119610777478*^9}, {3.780119647858743*^9, 
   3.7801198041554174`*^9}, {3.7801198361666737`*^9, 
   3.7801200113393817`*^9}, {3.7801200494190483`*^9, 3.780120150414626*^9}, 
   3.780120672641143*^9, {3.780120706876604*^9, 3.780120749417878*^9}, {
   3.780129595445424*^9, 3.7801296558578796`*^9}, {3.780129749202218*^9, 
   3.780129749532237*^9}, {3.7808954056690607`*^9, 3.7808954660211477`*^9}, {
   3.7808957430535374`*^9, 3.7808957433335376`*^9}, {3.780895798889616*^9, 
   3.7808958371216693`*^9}, {3.7808958852117367`*^9, 3.780895956428837*^9}, {
   3.780895992278887*^9, 3.780896019898926*^9}, {3.7808960524369745`*^9, 
   3.780896072798003*^9}, {3.780896108579053*^9, 3.780896140912099*^9}, {
   3.78089624567725*^9, 3.780896250397256*^9}, {3.780896337470378*^9, 
   3.780896349581395*^9}, {3.780896724217922*^9, 3.780896811188044*^9}, {
   3.7808977521016245`*^9, 3.780898044722036*^9}, {3.7808991897816424`*^9, 
   3.780899264442747*^9}, {3.780903988069971*^9, 3.780903988159971*^9}, {
   3.780904196472263*^9, 3.780904231033311*^9}, {3.780904263123356*^9, 
   3.780904293883399*^9}, {3.7809931453273687`*^9, 3.7809931464573703`*^9}, {
   3.795250846761405*^9, 3.795250848399408*^9}, {3.7953227131108303`*^9, 
   3.795322725771866*^9}, {3.7953228993352976`*^9, 3.795322900157299*^9}, {
   3.811044589701892*^9, 3.811044590031892*^9}, {3.811044660337044*^9, 
   3.811044661597046*^9}, {3.8116535290638914`*^9, 3.8116535921094975`*^9}, {
   3.811654251128191*^9, 3.8116543290906506`*^9}, 3.8116552356621876`*^9, {
   3.8117424576551948`*^9, 3.8117424768652215`*^9}, {3.811742685405514*^9, 
   3.811742699375533*^9}, {3.8117427561056128`*^9, 3.811742762305621*^9}, 
   3.811743248077301*^9, {3.8117433040373793`*^9, 3.8117433047973804`*^9}, {
   3.81174385493172*^9, 3.811743875592749*^9}, {3.811743985912904*^9, 
   3.811743988012906*^9}, {3.8117449142492375`*^9, 3.8117449562022963`*^9}, {
   3.811745959095278*^9, 3.8117459593952785`*^9}, {3.811823217123048*^9, 
   3.811823301783167*^9}, {3.8118234176033287`*^9, 3.811823446573369*^9}, {
   3.8118235540335197`*^9, 3.8118235932235746`*^9}, 3.811823755013801*^9, {
   3.811824373122679*^9, 3.8118244001827173`*^9}, {3.8118244341927648`*^9, 
   3.81182450406297*^9}, {3.8118245635030727`*^9, 3.8118246796932354`*^9}, {
   3.811824710343279*^9, 3.8118247637833533`*^9}, {3.8118247947353992`*^9, 
   3.8118250113518505`*^9}, {3.811825060001919*^9, 3.811825069611932*^9}, {
   3.811825635442724*^9, 3.8118256357327247`*^9}, {3.811826177053482*^9, 
   3.81182620388352*^9}, {3.8118262896836405`*^9, 3.811826302943659*^9}, {
   3.8118264538238697`*^9, 3.8118265581440163`*^9}, {3.8118268234543877`*^9, 
   3.811826936794546*^9}, {3.811827022994667*^9, 3.811827058044716*^9}, {
   3.811827122854807*^9, 3.811827517586359*^9}, {3.8118275625264225`*^9, 
   3.8118276251565104`*^9}, {3.8118278783168645`*^9, 3.8118279054769025`*^9}, 
   3.8118279533969693`*^9, 3.81182806103712*^9, 3.8118281019771776`*^9, {
   3.8118281328072205`*^9, 3.8118282484973826`*^9}, {3.8118283701995535`*^9, 
   3.811828652853949*^9}, {3.8118286938840065`*^9, 3.811828720654044*^9}, {
   3.811828782935131*^9, 3.811828839775211*^9}, {3.8118289194853225`*^9, 
   3.8118290376254873`*^9}, {3.8118294346260433`*^9, 
   3.8118295172861595`*^9}, {3.811829563006223*^9, 3.8118295631862235`*^9}, {
   3.811829604676282*^9, 3.8118296098462887`*^9}, {3.8118298722866564`*^9, 
   3.811829902696699*^9}, {3.8118299750168*^9, 3.811830002876839*^9}, {
   3.811830126707012*^9, 3.811830136547026*^9}, {3.8118302102971296`*^9, 
   3.8118302118771315`*^9}, {3.811831492049034*^9, 3.8118315672891397`*^9}, {
   3.8118317147993464`*^9, 3.8118320059897537`*^9}, {3.8118322032000303`*^9, 
   3.8118324640603952`*^9}, {3.811832497140442*^9, 3.8118325257404814`*^9}, {
   3.811832582230561*^9, 3.8118325824405613`*^9}, {3.8118326184606113`*^9, 
   3.811832640000642*^9}, {3.8118326850807047`*^9, 3.8118326852907047`*^9}, {
   3.8118327804208384`*^9, 3.8118328696309633`*^9}, {3.8118330554522233`*^9, 
   3.8118330843922634`*^9}, {3.8118331280723248`*^9, 3.811833153672361*^9}, {
   3.8118331848924046`*^9, 3.811833304642572*^9}, 3.8118353899524918`*^9, 
   3.8118354527525797`*^9, {3.8118355104126606`*^9, 3.8118355140726657`*^9}, {
   3.811835750072996*^9, 3.8118357724030275`*^9}, {3.8118358525531397`*^9, 
   3.811835873503169*^9}, 3.8118359169332294`*^9, {3.8118359716033063`*^9, 
   3.811836156293565*^9}, {3.8118361874236083`*^9, 3.8118363398338213`*^9}, 
   3.811836372713868*^9, 3.8118364225839376`*^9, {3.81183658835417*^9, 
   3.811836791934455*^9}, {3.811836886244587*^9, 3.8118370522748194`*^9}, {
   3.8118370916948743`*^9, 3.8118374646753964`*^9}, {3.8118374968754416`*^9, 
   3.8118376828297043`*^9}, 3.812343984460635*^9, {3.812344034135476*^9, 
   3.812344044546072*^9}, {3.8123441150271034`*^9, 3.812344116391181*^9}, {
   3.8123445698331165`*^9, 3.8123446162457714`*^9}, 3.812344749654402*^9, {
   3.81234478930367*^9, 3.8123448869772563`*^9}, {3.812344953760076*^9, 
   3.812345101772542*^9}, {3.812345148298203*^9, 3.8123451504413257`*^9}, {
   3.8123451899085827`*^9, 3.8123451909096403`*^9}, 3.812346639754656*^9, {
   3.8123477147439575`*^9, 3.812347724243971*^9}, 3.812797562188599*^9, {
   3.8129529892588615`*^9, 3.812952989788892*^9}, {3.81295305707374*^9, 
   3.8129530607149487`*^9}, {3.812953116292127*^9, 3.8129531491630077`*^9}, {
   3.8129532378720813`*^9, 3.81295324047423*^9}, {3.8129535342706146`*^9, 
   3.8129536108119926`*^9}, {3.81295370080514*^9, 3.8129537029942656`*^9}, {
   3.812953782584818*^9, 3.812953783000841*^9}, {3.8129539097290897`*^9, 
   3.812953945536138*^9}, {3.8129569711523747`*^9, 3.8129569939324064`*^9}, {
   3.8129571204425836`*^9, 3.8129571318525996`*^9}, {3.812957176282662*^9, 
   3.8129572280927343`*^9}, {3.812957271822796*^9, 3.8129573562129135`*^9}, {
   3.8129574310330186`*^9, 3.8129575387231693`*^9}, {3.812957580023227*^9, 
   3.8129575888232393`*^9}, {3.812957684689669*^9, 3.81295769983969*^9}, {
   3.8129578136858788`*^9, 3.8129579044370055`*^9}, {3.8129584163377223`*^9, 
   3.8129584621177864`*^9}, {3.8129585548779163`*^9, 
   3.8129585845879583`*^9}, {3.8129586240380135`*^9, 
   3.8129586244880137`*^9}, {3.8129586811080933`*^9, 
   3.8129586814080935`*^9}, {3.8129587366581707`*^9, 3.812958841878318*^9}, {
   3.8129588786683693`*^9, 3.8129589276484385`*^9}, {3.812958966778493*^9, 
   3.812959109888693*^9}, {3.812959145988744*^9, 3.81295924303088*^9}, {
   3.8129593279919987`*^9, 3.812959330092002*^9}, {3.8129595049042463`*^9, 
   3.8129595824973555`*^9}, 3.812959622167411*^9, {3.8129596857475*^9, 
   3.81295969321751*^9}, 3.8129597539875956`*^9, {3.8129597896976457`*^9, 
   3.8129598765377674`*^9}, {3.8129599974379363`*^9, 
   3.8129600686590357`*^9}, {3.8129602320292645`*^9, 
   3.8129603339894075`*^9}, {3.8137748058190174`*^9, 
   3.8137748412490673`*^9}, {3.81407330774756*^9, 3.8140733350275984`*^9}, {
   3.8141628395544496`*^9, 3.814162840277491*^9}, {3.8141700544375424`*^9, 
   3.8141700609989176`*^9}, {3.8142464534743757`*^9, 3.81424646456401*^9}, {
   3.8142465321418753`*^9, 3.814246553362089*^9}, {3.8142466042970023`*^9, 
   3.814246604383007*^9}, {3.8142466582680893`*^9, 3.81424674272092*^9}, {
   3.8142467852113504`*^9, 3.8142468234715385`*^9}, {3.8142468655389447`*^9, 
   3.81424696825782*^9}, {3.8142469989315743`*^9, 3.81424702298995*^9}, {
   3.814247083628419*^9, 3.814247140839691*^9}, {3.8142473196359177`*^9, 
   3.8142473198229284`*^9}, {3.81424749696706*^9, 3.814247503635442*^9}, {
   3.814247552875258*^9, 3.814247600345973*^9}, {3.8142476464396095`*^9, 
   3.814247742484103*^9}, {3.814247867551256*^9, 3.814247889260498*^9}, {
   3.8142480567240763`*^9, 3.814248081384487*^9}, {3.814248131740367*^9, 
   3.81424815714682*^9}, {3.814248603885372*^9, 3.814248620385316*^9}, {
   3.8437071451652575`*^9, 3.843707150276494*^9}, {3.843707183680286*^9, 
   3.843707230330222*^9}, {3.843707408273813*^9, 3.8437074270478106`*^9}, {
   3.8437074692397833`*^9, 3.8437074941246386`*^9}, {3.843707530383296*^9, 
   3.8437075794592233`*^9}, 3.8437076233668995`*^9, {3.845010479493718*^9, 
   3.845010496652381*^9}, {3.845010560727725*^9, 3.8450106155049267`*^9}, {
   3.845011359502488*^9, 3.8450114480822625`*^9}, {3.845011514765334*^9, 
   3.8450115455816965`*^9}, {3.8450115756765146`*^9, 
   3.8450116475527887`*^9}, {3.8450116833905315`*^9, 3.845011936403373*^9}, {
   3.8450120146259766`*^9, 3.8450121323364067`*^9}, {3.845012187408829*^9, 
   3.8450122576601324`*^9}, {3.8450123172548447`*^9, 
   3.8450124298784103`*^9}, {3.8450124735270877`*^9, 3.845012840772312*^9}, {
   3.845012908919922*^9, 3.8450129422440557`*^9}, {3.8450130974325314`*^9, 
   3.8450131803254814`*^9}, {3.845013218965231*^9, 3.8450132340689325`*^9}, {
   3.8450133967353225`*^9, 3.8450134495922937`*^9}, {3.8450136120126534`*^9, 
   3.8450136566400113`*^9}, {3.8450137638705826`*^9, 3.845013807496838*^9}, {
   3.8450138421052303`*^9, 3.8450138825309296`*^9}, {3.8450141936196256`*^9, 
   3.845014330066331*^9}, {3.8450143620907717`*^9, 3.84501448250522*^9}, {
   3.845014547265653*^9, 3.8450145660560274`*^9}, {3.845014602279086*^9, 
   3.8450146222721167`*^9}, {3.8450146538833866`*^9, 3.8450147267927313`*^9}, 
   3.86116472190705*^9, 3.8611711862974405`*^9, 3.861243460184227*^9, {
   3.885024625914526*^9, 3.885024629425409*^9}, {3.885024666566039*^9, 
   3.8850247070172076`*^9}, {3.885024847106233*^9, 3.8850249220135064`*^9}, {
   3.8850250587600803`*^9, 3.885025131893716*^9}, 3.8850251753719435`*^9, {
   3.885025386358943*^9, 3.8850254952288847`*^9}, {3.8850256112477016`*^9, 
   3.885025665628931*^9}, {3.8850257042083035`*^9, 3.8850257054394145`*^9}, 
   3.885025735668522*^9, {3.885025846672432*^9, 3.885025978879383*^9}, {
   3.885026025891346*^9, 3.8850261236660185`*^9}, {3.885026157353324*^9, 
   3.8850262526407623`*^9}, {3.885026287260377*^9, 3.8850262873531485`*^9}, {
   3.885026465513856*^9, 3.8850264677166753`*^9}, {3.8850266538661375`*^9, 
   3.885026930515854*^9}, {3.885026973484988*^9, 3.8850270888695774`*^9}, {
   3.8850272966547594`*^9, 3.885027378295901*^9}, {3.8850274295112667`*^9, 
   3.8850275512365303`*^9}, {3.8850275966226606`*^9, 
   3.8850276159386444`*^9}, {3.8850276543833685`*^9, 3.885027850333411*^9}, {
   3.885027887799326*^9, 3.8850279148411045`*^9}, {3.885027949179531*^9, 
   3.8850279630180583`*^9}, {3.8850279985408936`*^9, 3.885028077442147*^9}, {
   3.885028137566324*^9, 3.885028143021866*^9}, {3.885028211909623*^9, 
   3.8850285938370676`*^9}, {3.8850286436067877`*^9, 
   3.8850286599567947`*^9}, {3.885028694055255*^9, 3.8850287222242546`*^9}, {
   3.8850287564478493`*^9, 3.885028774541668*^9}, {3.885028840506548*^9, 
   3.8850288489014807`*^9}, 3.8850296869278173`*^9, {3.885112616179118*^9, 
   3.8851126208615985`*^9}, {3.8851127021557493`*^9, 
   3.8851127288678093`*^9}, {3.885113368464224*^9, 3.8851134448592744`*^9}, {
   3.8851134787636557`*^9, 3.8851135242468767`*^9}, 3.885113902110379*^9, {
   3.8851145714233894`*^9, 3.8851146043763437`*^9}, {3.885114843186096*^9, 
   3.885114859145609*^9}, {3.8851157199633512`*^9, 3.885115724372466*^9}, {
   3.885116089933784*^9, 3.8851161068976173`*^9}, 3.8851161538828983`*^9, {
   3.8851164428860497`*^9, 3.885116446792308*^9}, {3.8851165151506605`*^9, 
   3.885116516725235*^9}, 3.8851964425127244`*^9, {3.885196508524829*^9, 
   3.885196514548543*^9}, {3.8851967939903*^9, 3.8851969094812145`*^9}, {
   3.8851970951720743`*^9, 3.885197095421831*^9}, {3.8851972194198313`*^9, 
   3.885197250179617*^9}, {3.8852829909746237`*^9, 3.8852829921773653`*^9}, {
   3.885283028775766*^9, 3.885283049535723*^9}, {3.885283192540947*^9, 
   3.8852831926177216`*^9}, {3.8852846157577367`*^9, 3.885284648779677*^9}, {
   3.885284718207427*^9, 3.885284798238181*^9}, {3.8852848309660387`*^9, 
   3.885284869999301*^9}, {3.8852849176104393`*^9, 3.885285120675305*^9}, 
   3.8852851854038343`*^9, {3.885285311739051*^9, 3.8852853405871053`*^9}, {
   3.8852853920826693`*^9, 3.8852854139569926`*^9}, {3.885285524852676*^9, 
   3.885285556384644*^9}, {3.885285589538989*^9, 3.885285591830228*^9}, 
   3.8852856289788713`*^9, {3.8852856793321*^9, 3.88528593087871*^9}, 
   3.885285976223634*^9, {3.885286081721127*^9, 3.88528610550457*^9}, {
   3.907745382722106*^9, 3.907745421501173*^9}, {3.9077454524275727`*^9, 
   3.9077454542134285`*^9}, {3.9077455151971154`*^9, 3.907745516782587*^9}, {
   3.9077455921757803`*^9, 3.9077456497678523`*^9}, {3.907745717326638*^9, 
   3.907745822403425*^9}, {3.907745865392435*^9, 3.9077458829817038`*^9}, {
   3.9077460057469177`*^9, 3.9077460058318987`*^9}, {3.907852704879403*^9, 
   3.907852704934065*^9}, 3.9085244646005745`*^9, {3.9085246531245766`*^9, 
   3.9085246953422203`*^9}, {3.9085247482318983`*^9, 
   3.9085247512191043`*^9}, {3.9085248558227797`*^9, 
   3.9085248602624764`*^9}, {3.908525323259867*^9, 3.9085253556597366`*^9}, {
   3.908525399189958*^9, 3.9085254143996553`*^9}, {3.9085258377242723`*^9, 
   3.9085259428721657`*^9}, {3.9085259828943844`*^9, 3.90852605473455*^9}, 
   3.9085261222313337`*^9, {3.9168960183946586`*^9, 3.9168960184710503`*^9}, {
   3.916902546857839*^9, 3.9169025489422126`*^9}, {3.916902582942663*^9, 
   3.9169025829835625`*^9}, {3.916904243082198*^9, 3.9169042431440983`*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"de87deb4-3513-40f1-8496-ec2745e6ea29"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Configuration-field model (analytic)", "Section",
 CellChangeTimes->{{3.7800505138400507`*^9, 3.7800505171940565`*^9}, {
  3.7808956535814104`*^9, 3.7808956713414354`*^9}, {3.885283304967554*^9, 
  3.8852833113172455`*^9}},ExpressionUUID->"e5fde226-5f5e-4939-8dd4-\
305777cfdc82"],

Cell[TextData[{
 "Coordinates are ALWAYS in the form: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"Lazy", ",", " ", "Trusty", ",", " ", "Smart"}], "}"}]}], 
   TraditionalForm]],ExpressionUUID->"3a17b4a2-c242-4992-ad7d-50b0c4690836"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", " ", "=", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "x", "-", "y"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"3fb40538-2fad-449f-be21-40d37bf591a3"],
 "."
}], "Item",
 CellChangeTimes->{{3.811833544182907*^9, 3.8118335537729206`*^9}, {
   3.811840033790032*^9, 3.8118400433200455`*^9}, {3.885112666846252*^9, 
   3.8851126741829205`*^9}, {3.9077481197528763`*^9, 3.907748121090335*^9}, 
   3.9079264692818956`*^9},ExpressionUUID->"17676dcd-917f-4ecb-8f1f-\
2258baceecd1"],

Cell[CellGroupData[{

Cell["Definitions", "Subsection",
 CellChangeTimes->{{3.811653676443321*^9, 3.811653676737338*^9}, {
  3.814246380559205*^9, 
  3.8142463828253355`*^9}},ExpressionUUID->"02ec88f7-d43b-4d63-b768-\
2187ce968b75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "\[Theta]", ",", "\[Theta]1", ",", "w", ",", "wLa", ",", "wTr", ",", "wSm",
     ",", "fLa", ",", "fTr", ",", "fSm", ",", "gLa", ",", "gC"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "n", ",", "k", ",", "c", ",", "r", ",", "b", ",", "d", ",", "c0", ",", 
     "w0"}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"NOTE", ":", " ", "x"}], " ", "=", " ", "Lazy"}], ";", " ", 
    RowBox[{"y", " ", "=", " ", "Trusty"}], ";", " ", 
    RowBox[{
     RowBox[{"n", "-", "1", "-", "x", "-", "y"}], " ", "=", " ", 
     RowBox[{"z", " ", "=", " ", "Smart"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Threshold", " ", "functions"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "-", "1", "-", "x"}], "\[GreaterEqual]", "k"}], ",", "1", 
     ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]1", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"n", "-", "1", "-", "x"}], "\[GreaterEqual]", 
       RowBox[{"k", "-", "1"}]}], ",", "1", ",", "0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Lazy", " ", "and", " ", "Cooperator", " ", "configurations"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gLa", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Multinomial", "[", 
       RowBox[{"i", ",", "j", ",", 
        RowBox[{"n", "-", "1", "-", "i", "-", "j"}]}], "]"}], "*", 
      RowBox[{"\[Theta]", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"x", "^", "i"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"y", "^", "j"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "x", "-", "y"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1", "-", "i", "-", "j"}], ")"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "i"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gC", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Multinomial", "[", 
        RowBox[{"i", ",", "j", ",", 
         RowBox[{"n", "-", "1", "-", "i", "-", "j"}]}], "]"}], "*", 
       RowBox[{"\[Theta]1", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"x", "^", "i"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"y", "^", "j"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "x", "-", "y"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1", "-", "i", "-", "j"}], ")"}]}], ")"}]}], ",", 
      
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", 
        RowBox[{"n", "-", "1", "-", "i"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"wLa", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"w0", "-", 
     RowBox[{"c0", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"b", "*", 
         RowBox[{"gLa", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Lazy", " ", "fitness"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"wTr", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"w0", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c0", "+", "c"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"b", "*", 
         RowBox[{"gC", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Trusty", " ", "fitness"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"wSm", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"w0", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c0", "+", "r", "+", "c"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", "b"}], ")"}], "*", 
      RowBox[{"gC", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c0", "+", "r"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"gC", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Smart", " ", 
    RowBox[{"(", "conditional", ")"}], " ", "fitness"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Mean", " ", "fitness"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"x", "*", 
      RowBox[{"wLa", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "+", 
     RowBox[{"y", "*", 
      RowBox[{"wTr", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "x", "-", "y"}], ")"}], "*", 
      RowBox[{"wSm", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Growth", " ", "equations"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fLa", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"wLa", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "-", 
      RowBox[{"w", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ")"}], "*", "x"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fTr", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"wTr", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "-", 
      RowBox[{"w", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ")"}], "*", "y"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fSm", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"wSm", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "-", 
       RowBox[{"w", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "x", "-", "y"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ParameterSets", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<CF A\>\""}], ",", 
       RowBox[{"n", "\[Rule]", "9"}], ",", 
       RowBox[{"k", "\[Rule]", "3"}], ",", 
       RowBox[{"c", "\[Rule]", 
        RowBox[{"3", "/", "10"}]}], ",", 
       RowBox[{"r", "\[Rule]", 
        RowBox[{"1", "/", "100"}]}], ",", 
       RowBox[{"b", "\[Rule]", 
        RowBox[{"3", "/", "10"}]}], ",", 
       RowBox[{"d", "\[Rule]", "0"}], ",", 
       RowBox[{"c0", "\[Rule]", "1"}], ",", 
       RowBox[{"w0", "->", "0"}]}], "\[RightAssociation]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<CF B\>\""}], ",", 
       RowBox[{"n", "\[Rule]", "9"}], ",", 
       RowBox[{"k", "\[Rule]", "3"}], ",", 
       RowBox[{"c", "\[Rule]", 
        RowBox[{"3", "/", "10"}]}], ",", 
       RowBox[{"r", "\[Rule]", 
        RowBox[{"1", "/", "100"}]}], ",", 
       RowBox[{"b", "\[Rule]", 
        RowBox[{"1", "/", "2"}]}], ",", 
       RowBox[{"d", "\[Rule]", "0"}], ",", 
       RowBox[{"c0", "\[Rule]", "1"}], ",", 
       RowBox[{"w0", "->", "0"}]}], "\[RightAssociation]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<CF C\>\""}], ",", 
       RowBox[{"n", "\[Rule]", "9"}], ",", 
       RowBox[{"k", "\[Rule]", "3"}], ",", 
       RowBox[{"c", "\[Rule]", 
        RowBox[{"3", "/", "10"}]}], ",", 
       RowBox[{"r", "\[Rule]", 
        RowBox[{"2", "/", "10"}]}], ",", 
       RowBox[{"b", "\[Rule]", 
        RowBox[{"65", "/", "100"}]}], ",", 
       RowBox[{"d", "\[Rule]", "0"}], ",", 
       RowBox[{"c0", "\[Rule]", "1"}], ",", 
       RowBox[{"w0", "->", "0"}]}], "\[RightAssociation]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<CF D\>\""}], ",", 
       RowBox[{"n", "\[Rule]", "9"}], ",", 
       RowBox[{"k", "\[Rule]", "3"}], ",", 
       RowBox[{"c", "\[Rule]", 
        RowBox[{"3", "/", "10"}]}], ",", 
       RowBox[{"r", "\[Rule]", 
        RowBox[{"1", "/", "100"}]}], ",", 
       RowBox[{"b", "\[Rule]", 
        RowBox[{"6", "/", "10"}]}], ",", 
       RowBox[{"d", "\[Rule]", "0"}], ",", 
       RowBox[{"c0", "\[Rule]", "1"}], ",", 
       RowBox[{"w0", "->", "0"}]}], "\[RightAssociation]"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7128988524081993`*^9, 3.712898974978279*^9}, 
   3.712899028580853*^9, {3.712899221653963*^9, 3.712899324109664*^9}, {
   3.712901159906414*^9, 3.71290116231283*^9}, {3.7129014439385443`*^9, 
   3.7129015475334697`*^9}, {3.71290157813422*^9, 3.712901587025728*^9}, {
   3.7129016600279036`*^9, 3.71290176556094*^9}, {3.7129063938416624`*^9, 
   3.7129063942876883`*^9}, {3.7129064441575403`*^9, 3.712906598999397*^9}, {
   3.712906656487685*^9, 3.7129066924737434`*^9}, {3.712906743308651*^9, 
   3.712906775654501*^9}, 3.7129068534269495`*^9, {3.712907121673292*^9, 
   3.712907142316473*^9}, {3.7129074406225348`*^9, 3.71290767569598*^9}, {
   3.712907720498543*^9, 3.7129077272569294`*^9}, {3.7129090481414795`*^9, 
   3.712909131880269*^9}, {3.7129091623960147`*^9, 3.7129091633200674`*^9}, {
   3.71290921615609*^9, 3.7129094106892166`*^9}, {3.7129094478093395`*^9, 
   3.7129094951910496`*^9}, 3.712909544708882*^9, {3.712913601397911*^9, 
   3.71291362166007*^9}, {3.7129136595882397`*^9, 3.7129136858847437`*^9}, {
   3.7129143788083763`*^9, 3.712914425919071*^9}, {3.712914465046309*^9, 
   3.7129144746738596`*^9}, {3.712914511027939*^9, 3.7129145575345993`*^9}, {
   3.7129146335589476`*^9, 3.7129146572113*^9}, {3.7129148106180744`*^9, 
   3.7129148617249975`*^9}, {3.7129151281482363`*^9, 3.712915177096036*^9}, {
   3.712916516783662*^9, 3.712916569938702*^9}, {3.712917832098893*^9, 
   3.7129178986467*^9}, {3.712917959513181*^9, 3.7129179715088673`*^9}, {
   3.7129184680392675`*^9, 3.712918528042699*^9}, {3.7129207085244155`*^9, 
   3.7129207889170136`*^9}, {3.712920907584801*^9, 3.7129210385402913`*^9}, {
   3.712921143800312*^9, 3.7129211949672384`*^9}, {3.71299093755571*^9, 
   3.712991014002537*^9}, {3.712991735499424*^9, 3.712991741302186*^9}, {
   3.71299177843685*^9, 3.712991817085967*^9}, 3.71299184991965*^9, {
   3.712991904037283*^9, 3.712991929784976*^9}, {3.712991967941709*^9, 
   3.7129920540927563`*^9}, {3.712992206729158*^9, 3.712992216853477*^9}, {
   3.7129922795445433`*^9, 3.712992291657662*^9}, {3.712992493258033*^9, 
   3.712992526817498*^9}, {3.71299255910505*^9, 3.712992614473853*^9}, {
   3.7129926472298098`*^9, 3.7129926969276752`*^9}, {3.7129927280595617`*^9, 
   3.7129927350467863`*^9}, {3.712992888611568*^9, 3.7129929821889753`*^9}, 
   3.712996237135991*^9, {3.7129963213540287`*^9, 3.7129963218928823`*^9}, {
   3.71299637394757*^9, 3.7129964782335443`*^9}, {3.712996732244549*^9, 
   3.712996732744384*^9}, {3.7129974236483593`*^9, 3.712997521267351*^9}, {
   3.71299878150066*^9, 3.712998781765644*^9}, {3.712998874235648*^9, 
   3.712998932139945*^9}, {3.7129990471060247`*^9, 3.712999047646446*^9}, {
   3.712999152156479*^9, 3.7129991536284103`*^9}, {3.712999227322372*^9, 
   3.712999230465135*^9}, {3.7129994959441633`*^9, 3.712999500478951*^9}, {
   3.712999543840272*^9, 3.712999574920445*^9}, {3.712999609340633*^9, 
   3.712999618951911*^9}, {3.7798051845285335`*^9, 3.7798051857436028`*^9}, {
   3.7798901732619886`*^9, 3.7798901762883935`*^9}, {3.7798902168640647`*^9, 
   3.779890267127353*^9}, 3.7798905116733828`*^9, {3.780033321771454*^9, 
   3.7800333238150578`*^9}, {3.7800335071153793`*^9, 
   3.7800335446958456`*^9}, {3.780037333838016*^9, 3.780037481382476*^9}, {
   3.78003757468624*^9, 3.780037575419441*^9}, {3.7800377612469673`*^9, 
   3.7800377875954137`*^9}, {3.7800378609623427`*^9, 
   3.7800378953916035`*^9}, {3.7800485755804462`*^9, 
   3.7800485796364527`*^9}, {3.780050509191242*^9, 3.780050525696071*^9}, {
   3.780050607487015*^9, 3.780050609842619*^9}, 3.780118235075061*^9, {
   3.7801187844632263`*^9, 3.7801188091736693`*^9}, {3.7801188440085306`*^9, 
   3.780119010887024*^9}, {3.780119188964337*^9, 3.7801192291500072`*^9}, {
   3.7801193548872285`*^9, 3.780119610777478*^9}, {3.780119647858743*^9, 
   3.7801198041554174`*^9}, {3.7801198361666737`*^9, 
   3.7801200113393817`*^9}, {3.7801200494190483`*^9, 3.780120150414626*^9}, 
   3.780120672641143*^9, {3.780120706876604*^9, 3.780120749417878*^9}, {
   3.780129595445424*^9, 3.7801296558578796`*^9}, {3.780129749202218*^9, 
   3.780129749532237*^9}, {3.7808954056690607`*^9, 3.7808954660211477`*^9}, {
   3.7808957430535374`*^9, 3.7808957433335376`*^9}, {3.780895798889616*^9, 
   3.7808958371216693`*^9}, {3.7808958852117367`*^9, 3.780895956428837*^9}, {
   3.780895992278887*^9, 3.780896019898926*^9}, {3.7808960524369745`*^9, 
   3.780896072798003*^9}, {3.780896108579053*^9, 3.780896140912099*^9}, {
   3.78089624567725*^9, 3.780896250397256*^9}, {3.780896337470378*^9, 
   3.780896349581395*^9}, {3.780896724217922*^9, 3.780896811188044*^9}, {
   3.7808977521016245`*^9, 3.780898044722036*^9}, {3.7808991897816424`*^9, 
   3.780899264442747*^9}, {3.780903988069971*^9, 3.780903988159971*^9}, {
   3.780904196472263*^9, 3.780904231033311*^9}, {3.780904263123356*^9, 
   3.780904293883399*^9}, {3.7809931453273687`*^9, 3.7809931464573703`*^9}, {
   3.795250846761405*^9, 3.795250848399408*^9}, {3.7953227131108303`*^9, 
   3.795322725771866*^9}, {3.7953228993352976`*^9, 3.795322900157299*^9}, {
   3.811044589701892*^9, 3.811044590031892*^9}, {3.8110446530770335`*^9, 
   3.8110446537970347`*^9}, {3.8110498438462563`*^9, 3.811049851146674*^9}, {
   3.811651223518022*^9, 3.811651248813469*^9}, {3.811651302755554*^9, 
   3.8116513755317163`*^9}, {3.8116514967016473`*^9, 3.8116514971956754`*^9}, 
   3.811653253757145*^9, {3.811653547265933*^9, 3.81165358148489*^9}, {
   3.81165520868115*^9, 3.811655225152173*^9}, {3.8116553034322824`*^9, 
   3.8116553297623196`*^9}, {3.8117422374248867`*^9, 3.811742254874911*^9}, {
   3.811742294964967*^9, 3.8117424004651146`*^9}, {3.8117424336751614`*^9, 
   3.8117424370651655`*^9}, {3.8117424984952517`*^9, 3.811742529965296*^9}, {
   3.8117425618653407`*^9, 3.8117425625153418`*^9}, {3.811742655745472*^9, 
   3.8117427092555466`*^9}, {3.8117430925760837`*^9, 3.811743112896112*^9}, {
   3.811743204867241*^9, 3.811743237187286*^9}, {3.8117433011973753`*^9, 
   3.811743301817376*^9}, {3.8117434191625414`*^9, 3.8117434502835846`*^9}, {
   3.811743483383631*^9, 3.811743665974887*^9}, {3.811743749045003*^9, 
   3.811743751135006*^9}, {3.8117438825527587`*^9, 3.8117438828927593`*^9}, {
   3.8117440315929675`*^9, 3.8117441628001585`*^9}, {3.8117443121603675`*^9, 
   3.81174431399037*^9}, {3.811744402500494*^9, 3.8117444071605005`*^9}, 
   3.8117444688005924`*^9, {3.811744513450655*^9, 3.811744551990709*^9}, {
   3.811744610680791*^9, 3.8117446575908566`*^9}, {3.811823126292921*^9, 
   3.811823155772962*^9}, {3.8118233244231987`*^9, 3.811823327693203*^9}, {
   3.8118233642832537`*^9, 3.811823371733265*^9}, {3.811825697852812*^9, 
   3.811825726692852*^9}, {3.811825772062916*^9, 3.8118258742530584`*^9}, {
   3.8118259051031017`*^9, 3.81182606827333*^9}, {3.811826099563374*^9, 
   3.8118261130233927`*^9}, {3.8118265862740555`*^9, 
   3.8118265884940586`*^9}, {3.8118266192541018`*^9, 3.811826671834175*^9}, {
   3.811826764804305*^9, 3.8118267969543505`*^9}, {3.811826993884626*^9, 
   3.8118269995646343`*^9}, {3.8118289012152967`*^9, 
   3.8118289057953033`*^9}, {3.811829041505493*^9, 3.8118290456154985`*^9}, {
   3.8118297623665023`*^9, 3.811829780296528*^9}, {3.8118300304568777`*^9, 
   3.811830091016962*^9}, {3.8118315925491753`*^9, 3.811831595259179*^9}, {
   3.811832948171073*^9, 3.8118329490210743`*^9}, {3.8118357373529787`*^9, 
   3.8118357421429853`*^9}, {3.812343859046462*^9, 3.8123439062721634`*^9}, {
   3.812343947220505*^9, 3.8123439543259115`*^9}, {3.8123440226338186`*^9, 
   3.812344022817829*^9}, {3.812346599370346*^9, 3.812346602617532*^9}, {
   3.812346713873895*^9, 3.8123467169270697`*^9}, {3.812346806546196*^9, 
   3.812346811705491*^9}, {3.8123468617663546`*^9, 3.81234686727767*^9}, {
   3.812346900796587*^9, 3.8123469635051737`*^9}, {3.8123469972491035`*^9, 
   3.812347007537692*^9}, {3.8127976289886928`*^9, 3.81279764828872*^9}, {
   3.8127986294293175`*^9, 3.8127986768893833`*^9}, {3.812871045127714*^9, 
   3.812871057697732*^9}, {3.8128711656739035`*^9, 3.8128711752439165`*^9}, {
   3.812956042895075*^9, 3.812956062185102*^9}, {3.8129561029551587`*^9, 
   3.8129561118151712`*^9}, {3.8129561439552164`*^9, 
   3.8129561944972873`*^9}, {3.8129562383003488`*^9, 3.812956316890459*^9}, {
   3.812956378430545*^9, 3.8129564217006054`*^9}, {3.8129565300907574`*^9, 
   3.8129565637808046`*^9}, {3.8129566081718664`*^9, 3.812956670741954*^9}, {
   3.8129567108220105`*^9, 3.8129569110222907`*^9}, {3.814162691763996*^9, 
   3.8141627445530157`*^9}, {3.8141627787929745`*^9, 3.814162798544104*^9}, 
   3.885193711437932*^9, {3.8851997636608667`*^9, 3.8851997816808147`*^9}, {
   3.8852015882341022`*^9, 3.8852016073676214`*^9}, {3.8852016645554285`*^9, 
   3.8852016771119156`*^9}, {3.88527941768419*^9, 3.8852794219983234`*^9}, {
   3.8852794685761237`*^9, 3.8852795240919423`*^9}, {3.8852829564374866`*^9, 
   3.8852829567559605`*^9}, {3.908249613525975*^9, 3.908249613727567*^9}, 
   3.90835133770154*^9, {3.9083544600978956`*^9, 3.908354478593601*^9}, {
   3.908356044773758*^9, 3.9083560449681125`*^9}, {3.9083564620125484`*^9, 
   3.908356511419305*^9}, {3.9083565529872475`*^9, 3.9083565699044857`*^9}, {
   3.9083566671777864`*^9, 3.9083566943418617`*^9}, {3.908358264410782*^9, 
   3.9083582749778614`*^9}, {3.9083612175175543`*^9, 3.9083612177632666`*^9}},
 
 CellLabel->"In[65]:=",ExpressionUUID->"2dd1f368-30e7-4800-a5e7-3502d943c42f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixed point calculation", "Subsection",
 CellChangeTimes->{{3.811653672385089*^9, 3.811653673309142*^9}, {
   3.8116552409221954`*^9, 3.8116552411321955`*^9}, 3.8139018209997683`*^9, {
   3.882436458987482*^9, 3.8824364593582973`*^9}, {3.8852830740688276`*^9, 
   3.8852830766745253`*^9}, {3.885283630852309*^9, 3.885283633813896*^9}, 
   3.907745369457729*^9},ExpressionUUID->"e1dcb94a-74b5-4dff-a892-\
8e966e2a3972"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Figures\\\\CF\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$save", "=", 
    RowBox[{"!", "True"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"par", "=", "#"}], ",", 
         RowBox[{"n", "=", 
          RowBox[{"#", "@", "n"}]}], ",", 
         RowBox[{"k", "=", 
          RowBox[{"#", "@", "k"}]}], ",", "fp", ",", "fx", ",", "fy", ",", 
         "x", ",", "y", ",", 
         RowBox[{"\[CapitalDelta]", "=", ".1"}], ",", "plot", ",", 
         RowBox[{"name", "=", 
          RowBox[{"#", "@", "\"\<Name\>\""}]}], ",", "la", ",", "tr", ",", 
         "jacobi", ",", "eval"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fp", "=", 
         RowBox[{"N", "@", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"fLa", "[", 
                 RowBox[{"la", ",", "tr"}], "]"}], "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"fTr", "[", 
                 RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
               RowBox[{
                RowBox[{"fSm", "[", 
                 RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
               RowBox[{"0", "<=", "la", "<=", "1"}], ",", 
               RowBox[{"0", "<=", "tr", "<=", "1"}]}], "}"}], "/.", "par"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"la", ",", "tr"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"jacobi", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"fLa", "[", 
                RowBox[{"la", ",", "tr"}], "]"}], ",", 
               RowBox[{"fTr", "[", 
                RowBox[{"la", ",", "tr"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"la", ",", "tr"}], "}"}], "}"}]}], "]"}], "/.", "fp"}],
           "/.", "par"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eval", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{"MaximalBy", "[", 
             RowBox[{
              RowBox[{"Eigenvalues", "@", "#"}], ",", 
              RowBox[{"Re", "@*", "N"}]}], "]"}]}], "&"}], "/@", "jacobi"}]}],
         ";", 
        RowBox[{"(*", " ", 
         RowBox[{"NOTE", ":", " ", 
          RowBox[{"Get", " ", "dominant", " ", "eigenvalues"}]}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"fp", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"Chop", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"la", ",", "tr", ",", 
                RowBox[{"1", "-", "la", "-", "tr"}]}], "}"}], "/.", "fp"}], 
             ")"}]}], "->", 
           RowBox[{"Thread", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Re", "@", "eval"}], "<", "0"}], ")"}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"fp", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EdgeForm", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"AbsoluteThickness", "@", "2"}], ",", "Black"}], 
             "}"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FaceForm", "@", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Last", "@", "#"}], ",", "Black", ",", "White"}], 
                 "]"}]}], ",", 
               RowBox[{"Disk", "[", 
                RowBox[{
                 RowBox[{"ternaryToSimplex", "@", 
                  RowBox[{"First", "@", "#"}]}], ",", 
                 RowBox[{"Scaled", "@", ".01"}]}], "]"}]}], "}"}], "&"}], "/@",
             "fp"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Echo", "@", "fp"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fx", ",", "fy"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Simplify", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"fLa", "[", 
               RowBox[{"x", ",", "y"}], "]"}], ",", 
              RowBox[{"fTr", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "/.", "par"}], "//",
           "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"plot", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"StreamPlot", "[", 
            RowBox[{
             RowBox[{"Evaluate", "@", 
              RowBox[{"{", 
               RowBox[{"fx", ",", "fy"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"0", "-", "\[CapitalDelta]"}], ",", 
               RowBox[{"1", "+", "\[CapitalDelta]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"0", "-", "\[CapitalDelta]"}], ",", 
               RowBox[{"1", "+", "\[CapitalDelta]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "False"}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"Column", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"name", ",", 
                  RowBox[{"KeyDrop", "[", 
                   RowBox[{"#", ",", "\"\<Name\>\""}], "]"}]}], "}"}], ",", 
                RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "$SimplexBoundary", ",", "fp", ",", "$SimplexCornerLabels"}], 
               "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotRangePadding", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Scaled", "@", "0.05"}], ",", 
                RowBox[{"Scaled", "@", "0.05"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Background", "\[Rule]", "White"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StreamPoints", "\[Rule]", "150"}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Arrow", "[", "c_List", "]"}], "\[RuleDelayed]", 
             RowBox[{"Arrow", "[", 
              RowBox[{"cartesianToSimplex", "/@", "c"}], "]"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"GraphicsComplex", "[", 
             RowBox[{"c_List", ",", "x___"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"GraphicsComplex", "[", 
             RowBox[{
              RowBox[{"cartesianToSimplex", "/@", "c"}], ",", "x"}], "]"}]}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"$save", ",", 
          RowBox[{"Echo", "@", 
           RowBox[{"PathButton", "@", 
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "@", 
               RowBox[{"{", 
                RowBox[{"dir", ",", 
                 RowBox[{"name", "<>", "\"\<_FixedPoints.jpg\>\""}]}], 
                "}"}]}], ",", "plot", ",", "\"\<JPEG\>\"", ",", 
              RowBox[{"ImageResolution", "->", "300"}]}], "]"}]}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", "plot"}]}], "\[IndentingNewLine]", "]"}], 
     "&"}], "/@", "$ParameterSets"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"$save", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "@", 
      RowBox[{"{", 
       RowBox[{"dir", ",", "\"\<CF_FixedPoints_All.jpg\>\""}], "}"}]}], ",", 
     RowBox[{"Multicolumn", "[", 
      RowBox[{"plots", ",", "2", ",", 
       RowBox[{"Appearance", "\[Rule]", "\"\<Horizontal\>\""}]}], "]"}], ",", 
     "\"\<JPEG\>\"", ",", 
     RowBox[{"ImageResolution", "->", "300"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8129569545223513`*^9, 3.8129569572823553`*^9}, {
   3.8129570180224404`*^9, 3.8129570979825525`*^9}, {3.8129599453578634`*^9, 
   3.8129599511978717`*^9}, {3.8129600745990443`*^9, 3.812960125749116*^9}, {
   3.8129601639991693`*^9, 3.8129602164992433`*^9}, {3.8131157515471563`*^9, 
   3.8131157564471626`*^9}, {3.8132037412892327`*^9, 
   3.8132038034637003`*^9}, {3.8139018174515653`*^9, 
   3.8139018186776357`*^9}, {3.814163861190506*^9, 3.8141638828367443`*^9}, {
   3.8851126832935953`*^9, 3.8851126867483797`*^9}, {3.8851139662025857`*^9, 
   3.885114096512355*^9}, {3.8851141670270367`*^9, 3.8851145144293222`*^9}, {
   3.885114799020385*^9, 3.8851148380464973`*^9}, {3.8851148733711786`*^9, 
   3.885114952332509*^9}, {3.8851153335225763`*^9, 3.885115338657236*^9}, {
   3.8851156832851863`*^9, 3.885115703252405*^9}, 3.885116022622884*^9, {
   3.885196144361766*^9, 3.8851961493834352`*^9}, 3.8851962194221177`*^9, {
   3.8851964793080783`*^9, 3.885196501631298*^9}, {3.8851973125668373`*^9, 
   3.8851973243132405`*^9}, {3.8852020495433173`*^9, 3.885202107614574*^9}, {
   3.8852024294063616`*^9, 3.8852024359109764`*^9}, 3.8852795614236403`*^9, {
   3.8852795952225485`*^9, 3.8852796310521007`*^9}, {3.885279664817444*^9, 
   3.8852796852953033`*^9}, 3.8852798189453936`*^9, {3.8852801174773993`*^9, 
   3.8852801259632106`*^9}, {3.8852801570406713`*^9, 3.885280284240474*^9}, {
   3.8852826991717815`*^9, 3.8852828831551514`*^9}, {3.8852829149492035`*^9, 
   3.8852829262677803`*^9}, {3.885282964306138*^9, 3.8852829673879423`*^9}, 
   3.885283181066635*^9, {3.9079184982972164`*^9, 3.907918505823101*^9}, 
   3.9079264174849653`*^9, {3.9079301829116306`*^9, 3.907930187223592*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"7e39ba62-bec7-4b95-a76d-148e6646845f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixed point calculation, with hi quality vector-field BG", "Subsection",
 CellChangeTimes->{{3.8139018105161686`*^9, 3.813901811427221*^9}, {
   3.8851164257597013`*^9, 3.8851164367401147`*^9}, {3.8852830805352163`*^9, 
   3.8852830985452986`*^9}, 3.8852836361755652`*^9, {3.9077453717604904`*^9, 
   3.9077453721444397`*^9}},ExpressionUUID->"fe204cbe-ddf3-4b7c-96b6-\
ea29b72df94c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Figures\\\\CF\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$save", "=", 
   RowBox[{"Setting", "@", 
    CheckboxBox[False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$labelled", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$imageSize", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$flowPoints", "=", "500"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "distinct", " ", "flow", " ", "lines"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$streamColorFunction", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"Opacity", "@", ".2"}], ",", 
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<BlueGreenYellow\>\"", "]"}], "[", 
         "#3", "]"}]}], "]"}], "&"}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fx", ",", "fy", ",", "fp", ",", "plot", ",", 
       RowBox[{"name", "=", 
        RowBox[{"par", "@", "\"\<Name\>\""}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"par", "@", "n"}]}], ",", 
       RowBox[{"k", "=", 
        RowBox[{"par", "@", "k"}]}], ",", "la", ",", "tr", ",", "jacobi", ",",
        "eval", ",", 
       RowBox[{"gridPts", "=", 
        RowBox[{"randomCartesianPoint", "@", "$flowPoints"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fp", "=", 
       RowBox[{"N", "@", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"fLa", "[", 
               RowBox[{"la", ",", "tr"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"fTr", "[", 
               RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
             RowBox[{
              RowBox[{"fSm", "[", 
               RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
             RowBox[{"0", "<=", "la", "<=", "1"}], ",", 
             RowBox[{"0", "<=", "tr", "<=", "1"}]}], "}"}], "/.", "par"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"la", ",", "tr"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"jacobi", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"fLa", "[", 
              RowBox[{"la", ",", "tr"}], "]"}], ",", 
             RowBox[{"fTr", "[", 
              RowBox[{"la", ",", "tr"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"la", ",", "tr"}], "}"}], "}"}]}], "]"}], "/.", "fp"}], "/.",
         "par"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eval", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"MaximalBy", "[", 
           RowBox[{
            RowBox[{"Eigenvalues", "@", "#"}], ",", 
            RowBox[{"Re", "@*", "N"}]}], "]"}]}], "&"}], "/@", "jacobi"}]}], 
      ";", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"Get", " ", "dominant", " ", "eigenvalues"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"fp", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"Chop", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"la", ",", "tr", ",", 
              RowBox[{"1", "-", "la", "-", "tr"}]}], "}"}], "/.", "fp"}], 
           ")"}]}], "->", 
         RowBox[{"Thread", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Re", "@", "eval"}], "<", "0"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fp", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"AbsoluteThickness", "@", "2"}], ",", "Black"}], "}"}]}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FaceForm", "@", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Last", "@", "#"}], ",", "Black", ",", "White"}], 
               "]"}]}], ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"ternaryToSimplex", "@", 
                RowBox[{"First", "@", "#"}]}], ",", 
               RowBox[{"Scaled", "@", ".01"}]}], "]"}]}], "}"}], "&"}], "/@", 
          "fp"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fx", ",", "fy"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "/@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"fLa", "[", 
             RowBox[{"x", ",", "y"}], "]"}], ",", 
            RowBox[{"fTr", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "/.", "par"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StreamPlot", "[", 
            RowBox[{
             RowBox[{"Evaluate", "@", 
              RowBox[{"{", 
               RowBox[{"fx", ",", "fy"}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
              "$SimplexCartesianRegion"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "False"}], ",", 
             RowBox[{"Mesh", "->", "False"}], ",", 
             RowBox[{"FrameTicks", "->", "False"}], ",", 
             RowBox[{"Ticks", "->", "False"}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotLabel", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{"$labelled", ",", 
                RowBox[{"Column", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"name", ",", 
                    RowBox[{"KeyDrop", "[", 
                    RowBox[{"par", ",", "\"\<Name\>\""}], "]"}]}], "}"}], ",", 
                  RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
                "None"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"fp", ",", 
                RowBox[{"{", 
                 RowBox[{"Black", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{"$labelled", ",", "$SimplexCornerLabels", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "$imageSize"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotRangePadding", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Scaled", "@", "0.05"}], ",", 
                RowBox[{"Scaled", "@", "0.05"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
             RowBox[{"Background", "\[Rule]", "White"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"RegionFillingStyle", "->", "None"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "StreamColorFunction", "\[Rule]", "$streamColorFunction"}], ",", 
             
             RowBox[{"StreamColorFunctionScaling", "\[Rule]", "True"}], ",", 
             RowBox[{"StreamStyle", "\[Rule]", "None"}], ",", 
             RowBox[{"StreamPoints", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"gridPts", ",", "Automatic", ",", "20"}], "}"}]}], 
             RowBox[{"(*", "Fine", "*)"}], ",", 
             RowBox[{"StreamMarkers", "\[Rule]", "\"\<Line\>\""}], ",", 
             RowBox[{"StreamScale", "\[Rule]", ".1"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"StreamPlot", "[", 
            RowBox[{
             RowBox[{"Evaluate", "@", 
              RowBox[{"{", 
               RowBox[{"fx", ",", "fy"}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
              "$SimplexCartesianRegion"}], ",", "\[IndentingNewLine]", 
             RowBox[{"RegionFillingStyle", "->", "None"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"BoundaryStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"AbsoluteThickness", "@", "2"}], ",", 
                RowBox[{"GrayLevel", "@", ".3"}]}], "]"}]}], ",", 
             RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StreamScale", "\[Rule]", ".07"}], ",", 
             RowBox[{"StreamColorFunction", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"GrayLevel", "[", ".37", "]"}], "&"}], ")"}]}], ",", 
             RowBox[{"StreamPoints", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"300", ",", ".01"}], "}"}]}]}], "\[IndentingNewLine]", 
            "]"}]}], "\[IndentingNewLine]", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Arrow", "[", "c_List", "]"}], "\[RuleDelayed]", 
           RowBox[{"Arrow", "[", 
            RowBox[{"cartesianToSimplex", "/@", "c"}], "]"}]}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GraphicsComplex", "[", 
           RowBox[{"c_List", ",", "x___"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"GraphicsComplex", "[", 
           RowBox[{
            RowBox[{"cartesianToSimplex", "/@", "c"}], ",", "x"}], "]"}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"plot", ",", 
        RowBox[{"If", "[", 
         RowBox[{"$save", ",", "\[IndentingNewLine]", 
          RowBox[{"PathButton", "@", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "@", 
              RowBox[{"{", 
               RowBox[{"dir", ",", 
                RowBox[{"name", "<>", 
                 RowBox[{"If", "[", 
                  RowBox[{
                  "$labelled", ",", "\"\<_labelled\>\"", ",", "\"\<\>\""}], 
                  "]"}], "<>", "\"\<.jpg\>\""}]}], "}"}]}], ",", "plot", ",", 
             "\"\<JPEG\>\"", ",", 
             RowBox[{"ImageResolution", "->", "600"}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", "SpanFromLeft"}], "]"}]}], "}"}]}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"par", ",", 
     RowBox[{"Take", "[", 
      RowBox[{"$ParameterSets", ",", "All"}], "]"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7128988524081993`*^9, 3.712898974978279*^9}, 
   3.712899028580853*^9, {3.712899221653963*^9, 3.712899324109664*^9}, {
   3.712901159906414*^9, 3.71290116231283*^9}, {3.7129014439385443`*^9, 
   3.7129015475334697`*^9}, {3.71290157813422*^9, 3.712901587025728*^9}, {
   3.7129016600279036`*^9, 3.71290176556094*^9}, {3.7129063938416624`*^9, 
   3.7129063942876883`*^9}, {3.7129064441575403`*^9, 3.712906598999397*^9}, {
   3.712906656487685*^9, 3.7129066924737434`*^9}, {3.712906743308651*^9, 
   3.712906775654501*^9}, 3.7129068534269495`*^9, {3.712907121673292*^9, 
   3.712907142316473*^9}, {3.7129074406225348`*^9, 3.71290767569598*^9}, {
   3.712907720498543*^9, 3.7129077272569294`*^9}, {3.7129090481414795`*^9, 
   3.712909131880269*^9}, {3.7129091623960147`*^9, 3.7129091633200674`*^9}, {
   3.71290921615609*^9, 3.7129094106892166`*^9}, {3.7129094478093395`*^9, 
   3.7129094951910496`*^9}, 3.712909544708882*^9, {3.712913601397911*^9, 
   3.71291362166007*^9}, {3.7129136595882397`*^9, 3.7129136858847437`*^9}, {
   3.7129143788083763`*^9, 3.712914425919071*^9}, {3.712914465046309*^9, 
   3.7129144746738596`*^9}, {3.712914511027939*^9, 3.7129145575345993`*^9}, {
   3.7129146335589476`*^9, 3.7129146572113*^9}, {3.7129148106180744`*^9, 
   3.7129148617249975`*^9}, {3.7129151281482363`*^9, 3.712915177096036*^9}, {
   3.712916516783662*^9, 3.712916569938702*^9}, {3.712917832098893*^9, 
   3.7129178986467*^9}, {3.712917959513181*^9, 3.7129179715088673`*^9}, {
   3.7129184680392675`*^9, 3.712918528042699*^9}, {3.7129207085244155`*^9, 
   3.7129207889170136`*^9}, {3.712920907584801*^9, 3.7129210385402913`*^9}, {
   3.712921143800312*^9, 3.7129211949672384`*^9}, {3.71299093755571*^9, 
   3.712991014002537*^9}, {3.712991735499424*^9, 3.712991741302186*^9}, {
   3.71299177843685*^9, 3.712991817085967*^9}, 3.71299184991965*^9, {
   3.712991904037283*^9, 3.712991929784976*^9}, {3.712991967941709*^9, 
   3.7129920540927563`*^9}, {3.712992206729158*^9, 3.712992216853477*^9}, {
   3.7129922795445433`*^9, 3.712992291657662*^9}, {3.712992493258033*^9, 
   3.712992526817498*^9}, {3.71299255910505*^9, 3.712992614473853*^9}, {
   3.7129926472298098`*^9, 3.7129926969276752`*^9}, {3.7129927280595617`*^9, 
   3.7129927350467863`*^9}, {3.712992888611568*^9, 3.7129929821889753`*^9}, 
   3.712996237135991*^9, {3.7129963213540287`*^9, 3.7129963218928823`*^9}, {
   3.71299637394757*^9, 3.7129964782335443`*^9}, {3.712996732244549*^9, 
   3.712996732744384*^9}, {3.7129974236483593`*^9, 3.712997521267351*^9}, {
   3.71299878150066*^9, 3.712998781765644*^9}, {3.712998874235648*^9, 
   3.712998932139945*^9}, {3.7129990471060247`*^9, 3.712999047646446*^9}, {
   3.712999152156479*^9, 3.7129991536284103`*^9}, {3.712999227322372*^9, 
   3.712999230465135*^9}, {3.7129994959441633`*^9, 3.712999500478951*^9}, {
   3.712999543840272*^9, 3.712999574920445*^9}, {3.712999609340633*^9, 
   3.712999618951911*^9}, {3.7798051845285335`*^9, 3.7798051857436028`*^9}, {
   3.7798901732619886`*^9, 3.7798901762883935`*^9}, {3.7798902168640647`*^9, 
   3.779890267127353*^9}, 3.7798905116733828`*^9, {3.780033321771454*^9, 
   3.7800333238150578`*^9}, {3.7800335071153793`*^9, 
   3.7800335446958456`*^9}, {3.780037333838016*^9, 3.780037481382476*^9}, {
   3.78003757468624*^9, 3.780037575419441*^9}, {3.7800377612469673`*^9, 
   3.7800377875954137`*^9}, {3.7800378609623427`*^9, 
   3.7800378953916035`*^9}, {3.7800485755804462`*^9, 
   3.7800485796364527`*^9}, {3.780050509191242*^9, 3.780050525696071*^9}, {
   3.780050607487015*^9, 3.780050609842619*^9}, 3.780118235075061*^9, {
   3.7801187844632263`*^9, 3.7801188091736693`*^9}, {3.7801188440085306`*^9, 
   3.780119010887024*^9}, {3.780119188964337*^9, 3.7801192291500072`*^9}, {
   3.7801193548872285`*^9, 3.780119610777478*^9}, {3.780119647858743*^9, 
   3.7801198041554174`*^9}, {3.7801198361666737`*^9, 
   3.7801200113393817`*^9}, {3.7801200494190483`*^9, 3.780120150414626*^9}, 
   3.780120672641143*^9, {3.780120706876604*^9, 3.780120749417878*^9}, {
   3.780129595445424*^9, 3.7801296558578796`*^9}, {3.780129749202218*^9, 
   3.780129749532237*^9}, {3.7808954056690607`*^9, 3.7808954660211477`*^9}, {
   3.7808957430535374`*^9, 3.7808957433335376`*^9}, {3.780895798889616*^9, 
   3.7808958371216693`*^9}, {3.7808958852117367`*^9, 3.780895956428837*^9}, {
   3.780895992278887*^9, 3.780896019898926*^9}, {3.7808960524369745`*^9, 
   3.780896072798003*^9}, {3.780896108579053*^9, 3.780896140912099*^9}, {
   3.78089624567725*^9, 3.780896250397256*^9}, {3.780896337470378*^9, 
   3.780896349581395*^9}, {3.780896724217922*^9, 3.780896811188044*^9}, {
   3.7808977521016245`*^9, 3.780898044722036*^9}, {3.7808991897816424`*^9, 
   3.780899264442747*^9}, {3.780903988069971*^9, 3.780903988159971*^9}, {
   3.780904196472263*^9, 3.780904231033311*^9}, {3.780904263123356*^9, 
   3.780904293883399*^9}, {3.7809931453273687`*^9, 3.7809931464573703`*^9}, {
   3.795250846761405*^9, 3.795250848399408*^9}, {3.7953227131108303`*^9, 
   3.795322725771866*^9}, {3.7953228993352976`*^9, 3.795322900157299*^9}, {
   3.811044589701892*^9, 3.811044590031892*^9}, {3.811044660337044*^9, 
   3.811044661597046*^9}, {3.8116535290638914`*^9, 3.8116535921094975`*^9}, {
   3.811654251128191*^9, 3.8116543290906506`*^9}, 3.8116552356621876`*^9, {
   3.8117424576551948`*^9, 3.8117424768652215`*^9}, {3.811742685405514*^9, 
   3.811742699375533*^9}, {3.8117427561056128`*^9, 3.811742762305621*^9}, 
   3.811743248077301*^9, {3.8117433040373793`*^9, 3.8117433047973804`*^9}, {
   3.81174385493172*^9, 3.811743875592749*^9}, {3.811743985912904*^9, 
   3.811743988012906*^9}, {3.8117449142492375`*^9, 3.8117449562022963`*^9}, {
   3.811745959095278*^9, 3.8117459593952785`*^9}, {3.811823217123048*^9, 
   3.811823301783167*^9}, {3.8118234176033287`*^9, 3.811823446573369*^9}, {
   3.8118235540335197`*^9, 3.8118235932235746`*^9}, 3.811823755013801*^9, {
   3.811824373122679*^9, 3.8118244001827173`*^9}, {3.8118244341927648`*^9, 
   3.81182450406297*^9}, {3.8118245635030727`*^9, 3.8118246796932354`*^9}, {
   3.811824710343279*^9, 3.8118247637833533`*^9}, {3.8118247947353992`*^9, 
   3.8118250113518505`*^9}, {3.811825060001919*^9, 3.811825069611932*^9}, {
   3.811825635442724*^9, 3.8118256357327247`*^9}, {3.811826177053482*^9, 
   3.81182620388352*^9}, {3.8118262896836405`*^9, 3.811826302943659*^9}, {
   3.8118264538238697`*^9, 3.8118265581440163`*^9}, {3.8118268234543877`*^9, 
   3.811826936794546*^9}, {3.811827022994667*^9, 3.811827058044716*^9}, {
   3.811827122854807*^9, 3.811827517586359*^9}, {3.8118275625264225`*^9, 
   3.8118276251565104`*^9}, {3.8118278783168645`*^9, 3.8118279054769025`*^9}, 
   3.8118279533969693`*^9, 3.81182806103712*^9, 3.8118281019771776`*^9, {
   3.8118281328072205`*^9, 3.8118282484973826`*^9}, {3.8118283701995535`*^9, 
   3.811828652853949*^9}, {3.8118286938840065`*^9, 3.811828720654044*^9}, {
   3.811828782935131*^9, 3.811828839775211*^9}, {3.8118289194853225`*^9, 
   3.8118290376254873`*^9}, {3.8118294346260433`*^9, 
   3.8118295172861595`*^9}, {3.811829563006223*^9, 3.8118295631862235`*^9}, {
   3.811829604676282*^9, 3.8118296098462887`*^9}, {3.8118298722866564`*^9, 
   3.811829902696699*^9}, {3.8118299750168*^9, 3.811830002876839*^9}, {
   3.811830126707012*^9, 3.811830136547026*^9}, {3.8118302102971296`*^9, 
   3.8118302118771315`*^9}, {3.811831492049034*^9, 3.8118315672891397`*^9}, {
   3.8118317147993464`*^9, 3.8118320059897537`*^9}, {3.8118322032000303`*^9, 
   3.8118324640603952`*^9}, {3.811832497140442*^9, 3.8118325257404814`*^9}, {
   3.811832582230561*^9, 3.8118325824405613`*^9}, {3.8118326184606113`*^9, 
   3.811832640000642*^9}, {3.8118326850807047`*^9, 3.8118326852907047`*^9}, {
   3.8118327804208384`*^9, 3.8118328696309633`*^9}, {3.8118330554522233`*^9, 
   3.8118330843922634`*^9}, {3.8118331280723248`*^9, 3.811833153672361*^9}, {
   3.8118331848924046`*^9, 3.811833304642572*^9}, 3.8118353899524918`*^9, 
   3.8118354527525797`*^9, {3.8118355104126606`*^9, 3.8118355140726657`*^9}, {
   3.811835750072996*^9, 3.8118357724030275`*^9}, {3.8118358525531397`*^9, 
   3.811835873503169*^9}, 3.8118359169332294`*^9, {3.8118359716033063`*^9, 
   3.811836156293565*^9}, {3.8118361874236083`*^9, 3.8118363398338213`*^9}, 
   3.811836372713868*^9, 3.8118364225839376`*^9, {3.81183658835417*^9, 
   3.811836791934455*^9}, {3.811836886244587*^9, 3.8118370522748194`*^9}, {
   3.8118370916948743`*^9, 3.8118374646753964`*^9}, {3.8118374968754416`*^9, 
   3.8118376828297043`*^9}, 3.812343984460635*^9, {3.812344034135476*^9, 
   3.812344044546072*^9}, {3.8123441150271034`*^9, 3.812344116391181*^9}, {
   3.8123445698331165`*^9, 3.8123446162457714`*^9}, 3.812344749654402*^9, {
   3.81234478930367*^9, 3.8123448869772563`*^9}, {3.812344953760076*^9, 
   3.812345101772542*^9}, {3.812345148298203*^9, 3.8123451504413257`*^9}, {
   3.8123451899085827`*^9, 3.8123451909096403`*^9}, 3.812346639754656*^9, {
   3.8123477147439575`*^9, 3.812347724243971*^9}, 3.812797562188599*^9, {
   3.8129529892588615`*^9, 3.812952989788892*^9}, {3.81295305707374*^9, 
   3.8129530607149487`*^9}, {3.812953116292127*^9, 3.8129531491630077`*^9}, {
   3.8129532378720813`*^9, 3.81295324047423*^9}, {3.8129535342706146`*^9, 
   3.8129536108119926`*^9}, {3.81295370080514*^9, 3.8129537029942656`*^9}, {
   3.812953782584818*^9, 3.812953783000841*^9}, {3.8129539097290897`*^9, 
   3.812953945536138*^9}, {3.8129569711523747`*^9, 3.8129569939324064`*^9}, {
   3.8129571204425836`*^9, 3.8129571318525996`*^9}, {3.812957176282662*^9, 
   3.8129572280927343`*^9}, {3.812957271822796*^9, 3.8129573562129135`*^9}, {
   3.8129574310330186`*^9, 3.8129575387231693`*^9}, {3.812957580023227*^9, 
   3.8129575888232393`*^9}, {3.812957684689669*^9, 3.81295769983969*^9}, {
   3.8129578136858788`*^9, 3.8129579044370055`*^9}, {3.8129584163377223`*^9, 
   3.8129584621177864`*^9}, {3.8129585548779163`*^9, 
   3.8129585845879583`*^9}, {3.8129586240380135`*^9, 
   3.8129586244880137`*^9}, {3.8129586811080933`*^9, 
   3.8129586814080935`*^9}, {3.8129587366581707`*^9, 3.812958841878318*^9}, {
   3.8129588786683693`*^9, 3.8129589276484385`*^9}, {3.812958966778493*^9, 
   3.812959109888693*^9}, {3.812959145988744*^9, 3.81295924303088*^9}, {
   3.8129593279919987`*^9, 3.812959330092002*^9}, {3.8129595049042463`*^9, 
   3.8129595824973555`*^9}, 3.812959622167411*^9, {3.8129596857475*^9, 
   3.81295969321751*^9}, 3.8129597539875956`*^9, {3.8129597896976457`*^9, 
   3.8129598765377674`*^9}, {3.8129599974379363`*^9, 
   3.8129600686590357`*^9}, {3.8129602320292645`*^9, 
   3.8129603339894075`*^9}, {3.8137748058190174`*^9, 
   3.8137748412490673`*^9}, {3.81407330774756*^9, 3.8140733350275984`*^9}, {
   3.8141628395544496`*^9, 3.814162840277491*^9}, {3.8141700544375424`*^9, 
   3.8141700609989176`*^9}, {3.8142464534743757`*^9, 3.81424646456401*^9}, {
   3.8142465321418753`*^9, 3.814246553362089*^9}, {3.8142466042970023`*^9, 
   3.814246604383007*^9}, {3.8142466582680893`*^9, 3.81424674272092*^9}, {
   3.8142467852113504`*^9, 3.8142468234715385`*^9}, {3.8142468655389447`*^9, 
   3.81424696825782*^9}, {3.8142469989315743`*^9, 3.81424702298995*^9}, {
   3.814247083628419*^9, 3.814247140839691*^9}, {3.8142473196359177`*^9, 
   3.8142473198229284`*^9}, {3.81424749696706*^9, 3.814247503635442*^9}, {
   3.814247552875258*^9, 3.814247600345973*^9}, {3.8142476464396095`*^9, 
   3.814247742484103*^9}, {3.814247867551256*^9, 3.814247889260498*^9}, {
   3.8142480567240763`*^9, 3.814248081384487*^9}, {3.814248131740367*^9, 
   3.81424815714682*^9}, {3.814248603885372*^9, 3.814248620385316*^9}, {
   3.8437071451652575`*^9, 3.843707150276494*^9}, {3.843707183680286*^9, 
   3.843707230330222*^9}, {3.843707408273813*^9, 3.8437074270478106`*^9}, {
   3.8437074692397833`*^9, 3.8437074941246386`*^9}, {3.843707530383296*^9, 
   3.8437075794592233`*^9}, 3.8437076233668995`*^9, {3.845010479493718*^9, 
   3.845010496652381*^9}, {3.845010560727725*^9, 3.8450106155049267`*^9}, {
   3.845011359502488*^9, 3.8450114480822625`*^9}, {3.845011514765334*^9, 
   3.8450115455816965`*^9}, {3.8450115756765146`*^9, 
   3.8450116475527887`*^9}, {3.8450116833905315`*^9, 3.845011936403373*^9}, {
   3.8450120146259766`*^9, 3.8450121323364067`*^9}, {3.845012187408829*^9, 
   3.8450122576601324`*^9}, {3.8450123172548447`*^9, 
   3.8450124298784103`*^9}, {3.8450124735270877`*^9, 3.845012840772312*^9}, {
   3.845012908919922*^9, 3.8450129422440557`*^9}, {3.8450130974325314`*^9, 
   3.8450131803254814`*^9}, {3.845013218965231*^9, 3.8450132340689325`*^9}, {
   3.8450133967353225`*^9, 3.8450134495922937`*^9}, {3.8450136120126534`*^9, 
   3.8450136566400113`*^9}, {3.8450137638705826`*^9, 3.845013807496838*^9}, {
   3.8450138421052303`*^9, 3.8450138825309296`*^9}, {3.8450141936196256`*^9, 
   3.845014330066331*^9}, {3.8450143620907717`*^9, 3.84501448250522*^9}, {
   3.845014547265653*^9, 3.8450145660560274`*^9}, {3.845014602279086*^9, 
   3.8450146222721167`*^9}, {3.8450146538833866`*^9, 3.8450147267927313`*^9}, 
   3.86116472190705*^9, 3.8611711862974405`*^9, 3.861243460184227*^9, {
   3.885024625914526*^9, 3.885024629425409*^9}, {3.885024666566039*^9, 
   3.8850247070172076`*^9}, {3.885024847106233*^9, 3.8850249220135064`*^9}, {
   3.8850250587600803`*^9, 3.885025131893716*^9}, 3.8850251753719435`*^9, {
   3.885025386358943*^9, 3.8850254952288847`*^9}, {3.8850256112477016`*^9, 
   3.885025665628931*^9}, {3.8850257042083035`*^9, 3.8850257054394145`*^9}, 
   3.885025735668522*^9, {3.885025846672432*^9, 3.885025978879383*^9}, {
   3.885026025891346*^9, 3.8850261236660185`*^9}, {3.885026157353324*^9, 
   3.8850262526407623`*^9}, {3.885026287260377*^9, 3.8850262873531485`*^9}, {
   3.885026465513856*^9, 3.8850264677166753`*^9}, {3.8850266538661375`*^9, 
   3.885026930515854*^9}, {3.885026973484988*^9, 3.8850270888695774`*^9}, {
   3.8850272966547594`*^9, 3.885027378295901*^9}, {3.8850274295112667`*^9, 
   3.8850275512365303`*^9}, {3.8850275966226606`*^9, 
   3.8850276159386444`*^9}, {3.8850276543833685`*^9, 3.885027850333411*^9}, {
   3.885027887799326*^9, 3.8850279148411045`*^9}, {3.885027949179531*^9, 
   3.8850279630180583`*^9}, {3.8850279985408936`*^9, 3.885028077442147*^9}, {
   3.885028137566324*^9, 3.885028143021866*^9}, {3.885028211909623*^9, 
   3.8850285938370676`*^9}, {3.8850286436067877`*^9, 
   3.8850286599567947`*^9}, {3.885028694055255*^9, 3.8850287222242546`*^9}, {
   3.8850287564478493`*^9, 3.885028774541668*^9}, {3.885028840506548*^9, 
   3.8850288489014807`*^9}, 3.8850296869278173`*^9, {3.885112616179118*^9, 
   3.8851126208615985`*^9}, {3.8851127021557493`*^9, 
   3.8851127288678093`*^9}, {3.885113368464224*^9, 3.8851134448592744`*^9}, {
   3.8851134787636557`*^9, 3.8851135242468767`*^9}, 3.885113902110379*^9, {
   3.8851145714233894`*^9, 3.8851146043763437`*^9}, {3.885114843186096*^9, 
   3.885114859145609*^9}, {3.8851157199633512`*^9, 3.885115724372466*^9}, {
   3.885116089933784*^9, 3.8851161068976173`*^9}, 3.8851161538828983`*^9, {
   3.8851164428860497`*^9, 3.885116446792308*^9}, {3.8851165151506605`*^9, 
   3.885116516725235*^9}, 3.8851964425127244`*^9, {3.885196508524829*^9, 
   3.885196514548543*^9}, {3.8851967939903*^9, 3.8851969094812145`*^9}, {
   3.8851970951720743`*^9, 3.885197095421831*^9}, {3.8851972194198313`*^9, 
   3.885197250179617*^9}, {3.8852829909746237`*^9, 3.8852829921773653`*^9}, {
   3.885283028775766*^9, 3.885283049535723*^9}, {3.885283192540947*^9, 
   3.8852831926177216`*^9}, {3.8852846157577367`*^9, 3.885284648779677*^9}, {
   3.885284718207427*^9, 3.885284798238181*^9}, {3.8852848309660387`*^9, 
   3.885284869999301*^9}, {3.8852849176104393`*^9, 3.885285120675305*^9}, 
   3.8852851854038343`*^9, {3.885285311739051*^9, 3.8852853405871053`*^9}, {
   3.8852853920826693`*^9, 3.8852854139569926`*^9}, {3.885285524852676*^9, 
   3.885285556384644*^9}, {3.885285589538989*^9, 3.885285591830228*^9}, 
   3.8852856289788713`*^9, {3.8852856793321*^9, 3.88528593087871*^9}, 
   3.885285976223634*^9, {3.885286081721127*^9, 3.88528610550457*^9}, {
   3.9077458415980873`*^9, 3.9077458434679737`*^9}, 
   3.916904255886944*^9},ExpressionUUID->"2e9ea5fa-cbe0-4800-8228-\
9958aa4b8da8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bifurcation analysis", "Subsection",
 CellChangeTimes->{{3.9077466781102395`*^9, 3.9077466808140144`*^9}, {
   3.907756473399252*^9, 3.9077564744332914`*^9}, {3.907917698413771*^9, 
   3.907917701116048*^9}, 3.9079212184299383`*^9, {3.907921524820731*^9, 
   3.907921531979704*^9}, {3.9079276369001913`*^9, 
   3.9079276403616924`*^9}},ExpressionUUID->"cfbb4476-4c23-4b52-9e28-\
9512fd92390d"],

Cell["Only internal fixed points are considered.", "Item",
 CellChangeTimes->{{3.9079276523553476`*^9, 3.9079276589750323`*^9}, {
  3.9079855797961864`*^9, 
  3.9079855798117323`*^9}},ExpressionUUID->"f07ac1b0-4c9f-4766-9204-\
595fdda056b1"],

Cell[CellGroupData[{

Cell["\<\
For different subsystems, different parameter sets are selected.\
\>", "Item",
 CellChangeTimes->{{3.9079276523553476`*^9, 3.9079276589750323`*^9}, {
  3.907985580228546*^9, 
  3.9079855945318885`*^9}},ExpressionUUID->"2a6dda3d-f190-4b24-982f-\
806bddc132d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colors", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<Lazy\>\"", "->", 
      TemplateBox[<|"color" -> RGBColor[1, 0.15, 0.194885]|>,
       "RGBColorSwatchTemplate"]}], ",", 
     RowBox[{"\"\<Trusty\>\"", "->", 
      TemplateBox[<|"color" -> RGBColor[0.4, 0.77, 0]|>,
       "RGBColorSwatchTemplate"]}], ",", 
     RowBox[{"\"\<Smart\>\"", "->", 
      TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
       "RGBColorSwatchTemplate"]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lines", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<Stable\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<Unstable\>\"", "->", "Dashed"}]}], "|>"}]}], ";", 
  RowBox[{"markers", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<Stable\>\"", "->", 
      RowBox[{"Graphics", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "@", "None"}], ",", 
         RowBox[{"Disk", "[", "]"}]}], "}"}]}]}], ",", 
     RowBox[{"\"\<Unstable\>\"", "->", 
      RowBox[{"Graphics", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "@", 
          RowBox[{"AbsoluteThickness", "@", "2"}]}], ",", 
         RowBox[{"Circle", "[", "]"}]}], "}"}]}]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stability", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Stable\>\"", ",", "\"\<Stable\>\"", ",", "\"\<Unstable\>\"", ",", 
     "\"\<Unstable\>\""}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.907927678281325*^9, 3.9079276784683223`*^9}, {
   3.9079281171186895`*^9, 3.907928152406108*^9}, {3.907928782602792*^9, 
   3.907928799929227*^9}, {3.9079288349407573`*^9, 3.90792887646544*^9}, {
   3.907928907816481*^9, 3.907928917031573*^9}, 3.907930441071518*^9, {
   3.9079311403653264`*^9, 3.907931140644661*^9}, {3.9079935287032013`*^9, 
   3.9079935612639923`*^9}, {3.907994468431422*^9, 3.9079944689966135`*^9}, 
   3.916904262154189*^9},ExpressionUUID->"77e63bb4-fa93-4467-9ded-\
d39338557d7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["For La-Tr subsystem", "Subsubsection",
 CellChangeTimes->{{3.9077466781102395`*^9, 3.9077466808140144`*^9}, {
   3.907756473399252*^9, 3.9077564744332914`*^9}, {3.907917698413771*^9, 
   3.907917701116048*^9}, 3.9079212184299383`*^9, {3.907921524820731*^9, 
   3.907921531979704*^9}, {3.9079276369001913`*^9, 
   3.90792764486532*^9}},ExpressionUUID->"57c78dec-8064-4231-870e-\
ea7c89627251"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "n", ",", "k", ",", "c", ",", "r", ",", "b", ",", "c0", ",", "w0", ",", 
     "d", ",", "\[Delta]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Figures\\\\CF\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$save", "=", 
   RowBox[{"Setting", "@", 
    CheckboxBox[False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]", "=", 
    RowBox[{"1", "/", "50"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ind", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "2", ",", "\[Delta]"}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ind", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{"15", "/", "10"}], ",", "\[Delta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"par", "=", 
   RowBox[{"$ParameterSets", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sys", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<Lazy\>\"", ",", "\"\<Trusty\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "la", ",", "tr", ",", "fp", ",", "jacobi", ",", "eval", ",", 
          RowBox[{"n", "=", 
           RowBox[{"par", "@", "n"}]}], ",", 
          RowBox[{"k", "=", 
           RowBox[{"par", "@", "k"}]}], ",", "b"}], "}"}], ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"NOTE", ":", " ", 
           RowBox[{
            RowBox[{
            "Substitute", " ", "the", " ", "value", " ", "of", " ", "n", " ", 
             "and", " ", "k", " ", "into", " ", "the", " ", "equations", " ", 
             "so", " ", "that", " ", "If"}], "-", 
            RowBox[{"s", " ", "and", " ", "Sum"}], "-", 
            RowBox[{
            "s", " ", "can", " ", "be", " ", "evaluated", " ", "in", " ", 
             "fLa"}]}]}], ",", " ", "fTr", ",", " ", 
          RowBox[{"fSm", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"c", "/", "i"}], ")"}], "/.", "par"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"b", "=", "i"}], ";", "\[IndentingNewLine]", 
         RowBox[{"fp", "=", 
          RowBox[{"N", "@", 
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"fLa", "[", 
                  RowBox[{"la", ",", "tr"}], "]"}], "\[Equal]", "0"}], ",", 
                RowBox[{
                 RowBox[{"fTr", "[", 
                  RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
                RowBox[{
                 RowBox[{"fSm", "[", 
                  RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
                RowBox[{"0", "<=", "la", "<=", "1"}], ",", 
                RowBox[{"0", "<=", "tr", "<=", "1"}], ",", 
                RowBox[{
                 RowBox[{"la", "+", "tr"}], "==", "1"}]}], "}"}], "/.", 
              "par"}], ",", 
             RowBox[{"{", 
              RowBox[{"la", ",", "tr"}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"fp", "==", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"jacobi", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"fLa", "[", 
                    RowBox[{"la", ",", "tr"}], "]"}], ",", 
                   RowBox[{"fTr", "[", 
                    RowBox[{"la", ",", "tr"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"la", ",", "tr"}], "}"}], "}"}]}], "]"}], "/.", 
               "fp"}], "/.", "par"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"eval", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{"MaximalBy", "[", 
                 RowBox[{
                  RowBox[{"Eigenvalues", "@", "#"}], ",", 
                  RowBox[{"Re", "@*", "N"}]}], "]"}]}], "&"}], "/@", 
              "jacobi"}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{"NOTE", ":", " ", 
              RowBox[{"Get", " ", "dominant", " ", "eigenvalues"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"eval", "=", 
             RowBox[{"Thread", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Re", "@", "eval"}], "<", "0"}], ")"}]}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"NOTE", ":", " ", 
               RowBox[{"True", " ", "if", " ", "stable"}]}], ",", " ", 
              RowBox[{"False", " ", "if", " ", "unstable"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"fp", "=", 
             RowBox[{"N", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"la", ",", "tr"}], "}"}], "/.", "fp"}], ")"}]}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Echo", "@", 
             RowBox[{"{", 
              RowBox[{"fp", "->", "eval"}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Thread", "[", 
             RowBox[{"b", "->", 
              RowBox[{"eval", "->", "fp"}]}], "]"}]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "ind"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stable", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ind", ",", "#"}], "}"}], "\[Transpose]"}], "&"}], "/@", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"True", "/.", "data"}], "/.", 
        RowBox[{"True", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unstable", "=", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ind", ",", "#"}], "}"}], "\[Transpose]"}], "&"}], "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"False", "/.", "data"}], "/.", 
         RowBox[{"False", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"labels", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"StringRiffle", "/@", 
        RowBox[{"Thread", "@", 
         RowBox[{"{", 
          RowBox[{"sys", ",", "#"}], "}"}]}]}], ")"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<Stable\>\"", ",", "\"\<Unstable\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styles", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Directive", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lookup", "[", 
        RowBox[{"colors", ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Table", "[", 
           RowBox[{"sys", ",", "2"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", "Dashed", ",", "Dashed"}], "}"}]}], "}"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strategy", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{"sys", ",", "2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ticks", "=", 
   RowBox[{
    RowBox[{"Charting`ScaledFrameTicks", "[", 
     RowBox[{"{", 
      RowBox[{"Identity", ",", "Identity"}], "}"}], "]"}], "[", 
    RowBox[{"0", ",", 
     RowBox[{"Max", "@", "ind"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ticks", "=", 
    RowBox[{
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "1"}], "]"}], "]"}], "==", ".01"}], ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"c", "/", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "/.", "par"}], ",", "1"}], 
             "]"}], ",", "\"\<\>\""}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", "ticks"}], 
      "]"}], "/.", 
     RowBox[{"ComplexInfinity", "->", "\[Infinity]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot", "=", 
   RowBox[{"Framed", "[", 
    RowBox[{
     RowBox[{"plotA", "=", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"stable", ",", "unstable"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Max", "@", "ind"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotRangePadding", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Scaled", "[", ".03", "]"}], ",", 
           RowBox[{"Scaled", "[", ".05", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "->", "styles"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotLegends", "->", 
         RowBox[{"LineLegend", "[", "labels", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"AbsoluteThickness", "@", "1"}], ",", "Black"}], "]"}]}], 
        ",", 
        RowBox[{"Axes", "->", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"FrameTicks", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ind", ",", 
                RowBox[{
                 RowBox[{"r", "/", "ind"}], "/.", "par"}]}], "}"}], 
              "\[Transpose]"}], "*)"}], 
            RowBox[{"ticks", ",", "All"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<concentration\>\"", ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*StyleBox[\"c\",FontSlant->\"Italic\"]\)/\!\(\*StyleBox[\
\"b\",FontSlant->\"Italic\"]\)\>\"", ",", 
             "\"\<\!\(\*StyleBox[\"b\",FontSlant->\"Italic\"]\)\>\""}], 
            "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "->", "par"}], ",", 
        RowBox[{"ImageSize", "->", "500"}], ",", 
        RowBox[{"Background", "->", "White"}], ",", 
        RowBox[{"LabelStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{"12", ",", "Black"}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], ",", 
     RowBox[{"FrameStyle", "->", "None"}], ",", 
     RowBox[{"Background", "->", "White"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"$save", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "@", 
      RowBox[{"{", 
       RowBox[{"dir", ",", 
        RowBox[{"\"\<bifurcation \>\"", "<>", 
         RowBox[{"sys", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
         RowBox[{"sys", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<.jpg\>\""}]}], "}"}]}], 
     ",", "plot", ",", "\"\<JPEG\>\""}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9077466822494316`*^9, 3.9077466979414167`*^9}, {
   3.90774694208677*^9, 3.907746943839204*^9}, {3.907746978911298*^9, 
   3.9077471972546034`*^9}, {3.907747257867913*^9, 3.907747258721653*^9}, {
   3.9077473785497837`*^9, 3.907747674813361*^9}, {3.907748162680126*^9, 
   3.907748206288329*^9}, {3.90774828133191*^9, 3.907748306242691*^9}, {
   3.9077484018991084`*^9, 3.9077484779646797`*^9}, {3.9077505025497885`*^9, 
   3.907750514386492*^9}, {3.90775060464911*^9, 3.907750605633693*^9}, {
   3.9077528263256264`*^9, 3.9077530743472433`*^9}, {3.9077532274422684`*^9, 
   3.9077532525848293`*^9}, 3.907917297149411*^9, {3.907917329294058*^9, 
   3.9079174181767316`*^9}, {3.9079174639705105`*^9, 
   3.9079175094195156`*^9}, {3.90791753991253*^9, 3.907917590546033*^9}, {
   3.9079176247029705`*^9, 3.9079176804480257`*^9}, {3.90791775681452*^9, 
   3.907917913233436*^9}, {3.9079179442303953`*^9, 3.9079179671953115`*^9}, {
   3.9079179979208508`*^9, 3.9079180982330155`*^9}, {3.907918134950289*^9, 
   3.9079182565329304`*^9}, {3.9079183154455013`*^9, 3.9079183481909137`*^9}, 
   3.907918447208006*^9, {3.907918480751561*^9, 3.907918489172571*^9}, {
   3.907918534372989*^9, 3.9079187470247736`*^9}, {3.9079188106685824`*^9, 
   3.9079188107703867`*^9}, {3.9079189340849447`*^9, 
   3.9079192323425684`*^9}, {3.9079192747437*^9, 3.9079196171793947`*^9}, {
   3.9079197081701317`*^9, 3.9079198052304525`*^9}, {3.907919865066822*^9, 
   3.9079200201600018`*^9}, {3.9079200570663056`*^9, 3.907920259772049*^9}, {
   3.9079203366966414`*^9, 3.907920612795322*^9}, {3.907920647983199*^9, 
   3.907920651953874*^9}, 3.9079207104035406`*^9, {3.907920741459654*^9, 
   3.907920892441651*^9}, {3.9079209266178083`*^9, 3.9079209647992363`*^9}, {
   3.9079209954416003`*^9, 3.907921089151314*^9}, 3.907921136130268*^9, {
   3.9079211755222635`*^9, 3.907921189790142*^9}, {3.9079212489016542`*^9, 
   3.9079213016726413`*^9}, {3.9079213424072657`*^9, 
   3.9079213649751987`*^9}, {3.907925072258428*^9, 3.90792507489583*^9}, {
   3.90792529903586*^9, 3.9079253065786552`*^9}, 3.907925696567093*^9, {
   3.907926013173165*^9, 3.9079261030910344`*^9}, {3.907926323911807*^9, 
   3.9079263275474043`*^9}, {3.9079265127999926`*^9, 3.9079265498442807`*^9}, 
   3.907926827117155*^9, {3.907926913906933*^9, 3.9079269349461946`*^9}, 
   3.907926982435498*^9, {3.907927271441907*^9, 3.9079272764946775`*^9}, {
   3.9079273525075674`*^9, 3.9079273559961405`*^9}, {3.9079276278791075`*^9, 
   3.907927686470868*^9}, {3.9079277254074993`*^9, 3.9079278692440805`*^9}, {
   3.907927915296*^9, 3.907928195727481*^9}, {3.9079282405749063`*^9, 
   3.907928282933584*^9}, {3.907928333061718*^9, 3.9079285912149*^9}, {
   3.9079286338514*^9, 3.907928660315242*^9}, {3.907928935823058*^9, 
   3.907929136398655*^9}, {3.9079297283541803`*^9, 3.907929880275941*^9}, {
   3.9079302443620634`*^9, 3.907930424603238*^9}, {3.907930465861993*^9, 
   3.907930466398715*^9}, {3.9079305036920614`*^9, 3.9079306671567173`*^9}, {
   3.907930711788005*^9, 3.907930789227274*^9}, {3.907930864930837*^9, 
   3.907930925952577*^9}, {3.9079309919914465`*^9, 3.9079310041049037`*^9}, {
   3.907931143015106*^9, 3.907931143183629*^9}, 3.9079312199063673`*^9, {
   3.907931288351756*^9, 3.907931341693347*^9}, {3.9079417531096516`*^9, 
   3.9079417838963118`*^9}, {3.9079418277081513`*^9, 3.907941830783621*^9}, {
   3.9079889426066074`*^9, 3.907989002326071*^9}, {3.9079944834445667`*^9, 
   3.907994483595185*^9}, {3.908350759693765*^9, 3.908350839268204*^9}, {
   3.9083509837548423`*^9, 3.9083509918259993`*^9}, {3.9083511436306386`*^9, 
   3.9083511436952696`*^9}},
 CellLabel->
  "In[783]:=",ExpressionUUID->"7c7ac75e-bec1-45d4-ab6a-d2cd5808e7f4"]
}, Closed]],

Cell[CellGroupData[{

Cell["For La-Sm subsystem", "Subsubsection",
 CellChangeTimes->{{3.9077466781102395`*^9, 3.9077466808140144`*^9}, {
   3.907756473399252*^9, 3.9077564744332914`*^9}, {3.907917698413771*^9, 
   3.907917701116048*^9}, 3.9079212184299383`*^9, {3.907921524820731*^9, 
   3.907921531979704*^9}, {3.907925101548223*^9, 3.907925105177782*^9}, 
   3.9079256939646945`*^9, {3.9079258084575357`*^9, 3.9079258087050257`*^9}, {
   3.907931603656039*^9, 
   3.907931603987281*^9}},ExpressionUUID->"5c261de3-2db8-4fd2-90fb-\
b44de9ca0bef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "n", ",", "k", ",", "c", ",", "r", ",", "b", ",", "c0", ",", "w0", ",", 
     "d", ",", "\[Delta]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Figures\\\\CF\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$save", "=", 
   RowBox[{"Setting", "@", 
    CheckboxBox[False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]", "=", 
   RowBox[{"1", "/", "100"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ind", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "2", ",", "\[Delta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sys", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Lazy\>\"", ",", "\"\<Smart\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"par", "=", 
    RowBox[{"KeyDrop", "[", 
     RowBox[{
      RowBox[{"$ParameterSets", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Name\>\"", ",", "b"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "la", ",", "tr", ",", "fp", ",", "jacobi", ",", "eval", ",", 
          RowBox[{"n", "=", 
           RowBox[{"par", "@", "n"}]}], ",", 
          RowBox[{"k", "=", 
           RowBox[{"par", "@", "k"}]}], ",", "b"}], "}"}], ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"NOTE", ":", " ", 
           RowBox[{
            RowBox[{
            "Substitute", " ", "the", " ", "value", " ", "of", " ", "n", " ", 
             "and", " ", "k", " ", "into", " ", "the", " ", "equations", " ", 
             "so", " ", "that", " ", "If"}], "-", 
            RowBox[{"s", " ", "and", " ", "Sum"}], "-", 
            RowBox[{
            "s", " ", "can", " ", "be", " ", "evaluated", " ", "in", " ", 
             "fLa"}]}]}], ",", " ", "fTr", ",", " ", 
          RowBox[{"fSm", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"b", "=", "i"}], ";", "\[IndentingNewLine]", 
         RowBox[{"fp", "=", 
          RowBox[{"N", "@", 
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"fLa", "[", 
                  RowBox[{"la", ",", "tr"}], "]"}], "\[Equal]", "0"}], ",", 
                RowBox[{
                 RowBox[{"fTr", "[", 
                  RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
                RowBox[{
                 RowBox[{"fSm", "[", 
                  RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
                RowBox[{"0", "<", "la", "<", "1"}], ",", 
                RowBox[{"tr", "==", "0"}]}], "}"}], "/.", "par"}], ",", 
             RowBox[{"{", 
              RowBox[{"la", ",", "tr"}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"fp", "==", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"jacobi", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"fLa", "[", 
                    RowBox[{"la", ",", "tr"}], "]"}], ",", 
                   RowBox[{"fTr", "[", 
                    RowBox[{"la", ",", "tr"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"la", ",", "tr"}], "}"}], "}"}]}], "]"}], "/.", 
               "fp"}], "/.", "par"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"eval", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{"MaximalBy", "[", 
                 RowBox[{
                  RowBox[{"Eigenvalues", "@", "#"}], ",", 
                  RowBox[{"Re", "@*", "N"}]}], "]"}]}], "&"}], "/@", 
              "jacobi"}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{"NOTE", ":", " ", 
              RowBox[{"Get", " ", "dominant", " ", "eigenvalues"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"eval", "=", 
             RowBox[{"Thread", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Re", "@", "eval"}], "<", "0"}], ")"}]}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"NOTE", ":", " ", 
               RowBox[{"True", " ", "if", " ", "stable"}]}], ",", " ", 
              RowBox[{"False", " ", "if", " ", "unstable"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"fp", "=", 
             RowBox[{"N", "@", 
              RowBox[{"Chop", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"la", ",", 
                   RowBox[{"1", "-", "la", "-", "tr"}]}], "}"}], "/.", "fp"}],
                 ")"}]}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Thread", "[", 
             RowBox[{"eval", "->", "fp"}], "]"}]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "ind"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stable", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ind", ",", "#"}], "}"}], "\[Transpose]"}], "&"}], "/@", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"True", "/.", "data"}], "/.", 
        RowBox[{"True", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unstable", "=", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ind", ",", "#"}], "}"}], "\[Transpose]"}], "&"}], "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"False", "/.", "data"}], "/.", 
         RowBox[{"False", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"labels", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"StringRiffle", "/@", 
        RowBox[{"Thread", "@", 
         RowBox[{"{", 
          RowBox[{"sys", ",", "#"}], "}"}]}]}], ")"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<Stable\>\"", ",", "\"\<Unstable\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styles", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Directive", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lookup", "[", 
        RowBox[{"colors", ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Table", "[", 
           RowBox[{"sys", ",", "2"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", "Dashed", ",", "Dashed"}], "}"}]}], "}"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strategy", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{"sys", ",", "2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ticks", "=", 
   RowBox[{
    RowBox[{"Charting`ScaledFrameTicks", "[", 
     RowBox[{"{", 
      RowBox[{"Identity", ",", "Identity"}], "}"}], "]"}], "[", 
    RowBox[{"0", ",", 
     RowBox[{"Max", "@", "ind"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ticks", "=", 
    RowBox[{
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "1"}], "]"}], "]"}], "==", ".01"}], ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"r", "/", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "/.", "par"}], ",", "1"}], 
             "]"}], ",", "\"\<\>\""}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", "ticks"}], 
      "]"}], "/.", 
     RowBox[{"ComplexInfinity", "->", "\[Infinity]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot", "=", 
   RowBox[{"Framed", "[", 
    RowBox[{
     RowBox[{"plotB", "=", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"stable", ",", "unstable"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Max", "@", "ind"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotRangePadding", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Scaled", "[", ".02", "]"}], ",", 
           RowBox[{"Scaled", "[", ".03", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "->", "styles"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotHighlighting", "->", "None"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLegends", "->", 
         RowBox[{"LineLegend", "[", "labels", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"AbsoluteThickness", "@", "1"}], ",", "Black"}], "]"}]}], 
        ",", 
        RowBox[{"Axes", "->", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"FrameTicks", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ticks", ",", "All"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<concentration\>\"", ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*StyleBox[\"r\",FontSlant->\"Italic\"]\)/\!\(\*StyleBox[\
\"b\",FontSlant->\"Italic\"]\)\>\"", ",", 
             "\"\<\!\(\*StyleBox[\"b\",FontSlant->\"Italic\"]\)\>\""}], 
            "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "->", "par"}], ",", 
        RowBox[{"ImageSize", "->", "500"}], ",", 
        RowBox[{"Background", "->", "White"}], ",", 
        RowBox[{"LabelStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{"12", ",", "Black"}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], ",", 
     RowBox[{"FrameStyle", "->", "None"}], ",", 
     RowBox[{"Background", "->", "White"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"$save", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "@", 
      RowBox[{"{", 
       RowBox[{"dir", ",", 
        RowBox[{"\"\<bifurcation \>\"", "<>", 
         RowBox[{"sys", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
         RowBox[{"sys", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<.jpg\>\""}]}], "}"}]}], 
     ",", "plot", ",", "\"\<JPEG\>\""}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9077466822494316`*^9, 3.9077466979414167`*^9}, {
   3.90774694208677*^9, 3.907746943839204*^9}, {3.907746978911298*^9, 
   3.9077471972546034`*^9}, {3.907747257867913*^9, 3.907747258721653*^9}, {
   3.9077473785497837`*^9, 3.907747674813361*^9}, {3.907748162680126*^9, 
   3.907748206288329*^9}, {3.90774828133191*^9, 3.907748306242691*^9}, {
   3.9077484018991084`*^9, 3.9077484779646797`*^9}, {3.9077505025497885`*^9, 
   3.907750514386492*^9}, {3.90775060464911*^9, 3.907750605633693*^9}, {
   3.9077528263256264`*^9, 3.9077530743472433`*^9}, {3.9077532274422684`*^9, 
   3.9077532525848293`*^9}, 3.907917297149411*^9, {3.907917329294058*^9, 
   3.9079174181767316`*^9}, {3.9079174639705105`*^9, 
   3.9079175094195156`*^9}, {3.90791753991253*^9, 3.907917590546033*^9}, {
   3.9079176247029705`*^9, 3.9079176804480257`*^9}, {3.90791775681452*^9, 
   3.907917913233436*^9}, {3.9079179442303953`*^9, 3.9079179671953115`*^9}, {
   3.9079179979208508`*^9, 3.9079180982330155`*^9}, {3.907918134950289*^9, 
   3.9079182565329304`*^9}, {3.9079183154455013`*^9, 3.9079183481909137`*^9}, 
   3.907918447208006*^9, {3.907918480751561*^9, 3.907918489172571*^9}, {
   3.907918534372989*^9, 3.9079187470247736`*^9}, {3.9079188106685824`*^9, 
   3.9079188107703867`*^9}, {3.9079189340849447`*^9, 
   3.9079192323425684`*^9}, {3.9079192747437*^9, 3.9079196171793947`*^9}, {
   3.9079197081701317`*^9, 3.9079198052304525`*^9}, {3.907919865066822*^9, 
   3.9079200201600018`*^9}, {3.9079200570663056`*^9, 3.907920259772049*^9}, {
   3.9079203366966414`*^9, 3.907920612795322*^9}, {3.907920647983199*^9, 
   3.907920651953874*^9}, 3.9079207104035406`*^9, {3.907920741459654*^9, 
   3.907920892441651*^9}, {3.9079209266178083`*^9, 3.9079209647992363`*^9}, {
   3.9079209954416003`*^9, 3.907921089151314*^9}, 3.907921136130268*^9, {
   3.9079211755222635`*^9, 3.907921189790142*^9}, {3.9079212489016542`*^9, 
   3.9079213016726413`*^9}, {3.9079213424072657`*^9, 
   3.9079213649751987`*^9}, {3.907925072258428*^9, 3.90792507489583*^9}, {
   3.907925113706903*^9, 3.907925123238179*^9}, {3.907925156555278*^9, 
   3.907925237329565*^9}, {3.907925288951543*^9, 3.9079253176386185`*^9}, {
   3.9079253586591177`*^9, 3.9079253657493896`*^9}, {3.907925512463066*^9, 
   3.9079257555042696`*^9}, {3.9079257887071424`*^9, 3.9079258120457134`*^9}, 
   3.9079258521871896`*^9, {3.907925899174124*^9, 3.907925912722774*^9}, {
   3.907925975167743*^9, 3.907925987667094*^9}, {3.907926128106087*^9, 
   3.907926195300807*^9}, {3.907926270655655*^9, 3.907926285846356*^9}, 
   3.9079263164672213`*^9, {3.907926555889161*^9, 3.9079265559491453`*^9}, {
   3.907926741748949*^9, 3.9079267694384146`*^9}, {3.907926802632391*^9, 
   3.9079268150299096`*^9}, 3.907926855579427*^9, 3.9079269121485634`*^9, {
   3.9079269720572915`*^9, 3.9079269958182554`*^9}, {3.9079272591946297`*^9, 
   3.9079272869699984`*^9}, {3.907929939753578*^9, 3.907929962864561*^9}, 
   3.9079299973768053`*^9, {3.9079300287813044`*^9, 3.9079300288240824`*^9}, {
   3.907931017724784*^9, 3.907931080960293*^9}, {3.9079311188376255`*^9, 
   3.9079312106302967`*^9}, {3.9079313573235884`*^9, 
   3.9079313755269203`*^9}, {3.907931410780921*^9, 3.907931461986023*^9}, 
   3.907931493553162*^9, {3.9079408986857615`*^9, 3.9079409303542547`*^9}, {
   3.9079409678994894`*^9, 3.9079409760358424`*^9}, {3.9079410351208277`*^9, 
   3.9079410841279535`*^9}, {3.9079411226948385`*^9, 3.907941184908876*^9}, {
   3.9079415327583895`*^9, 3.907941568043877*^9}, {3.9079856105910273`*^9, 
   3.907985656191991*^9}, {3.9079861547389107`*^9, 3.9079861550356083`*^9}, {
   3.9079863511942883`*^9, 3.907986362008618*^9}, {3.9079864072303534`*^9, 
   3.907986498998192*^9}, {3.907986531695776*^9, 3.9079865983871202`*^9}, {
   3.907987463814413*^9, 3.9079874963873997`*^9}, {3.9079875577838955`*^9, 
   3.9079876377235107`*^9}, {3.9079876737946634`*^9, 3.907987722338706*^9}, {
   3.907987832075076*^9, 3.907987855519945*^9}, {3.9079886081075897`*^9, 
   3.9079886108633432`*^9}, {3.9079886810528936`*^9, 3.907988868707639*^9}, {
   3.9079889112741957`*^9, 3.9079889116955357`*^9}, {3.9079890706882544`*^9, 
   3.9079890903143997`*^9}, {3.907989275846553*^9, 3.9079892954200215`*^9}, {
   3.907990889100689*^9, 3.9079908910680647`*^9}},
 CellLabel->
  "In[1144]:=",ExpressionUUID->"c96d02e7-dfbc-4629-a775-caf941aa33dc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Combined Trusty & Smart (simplified)", "Subsubsection",
 CellChangeTimes->{{3.9080026344197364`*^9, 3.9080026354045925`*^9}, {
  3.908002983229082*^9, 3.908002984840479*^9}, {3.9083612033101873`*^9, 
  3.9083612058536897`*^9}},ExpressionUUID->"fee68fe1-54d6-4fd1-8f74-\
071920b858db"],

Cell["\<\
Calculating fixed points separately for the Lazy-Trusty pair and for the \
Lazy-Smart pair.\
\>", "Item",
 CellChangeTimes->{{3.9079931259107227`*^9, 3.9079931572375546`*^9}, {
  3.908359743241884*^9, 
  3.9083597631847763`*^9}},ExpressionUUID->"3baec400-7f59-4668-a457-\
e97ee0faa401"],

Cell[CellGroupData[{

Cell[TextData[{
 "Ignoring the boundary unstable fixed point ",
 Cell[BoxData[
  FormBox[
   RowBox[{"tr", "==", "1"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d859770e-fa5e-46c6-8945-722f596afdcc"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{"sm", "==", "1"}], TraditionalForm]],ExpressionUUID->
  "6923e112-2bff-4043-bf22-144e841285f8"],
 " when there is 1 or 3 solutions."
}], "Item",
 CellChangeTimes->{{3.9079931259107227`*^9, 3.907993141436166*^9}, {
  3.907993180541954*^9, 3.9079932085964108`*^9}, {3.908359770417778*^9, 
  3.908359777266614*^9}},ExpressionUUID->"6dcd1545-a8fc-4a2e-a197-\
75565208b2f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "n", ",", "k", ",", "c", ",", "r", ",", "b", ",", "c0", ",", "w0", ",", 
     "d", ",", "\[Delta]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Figures\\\\CF\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$save", "=", 
   RowBox[{"Setting", "@", 
    CheckboxBox[False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]", "=", 
   RowBox[{"1", "/", "1000"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ind", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"3", "/", "10"}], ",", "1", ",", "\[Delta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sys", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Trusty\>\"", ",", "\"\<Smart\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"par", "=", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"n", "\[Rule]", "9"}], ",", 
      RowBox[{"k", "\[Rule]", "3"}], ",", 
      RowBox[{"c", "\[Rule]", 
       RowBox[{"7", "/", "10"}]}], ",", 
      RowBox[{"r", "\[Rule]", 
       RowBox[{"1", "/", "6"}]}], ",", 
      RowBox[{"c0", "\[Rule]", "3"}], ",", 
      RowBox[{"w0", "\[Rule]", "0"}]}], "\[RightAssociation]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTE", ":", " ", 
    RowBox[{
    "Collect", " ", "fixed", " ", "points", " ", "only", " ", "for", " ", 
     RowBox[{"Trusty", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataTr", "=", 
    RowBox[{"Transpose", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"la", ",", "tr", ",", "fp", ",", 
           RowBox[{"n", "=", 
            RowBox[{"par", "@", "n"}]}], ",", 
           RowBox[{"k", "=", 
            RowBox[{"par", "@", "k"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"NOTE", ":", " ", 
            RowBox[{
            "Allow", " ", "Trusty", " ", "to", " ", "be", " ", "1"}]}], ",", 
           " ", 
           RowBox[{
           "by", " ", "allowing", " ", "Lazy", " ", "to", " ", "be", " ", 
            "0."}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fp", "=", 
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"fLa", "[", 
                  RowBox[{"la", ",", "tr"}], "]"}], "\[Equal]", "0"}], ",", 
                RowBox[{
                 RowBox[{"fTr", "[", 
                  RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
                RowBox[{"0", "<=", "la", "<", "1"}], ",", 
                RowBox[{"0", "<", "tr", "<=", "1"}], ",", 
                RowBox[{
                 RowBox[{"la", "+", "tr"}], "==", "1"}]}], "}"}], "/.", 
              "par"}], ",", 
             RowBox[{"{", 
              RowBox[{"la", ",", "tr"}], "}"}], ",", "Reals"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"fp", "=", 
           RowBox[{"Sort", "@", 
            RowBox[{"N", "@", 
             RowBox[{"(", 
              RowBox[{"tr", "/.", "fp"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"NOTE", ":", " ", 
             RowBox[{
             "When", " ", "there", " ", "are", " ", "1", " ", "or", " ", "3", 
              " ", "solutions"}]}], ",", " ", 
            RowBox[{
            "ignore", " ", "the", " ", "boundary", " ", "unstable", " ", 
             "fixed", " ", 
             RowBox[{"point", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"NOTE", ":", " ", 
            RowBox[{"Sort", " ", "results", " ", "in"}], ":", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"unstable", ",", " ", "stable"}], "}"}], " ", 
             RowBox[{"pairs", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Sort", "@", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{"Length", "@", "fp"}], ",", 
             RowBox[{"0", "|", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Missing", "[", "]"}], ",", 
               RowBox[{"Missing", "[", "]"}]}], "}"}], ",", "2", ",", "fp", 
             ",", "3", ",", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"fp", ",", 
               RowBox[{"1", "|", "1."}]}], "]"}], ",", "_", ",", 
             RowBox[{
              RowBox[{"Print", "@", "\"\<ERROR! More than 3 solutions.\>\""}],
               ";", "fp"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"b", ",", "ind"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTE", ":", " ", 
    RowBox[{
    "Collect", " ", "fixed", " ", "points", " ", "only", " ", "for", " ", 
     RowBox[{"Smart", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataSm", "=", 
    RowBox[{"Transpose", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"la", ",", "tr", ",", "fp", ",", 
           RowBox[{"n", "=", 
            RowBox[{"par", "@", "n"}]}], ",", 
           RowBox[{"k", "=", 
            RowBox[{"par", "@", "k"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"NOTE", ":", " ", 
            RowBox[{"Allow", " ", "Smart", " ", "to", " ", "be", " ", "1"}]}],
            ",", " ", 
           RowBox[{
           "by", " ", "allowing", " ", "Lazy", " ", "to", " ", "be", " ", 
            "0."}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fp", "=", 
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"fLa", "[", 
                  RowBox[{"la", ",", "tr"}], "]"}], "\[Equal]", "0"}], ",", 
                RowBox[{
                 RowBox[{"fTr", "[", 
                  RowBox[{"la", ",", "tr"}], "]"}], "==", "0"}], ",", 
                RowBox[{"0", "<=", "la", "<", "1"}], ",", 
                RowBox[{"tr", "==", "0"}]}], "}"}], "/.", "par"}], ",", 
             RowBox[{"{", 
              RowBox[{"la", ",", "tr"}], "}"}], ",", "Reals"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"fp", "=", 
           RowBox[{"Sort", "@", 
            RowBox[{"N", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "-", "la"}], "/.", "fp"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"NOTE", ":", " ", 
             RowBox[{
             "When", " ", "there", " ", "are", " ", "1", " ", "or", " ", "3", 
              " ", "solutions"}]}], ",", " ", 
            RowBox[{
            "ignore", " ", "the", " ", "boundary", " ", "unstable", " ", 
             "fixed", " ", 
             RowBox[{"point", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"NOTE", ":", " ", 
            RowBox[{"Sort", " ", "results", " ", "in"}], ":", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"unstable", ",", " ", "stable"}], "}"}], " ", 
             RowBox[{"pairs", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Sort", "@", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{"Length", "@", "fp"}], ",", 
             RowBox[{"0", "|", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Missing", "[", "]"}], ",", 
               RowBox[{"Missing", "[", "]"}]}], "}"}], ",", "2", ",", "fp", 
             ",", "3", ",", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"fp", ",", 
               RowBox[{"1", "|", "1."}]}], "]"}], ",", "_", ",", 
             RowBox[{
              RowBox[{"Print", "@", "\"\<ERROR! More than 3 solutions.\>\""}],
               ";", "fp"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"b", ",", "ind"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataLa", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"Missing", "[", "]"}]}], "}"}], "&"}], "/@", "ind"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", "0"}], "}"}], "&"}], "/@", "ind"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ticks", "=", 
   RowBox[{
    RowBox[{"Charting`ScaledFrameTicks", "[", 
     RowBox[{"{", 
      RowBox[{"Identity", ",", "Identity"}], "}"}], "]"}], "[", 
    RowBox[{"0", ",", 
     RowBox[{"Max", "@", "ind"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ticks", "=", 
    RowBox[{
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "1"}], "]"}], "]"}], "==", ".01"}], ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "/.", "par"}], ",", "2"}], 
             "]"}], ",", "\"\<\>\""}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", "ticks"}], 
      "]"}], "/.", 
     RowBox[{"ComplexInfinity", "->", "\[Infinity]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"name", "=", "\"\<bifurcation\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.9080026429306602`*^9, 3.908002649400669*^9}, {
   3.908002691829003*^9, 3.9080029749604983`*^9}, {3.9080030433429537`*^9, 
   3.908003056747079*^9}, 3.908027655171997*^9, 3.9082495502691383`*^9, {
   3.908249589983444*^9, 3.908249590453232*^9}, {3.9082496239993243`*^9, 
   3.9082496355225782`*^9}, {3.9082496722904263`*^9, 
   3.9082496939997635`*^9}, {3.9082497421000566`*^9, 
   3.9082497441574607`*^9}, {3.9082497818849325`*^9, 3.908249835352742*^9}, {
   3.9082500132825594`*^9, 3.908250057999426*^9}, {3.9082501230596595`*^9, 
   3.9082501264212413`*^9}, {3.9082501934006615`*^9, 
   3.9082502304729567`*^9}, {3.9082503848718987`*^9, 
   3.9082503849414587`*^9}, {3.90825044142766*^9, 3.908250444084324*^9}, {
   3.9082504842721868`*^9, 3.9082504843847275`*^9}, {3.9082505334062862`*^9, 
   3.908250548559909*^9}, {3.9082505815128107`*^9, 3.9082505956221085`*^9}, {
   3.908250728974507*^9, 3.9082509480326033`*^9}, {3.9082511234691005`*^9, 
   3.908251284208087*^9}, {3.9082518363131113`*^9, 3.9082521482172356`*^9}, 
   3.9082523919846797`*^9, {3.9082526107011385`*^9, 3.9082526239717174`*^9}, {
   3.9082528077464075`*^9, 3.9082528177989254`*^9}, {3.9082609102943163`*^9, 
   3.9082609103638153`*^9}, {3.908264739929387*^9, 3.90826474005587*^9}, 
   3.908359341108856*^9, {3.908359394848835*^9, 3.9083594529063063`*^9}, {
   3.9083594922013836`*^9, 3.908359516680355*^9}, {3.908359583998266*^9, 
   3.9083596119793916`*^9}, {3.9083597839091635`*^9, 
   3.9083597839628935`*^9}, {3.9083600382983813`*^9, 3.908360038594039*^9}, {
   3.908361191137483*^9, 
   3.9083611952898884`*^9}},ExpressionUUID->"c4ce7d8e-8fea-404c-b426-\
304659b57700"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plot", "=", 
   RowBox[{"Framed", "[", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"N", "@", 
        RowBox[{"Join", "[", 
         RowBox[{"dataTr", ",", "dataSm", ",", "dataLa"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"DataRange", "->", 
        RowBox[{"MinMax", "@", "ind"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"MinMax", "@", "ind"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Scaled", "[", ".02", "]"}], ",", 
          RowBox[{"Scaled", "[", ".03", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotHighlighting", "->", "\"\<Dropline\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"colors", "@", "\"\<Trusty\>\""}], ",", 
            RowBox[{"lines", "@", "\"\<Unstable\>\""}], ",", 
            RowBox[{"AbsoluteThickness", "@", "5"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"colors", "@", "\"\<Trusty\>\""}], ",", 
            RowBox[{"lines", "@", "\"\<Stable\>\""}], ",", 
            RowBox[{"AbsoluteThickness", "@", "5"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"colors", "@", "\"\<Smart\>\""}], ",", 
            RowBox[{"lines", "@", "\"\<Unstable\>\""}], ",", 
            RowBox[{"AbsoluteThickness", "@", "5"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"colors", "@", "\"\<Smart\>\""}], ",", 
            RowBox[{"lines", "@", "\"\<Stable\>\""}], ",", 
            RowBox[{"AbsoluteThickness", "@", "5"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"colors", "@", "\"\<Lazy\>\""}], ",", 
            RowBox[{"lines", "@", "\"\<Unstable\>\""}], ",", 
            RowBox[{"AbsoluteThickness", "@", "5"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"colors", "@", "\"\<Lazy\>\""}], ",", 
            RowBox[{"lines", "@", "\"\<Stable\>\""}], ",", 
            RowBox[{"AbsoluteThickness", "@", "5"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotLegends", "->", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Trusty unstable\>\"", ",", "\"\<Trusty stable\>\"", ",", 
          "\"\<Smart unstable\>\"", ",", "\"\<Smart stable\>\"", ",", 
          "\"\<Lazy unstable\>\"", ",", "\"\<Lazy stable\>\""}], "}"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "@", "2"}], ",", "Black"}], "]"}]}], 
       ",", 
       RowBox[{"Axes", "->", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ticks", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<concentration\>\"", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<1/\!\(\*StyleBox[\"b\",FontSlant->\"Italic\"]\)\>\"", ",", 
            "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ScalingFunctions", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Reverse\>\"", ",", "Identity"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLabel", "->", "par"}], ",", 
       RowBox[{"ImageSize", "->", "1200"}], ",", 
       RowBox[{"Background", "->", "White"}], ",", 
       RowBox[{"LabelStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{"26", ",", "Black"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImagePadding", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"100", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"100", ",", "10"}], "}"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"FrameStyle", "->", "None"}], ",", 
     RowBox[{"Background", "->", "White"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Magnify", "[", 
  RowBox[{"plot", ",", ".4"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"$save", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "@", 
       RowBox[{"{", 
        RowBox[{"dir", ",", 
         RowBox[{"name", "<>", "\"\<_combined.jpg\>\""}]}], "}"}]}], ",", 
      "plot", ",", "\"\<JPEG\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "@", 
       RowBox[{"{", 
        RowBox[{"dir", ",", 
         RowBox[{"name", "<>", "\"\<_combined.pdf\>\""}]}], "}"}]}], ",", 
      "plot", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9080026429306602`*^9, 3.908002649400669*^9}, {
   3.908002691829003*^9, 3.9080029749604983`*^9}, {3.9080030433429537`*^9, 
   3.908003056747079*^9}, 3.908027655171997*^9, 3.9082495502691383`*^9, {
   3.908249589983444*^9, 3.908249590453232*^9}, {3.9082496239993243`*^9, 
   3.9082496355225782`*^9}, {3.9082496722904263`*^9, 
   3.9082496939997635`*^9}, {3.9082497421000566`*^9, 
   3.9082497441574607`*^9}, {3.9082497818849325`*^9, 3.908249835352742*^9}, {
   3.9082500132825594`*^9, 3.908250057999426*^9}, {3.9082501230596595`*^9, 
   3.9082501264212413`*^9}, {3.9082501934006615`*^9, 
   3.9082502304729567`*^9}, {3.9082503848718987`*^9, 
   3.9082503849414587`*^9}, {3.90825044142766*^9, 3.908250444084324*^9}, {
   3.9082504842721868`*^9, 3.9082504843847275`*^9}, {3.9082505334062862`*^9, 
   3.908250548559909*^9}, {3.9082505815128107`*^9, 3.9082505956221085`*^9}, {
   3.908250728974507*^9, 3.9082509480326033`*^9}, {3.9082511234691005`*^9, 
   3.908251284208087*^9}, {3.9082518363131113`*^9, 3.9082521482172356`*^9}, {
   3.9082523919846797`*^9, 3.908252400177286*^9}, {3.908252464112956*^9, 
   3.908252622456952*^9}, 3.9082604702821956`*^9, {3.9082605950974236`*^9, 
   3.9082606279269443`*^9}, {3.908260945399886*^9, 3.9082609474024644`*^9}, {
   3.908261036021987*^9, 3.908261043351254*^9}, 3.9082616048627214`*^9, {
   3.9082620171580276`*^9, 3.9082620600947924`*^9}, {3.9082621090708075`*^9, 
   3.9082621375514336`*^9}, {3.9083595276543245`*^9, 3.908359528145527*^9}, {
   3.9083596152207813`*^9, 3.9083596153485856`*^9}, {3.908360000049123*^9, 
   3.908360001330771*^9}, {3.908360032972044*^9, 3.908360033594659*^9}},
 CellLabel->
  "In[662]:=",ExpressionUUID->"a4042f45-6529-4ae6-b6fd-af55e542d15c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"var", ",", "data", ",", 
       RowBox[{"strat", "=", "#"}], ",", "ticks", ",", "plot"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"var", ",", "data"}], "}"}], "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"strat", ",", "\"\<Trusty\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "dataTr"}], "}"}], ",", "\"\<Smart\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "dataSm"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ticks", "=", 
       RowBox[{
        RowBox[{"Charting`ScaledFrameTicks", "[", 
         RowBox[{"{", 
          RowBox[{"Identity", ",", "Identity"}], "}"}], "]"}], "[", 
        RowBox[{"0", ",", 
         RowBox[{"Max", "@", "ind"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ticks", "=", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "1"}], "]"}], "]"}], "==", ".01"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"var", "/", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "/.", "par"}], ",", 
                 "1"}], "]"}], ",", "\"\<\>\""}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", "ticks"}],
          "]"}], "/.", 
        RowBox[{"ComplexInfinity", "->", "\[Infinity]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{"data", ",", "\[IndentingNewLine]", 
         RowBox[{"DataRange", "->", 
          RowBox[{"MinMax", "@", "ind"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MinMax", "@", "ind"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRangePadding", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Scaled", "[", ".02", "]"}], ",", 
            RowBox[{"Scaled", "[", ".03", "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotHighlighting", "->", "None"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"colors", "@", "strat"}], ",", 
              RowBox[{"lines", "@", "\"\<Unstable\>\""}], ",", 
              RowBox[{"AbsoluteThickness", "@", "5"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"colors", "@", "strat"}], ",", 
              RowBox[{"lines", "@", "\"\<Stable\>\""}], ",", 
              RowBox[{"AbsoluteThickness", "@", "5"}]}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameStyle", "->", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"AbsoluteThickness", "@", "2"}], ",", "Black"}], "]"}]}], 
         ",", 
         RowBox[{"Axes", "->", "False"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ticks", ",", "All"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<concentration\>\"", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"var", ",", "\"\</\>\"", ",", "b"}], "}"}]}], ",", 
              "b"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ScalingFunctions", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<Reverse\>\"", ",", "Identity"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"PlotLabel", "->", "par"}], ","}], "*)"}], 
         RowBox[{"ImageSize", "->", "1200"}], ",", 
         RowBox[{"Background", "->", "White"}], ",", 
         RowBox[{"LabelStyle", "->", 
          RowBox[{"Directive", "[", 
           RowBox[{"26", ",", "\"\<Helvetica\>\"", ",", "Black"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"$save", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "@", 
            RowBox[{"{", 
             RowBox[{"dir", ",", 
              RowBox[{
              "name", "<>", "\"\<_\>\"", "<>", "strat", "<>", 
               "\"\<.jpg\>\""}]}], "}"}]}], ",", "plot", ",", 
           "\"\<JPEG\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "@", 
            RowBox[{"{", 
             RowBox[{"dir", ",", 
              RowBox[{
              "name", "<>", "\"\<_\>\"", "<>", "strat", "<>", 
               "\"\<.pdf\>\""}]}], "}"}]}], ",", "plot", ",", "\"\<PDF\>\""}],
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Magnify", "[", 
       RowBox[{"plot", ",", ".4"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"\"\<Trusty\>\"", ",", "\"\<Smart\>\""}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9082606558926673`*^9, 3.90826074146418*^9}, {
  3.908260775032724*^9, 3.908260853253954*^9}, {3.9082610469179754`*^9, 
  3.908261054352228*^9}, {3.9082620009929934`*^9, 3.908262009767641*^9}, {
  3.9082645132858267`*^9, 3.9082645332517653`*^9}, {3.9082656030040064`*^9, 
  3.908265621656623*^9}, {3.9083599920058002`*^9, 3.9083599938255324`*^9}},
 CellLabel->
  "In[661]:=",ExpressionUUID->"53498f5d-46dc-405d-9d77-39dd0d1feb5d"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lattice model (stochastic, individual-based)", "Section",
 CellChangeTimes->{{3.780050617673833*^9, 3.780050619389836*^9}, {
  3.861160780955863*^9, 3.8611607844335585`*^9}, {3.885283614706681*^9, 
  3.8852836235569086`*^9}},ExpressionUUID->"c230bbbf-fdb6-43c9-ae5d-\
cdd6607c1237"],

Cell[CellGroupData[{

Cell["Auxiliary", "Subsection",
 CellChangeTimes->{{3.8611804020487013`*^9, 
  3.8611804042530775`*^9}},ExpressionUUID->"b0d4ef7a-a511-4ff8-a707-\
f5791fc967cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"merge", ",", "timeStamp", ",", "parameterStamp"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"DatasetForm", ",", 
     RowBox[{"\"\<RecursiveApply\>\"", "\[Rule]", 
      RowBox[{"!", "True"}]}], ",", 
     RowBox[{"\"\<ElidedKeys\>\"", "->", 
      RowBox[{"{", "\"\<Parameters\>\"", "}"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Merges", " ", "options"}], ",", " ", 
    RowBox[{"preferring", " ", "right", " ", "over", " ", 
     RowBox[{"left", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"merge", "[", "opts__", "]"}], ":=", 
    RowBox[{
     RowBox[{"Association", "@@", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Flatten", "@", 
         RowBox[{"{", "opts", "}"}]}], ",", 
        RowBox[{"_Rule", "|", "_RuleDelayed"}]}], "]"}]}], "//", "Normal"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeStamp", "[", "str_String", "]"}], ":=", 
   RowBox[{"timeStamp", "[", 
    RowBox[{"str", ",", "\"\<_\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeStamp", "[", 
    RowBox[{"str_String", ",", "inter_String"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"StringMatchQ", "[", 
      RowBox[{"str", ",", 
       RowBox[{"___", "~~", "\"\<.\>\"", "~~", 
        RowBox[{"WordCharacter", ".."}]}]}], "]"}], ",", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"str", ",", 
       RowBox[{
        RowBox[{"pre__", "~~", 
         RowBox[{"ext", ":", 
          RowBox[{"(", 
           RowBox[{"\"\<.\>\"", "~~", 
            RowBox[{"WordCharacter", ".."}]}], ")"}]}], "~~", "EndOfString"}],
         "\[RuleDelayed]", 
        RowBox[{"pre", "<>", "inter", "<>", 
         RowBox[{"timeStamp", "[", "]"}], "<>", "ext"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"str", "<>", "inter", "<>", 
      RowBox[{"timeStamp", "[", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"timeStamp", "[", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"$DateStringFormat", "=", 
        RowBox[{"{", 
         RowBox[{
         "\"\<YearShort\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
          "\"\<-\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", 
          "\"\<Second\>\""}], "}"}]}], "}"}], ",", 
      RowBox[{"DateString", "[", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parameterStamp", "[", 
    RowBox[{
     RowBox[{"{", "}"}], "|", 
     RowBox[{"{", 
      RowBox[{"{", "}"}], "}"}], "|", 
     RowBox[{"<|", "|>"}]}], "]"}], ":=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parameterStamp", "[", 
    RowBox[{"par_Association", ",", 
     RowBox[{"var_", ":", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"parameterStamp", "[", 
    RowBox[{
     RowBox[{"Normal", "@", "par"}], ",", "var"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parameterStamp", "[", 
    RowBox[{
     RowBox[{"par", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}]}], ",", 
     
     RowBox[{"var_", ":", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"def", "=", "\"\<\>\""}], ",", 
       RowBox[{"inner", "=", "\"\<=\>\""}], ",", 
       RowBox[{"outer", "=", "\"\<_\>\""}], ",", 
       RowBox[{"wrap", "=", 
        RowBox[{"{", 
         RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], ",", "name", ",", 
       "type", ",", "val", ",", "in"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"in", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"var", ",", "\[IndentingNewLine]", "_Integer", ",", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"First", "/@", "par"}], ",", 
           RowBox[{"UpTo", "@", "var"}]}], "]"}], ",", "\[IndentingNewLine]", 
         "_List", ",", "var", ",", "\[IndentingNewLine]", 
         RowBox[{"Automatic", "|", "All"}], ",", 
         RowBox[{"First", "/@", "par"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<\>\"", "|", 
          RowBox[{"{", "}"}], "|", 
          RowBox[{"<|", "|>"}], "|", "None"}], ",", "None", ",", 
         "\[IndentingNewLine]", "_", ",", 
         RowBox[{"{", "var", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"in", "===", "None"}], ",", "\"\<\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"name", ",", "val"}], "}"}], "=", 
          RowBox[{"Transpose", "@", 
           RowBox[{"Thread", "@", 
            RowBox[{"{", 
             RowBox[{"in", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"in", "/.", "par"}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"in", "\[Rule]", "def"}], "]"}]}], ")"}]}], 
             "}"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StringJoin", "@", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Riffle", "[", 
              RowBox[{
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ToString", "@", "#1"}], ",", "inner", ",", 
                    RowBox[{"wrap", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"ToString", "@", "#2"}], ",", 
                    RowBox[{"wrap", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"name", ",", "val"}], "}"}]}], "]"}], ",", 
               "outer"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\</\>\"", "\[Rule]", "\"\<%\>\""}], "}"}]}], "]"}]}]}],
        "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8611805744707994`*^9, 3.861180653894606*^9}, 
   3.8611809988890276`*^9, {3.8613394429953547`*^9, 3.861339479862497*^9}, {
   3.861342869243185*^9, 3.861342876702022*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"3aadb621-a584-4560-a486-33c6fb01fe6b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Definitions", "Subsection",
 CellChangeTimes->{{3.811001398308473*^9, 3.811001398608474*^9}, {
   3.811001782303011*^9, 3.81100178859302*^9}, 3.811745541643689*^9, {
   3.811745857461134*^9, 3.81174586219114*^9}, {3.817190565418233*^9, 
   3.8171905665682344`*^9}},ExpressionUUID->"5673af70-2390-4687-ba5c-\
ea45ec1134fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"General", "::", "nofile"}], "=", 
    "\"\<ERROR! File or directory at path `1` does not exist.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$InputFile", "=", "\"\<QS_input.dat\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$InputFileMask", "=", "\"\<QS*_input.dat\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$DataFileMask", "=", "\"\<*.out\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "$BinaryFile", "=", 
    "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Code\\\\220510 Spatial Tom \
modified Z\\\\QSG_Cue_8strat_AdditiveFitness_Imitation_Spatial_IZ2.exe\>\""}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$GenotypeLabels", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Lazy\>\"", ",", "\"\<Voyeur\>\"", ",", "\"\<Liar\>\"", ",", 
     "\"\<CuriousLiar\>\"", ",", "\"\<Trusty\>\"", ",", "\"\<Smart\>\"", ",", 
     "\"\<Bouncer\>\"", ",", "\"\<Nerd\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$ColorFunction", "=", 
    RowBox[{
     RowBox[{"Hue", "[", 
      RowBox[{
       RowBox[{"#", " ", ".8"}], ",", "1", ",", ".7"}], "]"}], "&"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"col", "=", 
   RowBox[{
    RowBox[{"Length", "@", "$GenotypeLabels"}], "+", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"posInd", "=", 
    RowBox[{"PositionIndex", "@", "$GenotypeLabels"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "n", ",", "k", ",", "c", ",", "r", ",", "b", ",", "c0", ",", "d", ",", "s",
     ",", "w0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "processLine", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTE", ":", " ", 
    RowBox[{
    "Process", " ", "a", " ", "line", " ", "of", " ", "the", " ", "input", 
     " ", "file"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "processLine", "]"}], "=", 
   RowBox[{"{", "Listable", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"processLine", "[", "s_String", "]"}], ":=", 
    RowBox[{"StringCases", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{"v__", "~~", "\"\<(:\>\"", "~~", 
        RowBox[{"Longest", "[", "n___", "]"}], "~~", 
        RowBox[{"(", 
         RowBox[{"\"\<,\>\"", "~~", 
          RowBox[{"Longest", "[", "k___", "]"}]}], ")"}], "~~", "\"\<)\>\""}],
        "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringTrim", "@", "k"}], "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "#"}], "===", "1"}], ",", 
             RowBox[{"ToExpression", "@", 
              RowBox[{"First", "@", "#"}]}], ",", 
             RowBox[{"ToExpression", "/@", "#"}]}], "]"}]}], "&"}], "@", 
         RowBox[{"StringSplit", "@", "v"}]}], ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$DefaultAnalyticParameters", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "9"}], ",", 
     RowBox[{"k", "\[Rule]", "5"}], ",", 
     RowBox[{"c", "\[Rule]", "1"}], ",", 
     RowBox[{"r", "\[Rule]", "1"}], ",", 
     RowBox[{"b", "\[Rule]", "0.9"}], ",", 
     RowBox[{"d", "\[Rule]", "0.0"}], ",", 
     RowBox[{"c0", "\[Rule]", "100"}], ",", 
     RowBox[{"w0", "->", "0"}]}], "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$AnalyticParameterSet", "=", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<A\>\"", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"n", "\[Rule]", "9"}], ",", 
         RowBox[{"k", "\[Rule]", "3"}], ",", 
         RowBox[{"c", "\[Rule]", "0.3"}], ",", 
         RowBox[{"r", "\[Rule]", "0.01"}], ",", 
         RowBox[{"b", "\[Rule]", "0.3"}], ",", 
         RowBox[{"c0", "\[Rule]", "1"}], ",", 
         RowBox[{"d", "\[Rule]", "0.0"}], ",", 
         RowBox[{"w0", "->", "0"}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<B\>\"", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"n", "\[Rule]", "9"}], ",", 
         RowBox[{"k", "\[Rule]", "3"}], ",", 
         RowBox[{"c", "\[Rule]", "0.3"}], ",", 
         RowBox[{"r", "\[Rule]", "0.01"}], ",", 
         RowBox[{"b", "\[Rule]", "0.5"}], ",", 
         RowBox[{"c0", "\[Rule]", "1"}], ",", 
         RowBox[{"d", "\[Rule]", "0.0"}], ",", 
         RowBox[{"w0", "->", "0"}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<C\>\"", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"n", "\[Rule]", "9"}], ",", 
         RowBox[{"k", "\[Rule]", "3"}], ",", 
         RowBox[{"c", "\[Rule]", "0.3"}], ",", 
         RowBox[{"r", "\[Rule]", "0.2"}], ",", 
         RowBox[{"b", "\[Rule]", "0.65"}], ",", 
         RowBox[{"c0", "\[Rule]", "1"}], ",", 
         RowBox[{"d", "\[Rule]", "0.0"}], ",", 
         RowBox[{"w0", "->", "0"}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<D\>\"", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"n", "\[Rule]", "9"}], ",", 
         RowBox[{"k", "\[Rule]", "3"}], ",", 
         RowBox[{"c", "\[Rule]", "0.3"}], ",", 
         RowBox[{"r", "\[Rule]", "0.01"}], ",", 
         RowBox[{"b", "\[Rule]", "0.6"}], ",", 
         RowBox[{"c0", "\[Rule]", "1"}], ",", 
         RowBox[{"d", "\[Rule]", "0.0"}], ",", 
         RowBox[{"w0", "->", "0"}]}], "|>"}]}]}], "\[IndentingNewLine]", 
     "|>"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$StochasticParameterSet", "=", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<A\>\"", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<QSThreshold\>\"", "\[Rule]", "3"}], ",", 
         RowBox[{"\"\<Cost\>\"", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "30"}], "}"}]}], ",", 
         RowBox[{"\"\<CooperationBenefit\>\"", "\[Rule]", "0.3"}], ",", 
         RowBox[{"\"\<BaseMetabolicCost\>\"", "\[Rule]", "100"}], ",", 
         RowBox[{"\"\<DiffusionStep\>\"", "->", "0"}]}], "|>"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<B\>\"", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<QSThreshold\>\"", "\[Rule]", "3"}], ",", 
         RowBox[{"\"\<Cost\>\"", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "30"}], "}"}]}], ",", 
         RowBox[{"\"\<CooperationBenefit\>\"", "\[Rule]", "0.5"}], ",", 
         RowBox[{"\"\<BaseMetabolicCost\>\"", "\[Rule]", "100"}], ",", 
         RowBox[{"\"\<DiffusionStep\>\"", "->", "0"}]}], "|>"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<C\>\"", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<QSThreshold\>\"", "\[Rule]", "3"}], ",", 
         RowBox[{"\"\<Cost\>\"", "->", 
          RowBox[{"{", 
           RowBox[{"20", ",", "0", ",", "30"}], "}"}]}], ",", 
         RowBox[{"\"\<CooperationBenefit\>\"", "\[Rule]", "0.65"}], ",", 
         RowBox[{"\"\<BaseMetabolicCost\>\"", "\[Rule]", "100"}], ",", 
         RowBox[{"\"\<DiffusionStep\>\"", "->", "0"}]}], "|>"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<D\>\"", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<QSThreshold\>\"", "\[Rule]", "3"}], ",", 
         RowBox[{"\"\<Cost\>\"", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "30"}], "}"}]}], ",", 
         RowBox[{"\"\<CooperationBenefit\>\"", "\[Rule]", "0.6"}], ",", 
         RowBox[{"\"\<BaseMetabolicCost\>\"", "\[Rule]", "100"}], ",", 
         RowBox[{"\"\<DiffusionStep\>\"", "->", "0"}]}], "|>"}]}]}], 
     "\[IndentingNewLine]", "|>"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTE", ":", " ", 
    RowBox[{"Order", " ", "of", " ", "parameters", " ", "DOES", " ", 
     RowBox[{"matter", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTE", ":", " ", 
    RowBox[{"{", 
     RowBox[{"Respond", ",", " ", "Signal", ",", " ", "Cooperate"}], "}"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTE", ":", " ", "Genotypes", ":", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$DefaultStochasticParamaters", "=", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Cost\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "30"}], "}"}]}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"Cost", " ", "of", " ", "function"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<BaseMetabolicCost\>\"", "->", "100"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"Basic", " ", "metabolic", " ", "burden"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<AlleleGainMutation\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"Mutation", " ", "rate"}], ":", " ", 
        RowBox[{"acquire", " ", "allele"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<AlleleLoseMutation\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"Mutation", " ", "rate"}], ":", " ", 
        RowBox[{"lose", " ", "allele"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\"\<QSThreshold\>\"", "->", "3"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{
        "QS", " ", "threshold", " ", "within", " ", "neighbourhood"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\"\<EffectorThreshold\>\"", "->", "3"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{
        "Effector", " ", "threshold", " ", "within", " ", "neighbourhood"}]}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\"\<CooperationBenefit\>\"", "->", "0.6"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"NOTE", ":", " ", 
         RowBox[{"Cooperation", " ", "benefit"}]}], ",", " ", 
        RowBox[{
         RowBox[{"prop", ".", " ", "of"}], " ", "total", " ", "metabolic", 
         " ", "burden"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\"\<DiffusionStep\>\"", "->", "0"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"Diffusion", " ", "steps", " ", "per", " ", "generation"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\"\<GridSize\>\"", "->", "300"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"Grid", " ", "size"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\"\<GenerationNumber\>\"", "->", "100"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{
        "Number", " ", "of", " ", "generations", " ", "to", " ", "run"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\"\<RandomSeed\>\"", "->", "0"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"0", " ", "uses", " ", "system", " ", "time"}]}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"\"\<PrintMap\>\"", "->", "20000"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{
        "Print", " ", "map", " ", "of", " ", "every", " ", "#th", " ", 
         "generation"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\"\<SelectionCoefficient\>\"", "->", "1.0"}], ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"Selection", " ", "coefficient"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<InitialFrequency\>\"", "->", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", 
         "0"}], "}"}]}]}], " ", "\[IndentingNewLine]", "|>"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$ParameterAliases", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Locus/function index\>\"", "|", "\"\<Index\>\""}], "->", 
       "\"\<Index\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<Cost of function\>\"", "|", "\"\<Cost(i)\>\"", "|", 
        "\"\<Cost\>\""}], "->", "\"\<Cost\>\""}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "\"\<Basic metabolic burden\>\"", "|", "\"\<Met_bur\>\"", "|", 
        "\"\<BaseMetabolicCost\>\""}], "->", "\"\<BaseMetabolicCost\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<acquire allele\>\"", "|", "\"\<Mut_acq(i)\>\"", "|", 
        "\"\<AlleleGainMutation\>\""}], "->", "\"\<AlleleGainMutation\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<lose allele\>\"", "|", "\"\<Mut_los(i)\>\"", "|", 
        "\"\<AlleleLoseMutation\>\""}], "->", "\"\<AlleleLoseMutation\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<QS Threshold\>\"", "|", "\"\<QS_tresh\>\"", "|", 
        "\"\<QSThreshold\>\""}], "->", "\"\<QSThreshold\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<Effector threshold\>\"", "|", "\"\<EF_tresh\>\"", "|", 
        "\"\<EffectorThreshold\>\""}], "->", "\"\<EffectorThreshold\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<Coop benefit\>\"", "|", "\"\<AB\>\"", "|", 
        "\"\<CooperationBenefit\>\""}], "->", "\"\<CooperationBenefit\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<Diffusion steps\>\"", "|", "\"\<Diff\>\"", "|", 
        "\"\<DiffusionStep\>\""}], "->", "\"\<DiffusionStep\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<Grid size\>\"", "|", "\"\<Grid_size\>\"", "|", 
        "\"\<GridSize\>\""}], "->", "\"\<GridSize\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<Number of generations\>\"", "|", "\"\<Ngen\>\"", "|", 
        "\"\<GenerationNumber\>\""}], "->", "\"\<GenerationNumber\>\""}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<RND generator seed\>\"", "|", "\"\<Myseed\>\"", "|", 
        "\"\<RandomSeed\>\""}], "->", "\"\<RandomSeed\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<Print map\>\"", "|", "\"\<Nmap\>\"", "|", "\"\<PrintMap\>\""}], 
       "->", "\"\<PrintMap\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<Selection coefficient\>\"", "|", "\"\<Sigma\>\"", "|", 
        "\"\<SelectionCoefficient\>\""}], "->", 
       "\"\<SelectionCoefficient\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Genotype labels\>\"", "|", "\"\<GenotypeLabel\>\""}], 
       "->", "\"\<GenotypeLabel\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<Genotype frequency\>\"", "|", "\"\<Ini(k)\>\"", "|", 
        "\"\<InitialFrequency\>\""}], "->", "\"\<InitialFrequency\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$ParameterSubstitutions", "=", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"k", "\[Rule]", "\"\<QS_tresh\>\""}], ",", 
      RowBox[{"c", "\[Rule]", 
       RowBox[{"Indexed", "[", 
        RowBox[{"\"\<Cost(i)\>\"", ",", "3"}], "]"}]}], ",", 
      RowBox[{"r", "\[Rule]", 
       RowBox[{"Indexed", "[", 
        RowBox[{"\"\<Cost(i)\>\"", ",", "1"}], "]"}]}], ",", 
      RowBox[{"b", "\[Rule]", "\"\<AB\>\""}], ",", 
      RowBox[{"d", "\[Rule]", "\"\<Diff\>\""}], ",", 
      RowBox[{"c0", "\[Rule]", "\"\<Met_bur\>\""}]}], "|>"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "parameterSave", ",", "parameterRead", ",", "readParameterStamp", ",", 
     "stochasticToAnalyticParameters", ",", "getParameters", ",", 
     "getDataFile"}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"NOTE", ":", " ", 
     RowBox[{"Stores", " ", "simplified", " ", "input", " ", "parameters"}]}],
     ",", " ", 
    RowBox[{"one", " ", "value", " ", "at", " ", "a", " ", 
     RowBox[{"line", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parameterSave", "[", 
     RowBox[{"par_Association", ",", "file_String"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"keys", "=", 
         RowBox[{"Keys", "@", "$DefaultStochasticParamaters"}]}], ",", 
        "vals"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vals", "=", 
        RowBox[{
         RowBox[{"keys", "/.", "par"}], "/.", 
         "$DefaultStochasticParamaters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"StringJoin", "@", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "@", "#2"}], ",", 
               RowBox[{"ToString", "/@", 
                RowBox[{"Riffle", "[", 
                 RowBox[{"#2", ",", "\"\<\\t\>\""}], "]"}]}], ",", 
               RowBox[{"ToString", "@", "#2"}]}], "]"}], "<>", 
             "\"\<\\t\\t(:\>\"", "<>", 
             RowBox[{"ToString", "@", "#1"}], "<>", "\"\<)\\n\>\""}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"keys", ",", "vals"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "@", "s"}], ",", 
         RowBox[{"Echo", "@", 
          RowBox[{"FileAutoNumber", "@", "s"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"file", ",", "s", ",", "\"\<Text\>\""}], "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"NOTE", ":", " ", 
     RowBox[{"Reads", " ", "simplified", " ", "input", " ", "parameters"}]}], 
    ",", " ", 
    RowBox[{"one", " ", "value", " ", "at", " ", "a", " ", 
     RowBox[{"line", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parameterRead", "[", "s_String", "]"}], ":=", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FileType", "@", "s"}], "===", "Directory"}], ",", 
      RowBox[{"FirstCase", "[", 
       RowBox[{
        RowBox[{"FileNames", "[", 
         RowBox[{"$InputFileMask", ",", 
          RowBox[{"{", "s", "}"}], ",", 
          RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], ",", 
        RowBox[{"f_String", ":>", 
         RowBox[{"parameterRead", "@", "f"}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"General", "::", "nofile"}], ",", 
           RowBox[{"FileNameJoin", "@", 
            RowBox[{"{", 
             RowBox[{"s", ",", "$InputFileMask"}], "}"}]}]}], "]"}], ";", 
         RowBox[{"<|", "|>"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FileType", "@", "s"}], "===", "File"}], ",", 
      RowBox[{"parameterRead", "@", 
       RowBox[{"Import", "[", 
        RowBox[{"s", ",", "\"\<Text\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FileType", "@", "s"}], "===", "None"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"StringCases", "[", 
            RowBox[{
             RowBox[{"StringTrim", "@", "#"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"n", ":", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"NumberString", "~~", "Whitespace"}], ")"}], 
                  ".."}], ")"}]}], "~~", "\"\<(:\>\"", "~~", "key__", "~~", 
               "\"\<)\>\""}], ":>", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"FirstCase", "[", 
                   RowBox[{
                    RowBox[{"StringCases", "[", 
                    RowBox[{"key", ",", "$ParameterAliases"}], "]"}], ",", 
                    "_String", ",", 
                    RowBox[{"Missing", "[", "]"}]}], "]"}], "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "==", "1"}], ",", 
                    RowBox[{"First", "@", "#"}], ",", "#"}], "]"}]}], "&"}], 
                "@", 
                RowBox[{"ToExpression", "@", 
                 RowBox[{"StringSplit", "@", "n"}]}]}], ")"}]}]}], "]"}], 
           "&"}], "/@", 
          RowBox[{"StringSplit", "[", 
           RowBox[{"s", ",", 
            RowBox[{"\"\<\\n\>\"", "|", "\"\<\\r\>\""}]}], "]"}]}], 
         ")"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTE", ":", " ", 
    RowBox[{"To", " ", "read", " ", "parameters", " ", "from", " ", 
     RowBox[{"filename", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"readParameterStamp", "[", "str_String", "]"}], ":=", 
    RowBox[{"Flatten", "@", 
     RowBox[{"StringCases", "[", 
      RowBox[{"str", ",", 
       RowBox[{
        RowBox[{"\"\<_\>\"", "~~", 
         RowBox[{"key", ":", 
          RowBox[{"LetterCharacter", ".."}]}], "~~", "\"\<=\>\"", "~~", 
         RowBox[{"val", ":", "NumberString"}]}], ":>", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ToExpression", "@", "key"}], "->", 
          RowBox[{"ToExpression", "@", "val"}]}], "}"}]}]}], "]"}]}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stochasticToAnalyticParameters", "[", "par_Association", "]"}], ":=", 
   RowBox[{"stochasticToAnalyticParameters", "@", 
    RowBox[{"Normal", "@", "par"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stochasticToAnalyticParameters", "[", 
     RowBox[{"par", ":", 
      RowBox[{"{", "___Rule", "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "bmc", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bmc", "=", 
        RowBox[{"\"\<BaseMetabolicCost\>\"", "/.", "par"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "n", ",", "k", ",", "c", ",", "r", ",", "b", ",", "c0", ",", "d"}], 
          "}"}], ",", 
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\"\<N\>\"", "/.", "par"}], "/.", 
              RowBox[{"\"\<N\>\"", "->", 
               RowBox[{"(", 
                RowBox[{"n", "/.", "$DefaultAnalyticParameters"}], ")"}]}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"k", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\"\<K\>\"", "/.", "par"}], "/.", 
              RowBox[{"\"\<K\>\"", "->", 
               RowBox[{"(", 
                RowBox[{"\"\<QSThreshold\>\"", "/.", "par"}], ")"}]}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"c", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\"\<C\>\"", "/.", "par"}], "/.", 
                RowBox[{"\"\<C\>\"", "->", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Indexed", "[", 
                    RowBox[{"\"\<Cost\>\"", ",", "3"}], "]"}], "/.", "par"}], 
                  ")"}]}]}], ")"}], "/", 
              RowBox[{"N", "@", "bmc"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"r", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\"\<R\>\"", "/.", "par"}], "/.", 
                RowBox[{"\"\<R\>\"", "->", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Indexed", "[", 
                    RowBox[{"\"\<Cost\>\"", ",", "1"}], "]"}], "/.", "par"}], 
                  ")"}]}]}], ")"}], "/", 
              RowBox[{"N", "@", "bmc"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"b", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\"\<b\>\"", "/.", "par"}], "/.", 
              RowBox[{"\"\<b\>\"", "->", 
               RowBox[{"(", 
                RowBox[{"\"\<CooperationBenefit\>\"", "/.", "par"}], 
                ")"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"c0", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\"\<c0\>\"", "/.", "par"}], "/.", 
                RowBox[{"\"\<c0\>\"", "->", 
                 RowBox[{"(", 
                  RowBox[{"\"\<BaseMetabolicCost\>\"", "/.", "par"}], 
                  ")"}]}]}], ")"}], "/", 
              RowBox[{"N", "@", "bmc"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"d", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\"\<Diff\>\"", "/.", "par"}], "/.", 
              RowBox[{"\"\<Diff\>\"", "->", 
               RowBox[{"(", 
                RowBox[{"\"\<DiffusionStep\>\"", "/.", "par"}], ")"}]}]}], 
             ")"}]}]}], "\[IndentingNewLine]", "|>"}]}], "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTE", ":", " ", 
    RowBox[{"Read", " ", "complex", " ", "input", " ", "file"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getParameters", "[", 
    RowBox[{"r", ":", 
     RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
   RowBox[{"Association", "@", "r"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getParameters", "[", "a_Association", "]"}], ":=", "a"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getParameters", "[", 
    RowBox[{"File", "[", "s_String", "]"}], "]"}], ":=", "s"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getParameters", "[", "s_String", "]"}], ":=", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FileType", "@", "s"}], "===", "Directory"}], ",", 
      RowBox[{"FirstCase", "[", 
       RowBox[{
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<*input*\>\"", ",", 
          RowBox[{"{", "s", "}"}], ",", 
          RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], ",", 
        RowBox[{"f_String", ":>", 
         RowBox[{"getParameters", "@", "f"}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"General", "::", "nofile"}], ",", 
           RowBox[{"FileNameJoin", "@", 
            RowBox[{"{", 
             RowBox[{"s", ",", "\"\<*input*\>\""}], "}"}]}]}], "]"}], ";", 
         RowBox[{"<|", "|>"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FileType", "@", "s"}], "===", "None"}], ",", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"General", "::", "nofile"}], ",", "s"}], "]"}], ";", 
       RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"StringMatchQ", "[", 
       RowBox[{
        RowBox[{"FileBaseName", "@", "s"}], ",", "\"\<*output*\>\"", ",", 
        RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], ",", 
      RowBox[{"getParameters", "@", 
       RowBox[{"DirectoryName", "@", "s"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"StringMatchQ", "[", 
       RowBox[{
        RowBox[{"FileBaseName", "@", "s"}], ",", "\"\<*input*\>\"", ",", 
        RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{"$DefaultStochasticParamaters", ",", 
        RowBox[{"(", 
         RowBox[{"Evaluate", "/@", 
          RowBox[{"(", 
           RowBox[{"$ParameterSubstitutions", "/.", 
            RowBox[{"Flatten", "@", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"processLine", "@", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"StringTrim", "@", 
                   RowBox[{"Import", "[", 
                    RowBox[{"s", ",", "\"\<Lines\>\""}], "]"}]}], ",", 
                  RowBox[{"\"\<\>\"", "|", "\"\<,\>\""}]}], "]"}]}], ",", 
               RowBox[{"{", "}"}]}], "]"}]}]}], ")"}]}], ")"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "True", ",", 
      RowBox[{"stochasticToAnalyticParameters", "@", 
       RowBox[{"readParameterStamp", "@", "s"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getDataFile", "[", "dir_String", "]"}], ":=", 
    RowBox[{"FileNameTake", "@", 
     RowBox[{"First", "@", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"FileNames", "[", 
         RowBox[{"$DataFileMask", ",", "dir"}], "]"}], ",", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"StringMatchQ", "[", 
            RowBox[{"#", ",", 
             RowBox[{"\"\<*nohup.out\>\"", "|", "\"\<temp.out\>\""}], ",", 
             RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], "&"}], 
          ")"}]}]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "trajectory", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTE", ":", " ", 
    RowBox[{"Creates", " ", "the", " ", "trajectory"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trajectory", "[", 
     RowBox[{"dat_List", ",", 
      RowBox[{"lbl", ":", 
       RowBox[{"{", "__String", "}"}]}], ",", 
      RowBox[{"d_Integer", ":", "1"}], ",", 
      RowBox[{"cf_", ":", "$ColorFunction"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"times", ",", "data", ",", "ind", ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "@", "dat"}]}], ",", "m", ",", "colors"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ind", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"lbl", "/.", 
          RowBox[{"PositionIndex", "@", "$GenotypeLabels"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"times", ",", "data"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ",", 
            RowBox[{"Rest", "@", "#"}]}], "}"}], "&"}], "@", 
         RowBox[{"Transpose", "@", "dat"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"Downsample", "[", 
         RowBox[{"data", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "d"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"Transpose", "@", 
         RowBox[{"data", "[", 
          RowBox[{"[", "ind", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"colors", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"cf", "[", 
           RowBox[{"i", "/", "m"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ternaryToSimplex", "/@", 
           RowBox[{"N", "@", "data"}]}], ")"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"cf", "===", "None"}], ",", "Nothing", ",", 
           RowBox[{"VertexColors", "\[Rule]", "colors"}]}], "]"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"trim", ",", "runModel", ",", "readModelData"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trim", "[", "a_Association", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "@", "#"}], ",", 
        RowBox[{"StringTrim", "@", "#"}], ",", "#"}], "]"}], "&"}], "/@", 
     "a"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"NOTE", ":", " ", 
     RowBox[{"If", " ", "input", " ", "file", " ", "exists"}]}], ",", " ", 
    RowBox[{
    "reads", " ", "it", " ", "and", " ", "completes", " ", "it", " ", "with", 
     " ", "user", " ", "supplied", " ", 
     RowBox[{"specification", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTE", ":", " ", 
    RowBox[{
    "Deletes", " ", "all", " ", "existing", " ", "files", " ", "in", " ", 
     "the", " ", 
     RowBox[{"directory", "!"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "runModel", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Verbose\>\"", "->", "False"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"runModel", "[", 
     RowBox[{"path_String", ",", "spec_Association", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", ",", "dir", ",", "in", ",", "par", ",", "out"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dir", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "@", "path"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"DirectoryQ", "@", "path"}], ",", "path", ",", 
            RowBox[{"DirectoryName", "@", "path"}]}], "]"}], ",", 
          RowBox[{"CreateDirectory", "@", "path"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"in", "=", 
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"{", 
          RowBox[{"dir", ",", "$InputFile"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"par", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"$DefaultStochasticParamaters", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "@", "in"}], ",", 
            RowBox[{"parameterRead", "@", "in"}], ",", 
            RowBox[{"<|", "|>"}]}], "]"}], ",", "spec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DeleteFile", "/@", 
        RowBox[{"FileNames", "[", 
         RowBox[{
          RowBox[{"{", "\"\<*\>\"", "}"}], ",", "dir"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"in", "=", 
        RowBox[{"parameterSave", "[", 
         RowBox[{"par", ",", "in"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"RunProcess", "[", 
         RowBox[{"$BinaryFile", ",", 
          RowBox[{"ProcessDirectory", "->", "dir"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"out", "=", 
        RowBox[{"FirstCase", "[", 
         RowBox[{
          RowBox[{"FileNames", "[", 
           RowBox[{"$DataFileMask", ",", 
            RowBox[{"{", "dir", "}"}]}], "]"}], ",", "_String", ",", 
          RowBox[{"Missing", "[", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"trim", "@", "res"}], ",", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Parameters\>\"", "->", "par"}], ",", 
           RowBox[{"\"\<Directory\>\"", "->", "dir"}], ",", 
           RowBox[{"\"\<InputFile\>\"", "->", "in"}], ",", 
           RowBox[{"\"\<OutputFile\>\"", "->", "out"}]}], "|>"}]}], "]"}]}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTE", ":", " ", 
    RowBox[{
    "Reads", " ", "data", " ", "of", " ", "a", " ", "single", " ", 
     "simulation"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"readModelData", "[", "o_", "]"}], ":=", 
   RowBox[{"readModelData", "[", 
    RowBox[{"o", ",", "$SimplexLabels"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"readModelData", "[", 
    RowBox[{"o_Association", ",", "lbl_List"}], "]"}], ":=", 
   RowBox[{"readModelData", "[", 
    RowBox[{
     RowBox[{"o", "@", "\"\<OutputFile\>\""}], ",", "lbl"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"readModelData", "[", 
    RowBox[{
     RowBox[{"path_String", "?", "DirectoryQ"}], ",", "lbl_List"}], "]"}], ":=", 
   RowBox[{"FirstCase", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"$DataFileMask", ",", 
       RowBox[{"{", "path", "}"}]}], "]"}], ",", 
     RowBox[{"f_String", ":>", 
      RowBox[{"readModelData", "[", 
       RowBox[{"f", ",", "lbl"}], "]"}]}], ",", 
     RowBox[{"Missing", "[", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"readModelData", "[", 
      RowBox[{"path_String", ",", "lbl_List"}], "]"}], "/;", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "@", "path"}], ",", "True", ",", 
       RowBox[{
        RowBox[{"Print", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<File `1` does not exist.\>\"", ",", "path"}], "]"}]}], 
        ";", "False"}]}], "]"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", ",", "times", ",", "n", ",", "m"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"StringSplit", "@", 
          RowBox[{"ReadLine", "@", "path"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Close", "@", "path"}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"ReadList", "[", 
         RowBox[{"path", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"Number", ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"trajectory", "[", 
        RowBox[{"data", ",", "lbl"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"TODO", ":", " ", "WIP"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "simplexStreamPlot", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "simplexStreamPlot", "]"}], "=", 
   RowBox[{"Options", "@", "StreamPlot"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"simplexStreamPlot", "[", 
    RowBox[{"par_Association", ",", 
     RowBox[{"flowPoints_", ":", "1"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fx", ",", "fy", ",", "fp", ",", "gridPts", ",", "streamPlot"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gridPts", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Random", " ", "trajectories"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"Hue", "[", 
              RowBox[{".6", ",", ".5", ",", ".6"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"randomCartesianPoint", "@", "50"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Trajectory", " ", "through", " ", "the", " ", "initial", " ", 
           "point", " ", "of", " ", "the", " ", "simulation"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ternaryToCartesian", "@", "init"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"AbsoluteThickness", "@", "2.5"}], ",", 
               RowBox[{"Arrowheads", "@", "1.5"}], ",", "Purple"}], "*)"}], 
             RowBox[{"Hue", "[", 
              RowBox[{".6", ",", ".5", ",", ".6"}], "]"}], "]"}]}], "}"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Background", " ", "flow", " ", "field"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"randomCartesianPoint", "@", "flowPoints"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fx", ",", "fy"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "/@", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n", "=", 
               RowBox[{"par", "@", "n"}]}], ",", 
              RowBox[{"k", "=", 
               RowBox[{"par", "@", "k"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"fLa", "[", 
               RowBox[{"x", ",", "y"}], "]"}], ",", 
              RowBox[{"fTr", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "]"}]}], "/.", 
         "par"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"streamPlot", "=", 
       RowBox[{"StreamPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "@", 
          RowBox[{"{", 
           RowBox[{"fx", ",", "fy"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"Take", "[", 
           RowBox[{"$SimplexLabels", ",", "2"}], "]"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"Mesh", "->", "False"}], ",", 
         RowBox[{"Ticks", "->", "False"}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "$imageSize"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"RegionFunction", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", "<", 
             RowBox[{"1", "-", "#1", "-", "#2"}]}], "&"}], ")"}]}], ",", 
         RowBox[{"RegionBoundaryStyle", "\[Rule]", "None"}], ",", 
         RowBox[{"RegionFillingStyle", "\[Rule]", "None"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Background", "\[Rule]", "White"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StreamScale", "\[Rule]", ".1"}], ",", 
         RowBox[{"StreamStyle", "\[Rule]", 
          RowBox[{"GrayLevel", "@", ".75"}]}], ",", "\[IndentingNewLine]", 
         "opts"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{",", 
           RowBox[{"StreamPoints", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"gridPts", ",", "Automatic", ",", "20"}], "}"}]}], 
           RowBox[{"(*", "Fine", "*)"}], ",", 
           RowBox[{"StreamMarkers", "\[Rule]", "\"\<Line\>\""}]}], "]"}], 
         "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"streamPlot", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Arrow", "[", "c_List", "]"}], "\[RuleDelayed]", 
           RowBox[{"Arrow", "[", 
            RowBox[{"cartesianToSimplex", "/@", "c"}], "]"}]}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GraphicsComplex", "[", 
           RowBox[{"c_List", ",", "x___"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"GraphicsComplex", "[", 
           RowBox[{
            RowBox[{"cartesianToSimplex", "/@", "c"}], ",", "x"}], "]"}]}], 
         "}"}]}], ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.8110028653055573`*^9, 3.8110028743855705`*^9}, {
   3.811002972838711*^9, 3.811002975558715*^9}, {3.8110030516798215`*^9, 
   3.8110030767298565`*^9}, {3.811003123660922*^9, 3.811003128700929*^9}, 
   3.811044264927385*^9, {3.8110443972695704`*^9, 3.8110444022395773`*^9}, {
   3.811044437699627*^9, 3.8110445511218376`*^9}, {3.8110446205579605`*^9, 
   3.8110446463270245`*^9}, {3.8110446778510814`*^9, 
   3.8110447398811684`*^9}, {3.8110447784122567`*^9, 
   3.8110447795122585`*^9}, {3.811044876069518*^9, 3.811044877027545*^9}, {
   3.8110453816210318`*^9, 3.811045381718037*^9}, {3.811654362877583*^9, 
   3.8116543803985853`*^9}, {3.8117429203558426`*^9, 
   3.8117429402458706`*^9}, {3.811742975135919*^9, 3.81174298994594*^9}, {
   3.8117451708055973`*^9, 3.811745203475643*^9}, {3.8117455497037*^9, 
   3.811745558703713*^9}, {3.811837794759861*^9, 3.811837813399887*^9}, {
   3.811838101392305*^9, 3.8118381317823477`*^9}, {3.8118382705025415`*^9, 
   3.8118383046325893`*^9}, {3.8118383351626325`*^9, 3.811838337662636*^9}, {
   3.8118386823521395`*^9, 3.811838685702144*^9}, {3.8118387480922318`*^9, 
   3.811838748332232*^9}, {3.8118390437026453`*^9, 3.8118391280827637`*^9}, {
   3.8118391816828384`*^9, 3.8118392151628857`*^9}, {3.811839405527152*^9, 
   3.8118394062471533`*^9}, {3.8118394550572214`*^9, 3.811839506868294*^9}, {
   3.811839566139377*^9, 3.8118395961794195`*^9}, {3.81184017551023*^9, 
   3.811840180930238*^9}, {3.8118402120402813`*^9, 3.811840305311412*^9}, {
   3.8118414810933294`*^9, 3.811841486343336*^9}, {3.812344269418934*^9, 
   3.8123442729971385`*^9}, {3.8123443471723814`*^9, 3.812344349565518*^9}, {
   3.813116488548188*^9, 3.813116534538252*^9}, {3.8131165854683237`*^9, 
   3.8131165883483276`*^9}, {3.8131166201083717`*^9, 3.813116658798426*^9}, {
   3.81320033224454*^9, 3.813200332737567*^9}, {3.8132003952610393`*^9, 
   3.8132004182223096`*^9}, {3.81320048607308*^9, 3.813200517705845*^9}, {
   3.813200734268738*^9, 3.813200758932098*^9}, {3.8132008012414446`*^9, 
   3.8132008037265825`*^9}, {3.813201169257852*^9, 3.813201200476589*^9}, {
   3.813295913724285*^9, 3.8132959201726427`*^9}, {3.813558452900426*^9, 
   3.813558469389369*^9}, {3.813559619655161*^9, 3.8135596392812834`*^9}, 
   3.8135597383559504`*^9, 3.8135615398823833`*^9, {3.813561664549514*^9, 
   3.813561671558914*^9}, {3.813563540407221*^9, 3.813563561637251*^9}, {
   3.813563606847314*^9, 3.8135636719874053`*^9}, {3.813901938957325*^9, 
   3.813901976220418*^9}, {3.8139020704017143`*^9, 3.8139021487831264`*^9}, 
   3.8139022824876738`*^9, {3.813912667701212*^9, 3.813912683541234*^9}, {
   3.8139127245812917`*^9, 3.813912731428302*^9}, {3.81409531354399*^9, 
   3.814095340046027*^9}, {3.814095373088087*^9, 3.8140953751880903`*^9}, 
   3.8141633843252306`*^9, {3.8141688733002577`*^9, 3.8141688916072826`*^9}, {
   3.8141693773264756`*^9, 3.8141694231000566`*^9}, {3.8141694568839536`*^9, 
   3.8141694806272936`*^9}, {3.8141695893983536`*^9, 
   3.8141696032601466`*^9}, {3.814171136364827*^9, 3.814171138440946*^9}, {
   3.814257736720334*^9, 3.8142577617013693`*^9}, {3.8171905823782563`*^9, 
   3.8171905944882736`*^9}, {3.817202464971222*^9, 3.8172024816912456`*^9}, {
   3.8172025263713083`*^9, 3.8172026434574723`*^9}, {3.817202743351613*^9, 
   3.8172028062047024`*^9}, {3.817202848394761*^9, 3.817202879224805*^9}, {
   3.8172029514449053`*^9, 3.817203052902049*^9}, {3.8172031669042106`*^9, 
   3.817203199384256*^9}, {3.817203292794387*^9, 3.8172033561374764`*^9}, 
   3.817203401167539*^9, {3.8172034316575823`*^9, 3.817203436637589*^9}, {
   3.817203500947679*^9, 3.8172035067976875`*^9}, {3.8172036183699284`*^9, 
   3.817203627339941*^9}, {3.8175479124644976`*^9, 3.817547916704504*^9}, {
   3.817550093969554*^9, 3.8175500972695584`*^9}, {3.817550238309756*^9, 
   3.8175502386097565`*^9}, {3.817633861934179*^9, 3.8176338634041805`*^9}, {
   3.8448484230560904`*^9, 3.844848581418153*^9}, {3.861086214805128*^9, 
   3.8610862211563587`*^9}, {3.861092062665042*^9, 3.861092066632786*^9}, {
   3.861092104763976*^9, 3.861092131680902*^9}, {3.861092168328017*^9, 
   3.861092539897277*^9}, {3.861092576854726*^9, 3.861092659085909*^9}, {
   3.8610927847318783`*^9, 3.86109278538769*^9}, {3.861092835361143*^9, 
   3.861092841405388*^9}, {3.8610929125814977`*^9, 3.861092985375473*^9}, {
   3.861162299700946*^9, 3.8611624723889956`*^9}, {3.8611625244267063`*^9, 
   3.8611625673283186`*^9}, {3.8611626008280945`*^9, 3.861162622194642*^9}, {
   3.861162659651099*^9, 3.86116274542064*^9}, {3.8611627828537416`*^9, 
   3.8611629481945148`*^9}, {3.861162999511443*^9, 3.861163005875473*^9}, {
   3.861163063587257*^9, 3.8611631638732104`*^9}, {3.861163220026659*^9, 
   3.861163279490816*^9}, 3.861163334473257*^9, {3.8611633828702307`*^9, 
   3.861163426383871*^9}, {3.861163494200803*^9, 3.8611635502954473`*^9}, {
   3.8611639016807866`*^9, 3.8611639174649143`*^9}, 3.861163958633255*^9, {
   3.861164004984316*^9, 3.8611643871967335`*^9}, {3.8611644198144217`*^9, 
   3.8611644203319693`*^9}, {3.861164487207616*^9, 3.861164573084959*^9}, {
   3.861169792473255*^9, 3.861169807024315*^9}, {3.861169864017161*^9, 
   3.8611698690504255`*^9}, {3.8611699171212215`*^9, 3.861170055888331*^9}, {
   3.861170097543666*^9, 3.861170218358549*^9}, {3.86117039147736*^9, 
   3.8611703926608334`*^9}, {3.8611704639980583`*^9, 
   3.8611705593576565`*^9}, {3.8611707189538193`*^9, 3.861170802902629*^9}, {
   3.8611708806286135`*^9, 3.861170966911719*^9}, {3.8611710068518267`*^9, 
   3.8611710307604456`*^9}, {3.8611710906044827`*^9, 3.861171120134528*^9}, {
   3.8611711567722883`*^9, 3.861171158114318*^9}, {3.8611712087482347`*^9, 
   3.8611713438075504`*^9}, {3.8611713976670136`*^9, 3.861171489857294*^9}, {
   3.86117163028724*^9, 3.8611716685076056`*^9}, {3.861171849653255*^9, 
   3.86117189210143*^9}, {3.861179257467307*^9, 3.861179294472929*^9}, {
   3.8611793797561245`*^9, 3.8611794079552937`*^9}, 3.861179470721803*^9, 
   3.861179896620062*^9, {3.861181254680257*^9, 3.861181294892994*^9}, {
   3.861191384207652*^9, 3.861191435663229*^9}, {3.861192091428195*^9, 
   3.8611921030214324`*^9}, {3.861243574665228*^9, 3.861243586970688*^9}, {
   3.861334427934565*^9, 3.8613344291122875`*^9}, {3.861334532972842*^9, 
   3.861334624986802*^9}, {3.861334666126952*^9, 3.8613346820386763`*^9}, {
   3.8613347531121054`*^9, 3.8613347742973523`*^9}, {3.8613365155689435`*^9, 
   3.8613365690230894`*^9}, 3.8613368907100315`*^9, {3.8613371984761286`*^9, 
   3.8613372147645946`*^9}, {3.861338018199547*^9, 3.8613385315263805`*^9}, {
   3.8613385873755627`*^9, 3.8613387562728972`*^9}, {3.8613387865866327`*^9, 
   3.86133879237729*^9}, {3.8613388313593445`*^9, 3.861338831729967*^9}, {
   3.8613389017964907`*^9, 3.8613389238702965`*^9}, {3.861338996956582*^9, 
   3.8613390125000267`*^9}, {3.8613390444269643`*^9, 3.861339052315677*^9}, {
   3.8738723209579077`*^9, 3.8738723242168875`*^9}, {3.873872411370919*^9, 
   3.873872443650734*^9}, {3.873872505116657*^9, 3.8738725201426263`*^9}, {
   3.8738731661219*^9, 3.873873167352194*^9}, {3.873873258548458*^9, 
   3.873873258639406*^9}, {3.8738733182179317`*^9, 3.8738733208494253`*^9}, {
   3.8738765555521784`*^9, 3.8738765718154354`*^9}, {3.8738766298132353`*^9, 
   3.873876896405181*^9}, {3.8738776724309263`*^9, 3.8738778970168457`*^9}, {
   3.8738783704087086`*^9, 3.873878585828036*^9}, {3.8738802038414645`*^9, 
   3.873880292881484*^9}, {3.8743068856065397`*^9, 3.8743069826076913`*^9}, {
   3.8743072538921366`*^9, 3.8743073090551376`*^9}, {3.8743073679693217`*^9, 
   3.874307431552783*^9}, {3.874307519023934*^9, 3.8743075203268642`*^9}, {
   3.874385917334241*^9, 3.874385960425626*^9}, {3.8743859933106685`*^9, 
   3.874386077361884*^9}, {3.8743872439356413`*^9, 3.874387246896278*^9}, {
   3.87438728741573*^9, 3.8743873024876113`*^9}, {3.8743873515190897`*^9, 
   3.8743873517508726`*^9}, 3.8743873919968586`*^9, {3.87438742215963*^9, 
   3.8743874952035446`*^9}, 3.8824371973866806`*^9, {3.8824377432698417`*^9, 
   3.8824377481895933`*^9}, {3.88605979182729*^9, 3.8860598043287077`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"ccf58817-bcb5-4a7f-bf3c-4184e59df603"]
}, Closed]],

Cell[CellGroupData[{

Cell["Read dataset", "Subsection",
 CellChangeTimes->{{3.811745864531144*^9, 
  3.81174587608116*^9}},ExpressionUUID->"5550dfff-2356-4fc5-b19a-\
3c9cd0f998e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "n", ",", "k", ",", "c", ",", "r", ",", "b", ",", "d", ",", "c0"}], "]"}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\220509 Test\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\221003 Szabolcs \
Fig2\\\\221003_Spatial_Fig2C_LKNG\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "dir", "=", 
    "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\201219 \
Article_figure\\\\Figure_D\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"TrueQ", "@", 
       RowBox[{"FileExistsQ", "@", "dir"}]}]}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Directory \>\"", ",", "dir", ",", "\"\< does not exist.\>\""}], 
       "]"}], ";"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"file", "=", 
  RowBox[{"getDataFile", "@", "dir"}]}], "\[IndentingNewLine]", 
 RowBox[{"stPar", "=", 
  RowBox[{"parameterRead", "@", "dir"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"anPar", "=", 
   RowBox[{"stochasticToAnalyticParameters", "@", "stPar"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"For", " ", 
    RowBox[{"Tom", "'"}], "s", " ", "outut", " ", "files"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"file", "=", "\"\<QS_Cue_CF_D_k=3_c=30_r=01_b=0.60.out\>\""}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"anPar", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"$DefaultAnalyticParameters", ",", 
       RowBox[{"KeyMap", "[", 
        RowBox[{"ToExpression", ",", 
         RowBox[{"Association", "@", 
          RowBox[{"readParameterStamp", "@", "file"}]}]}], "]"}]}], "]"}]}]}],
    "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parName", "=", "d"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"parameter", " ", "that", " ", "is", " ", "scanned"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ind", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<Lazy\>\"", ",", "\"\<Trusty\>\"", ",", "\"\<Smart\>\""}], 
     "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Plot", " ", "the", " ", "trajectory", " ", "of", " ", "these", " ", 
     "strategies"}], ",", " ", 
    RowBox[{"corresponding", " ", "to", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], " ", "simplex", " ", 
     RowBox[{"coordinates", "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$rowCount", "=", "10001"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Number", " ", "of", " ", "rows", " ", "that", " ", "define", " ", "a", 
    " ", "single", " ", "dataset", " ", "in", " ", "the", " ", "file"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"lines", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"ReadList", "@", 
          RowBox[{"FileNameJoin", "@", 
           RowBox[{"{", 
            RowBox[{"dir", ",", "file"}], "}"}]}]}]}]}], ")"}], "<", 
      "$rowCount"}], ",", 
     RowBox[{"$rowCount", "=", "lines"}]}], "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Count", " ", "lines"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataAll", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"ReadList", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "@", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "file"}], "}"}]}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"Number", ",", 
         RowBox[{"{", "col", "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "$rowCount", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"Length", "@", "dataAll"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parRange", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"m", "\[Equal]", "1"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "1", ",", 
       RowBox[{"1.", "/", 
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", "total", "}"}], "=", 
   RowBox[{"Union", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Total", "@*", "Rest"}], "/@", 
      RowBox[{"dataAll", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"init", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Rest", "@", 
       RowBox[{"dataAll", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}], "[", 
     RowBox[{"[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ind", "/.", "posInd"}], "]"}], "]"}], "]"}], "/", 
    RowBox[{"N", "@", "total"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"end", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Rest", "@", 
        RowBox[{"dataAll", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ind", "/.", "posInd"}], "]"}], "]"}], "]"}], "/", 
     RowBox[{"N", "@", "total"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Dimensions", "@", "dataAll"}], ",", "total"}], 
   RowBox[{"(*", 
    RowBox[{",", "init", ",", 
     RowBox[{"ternaryToSimplex", "@", "init"}], ",", 
     RowBox[{"ternaryToCartesian", "@", "init"}]}], "*)"}], "}"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lineData", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"val", "=", "#2"}], ",", 
            RowBox[{"local", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"anPar", ",", 
               RowBox[{"<|", 
                RowBox[{"parName", "\[Rule]", "#2"}], "|>"}]}], "]"}]}]}], 
           "}"}], ",", 
          RowBox[{"trajectory", "[", 
           RowBox[{"#1", ",", "ind", ",", "local"}], "]"}]}], "]"}], "&"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"dataAll", ",", "parRange"}], "}"}]}], "]"}]}], ";"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Dynamic", "@", "local"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8110014029484797`*^9, 3.8110014232885084`*^9}, {
   3.811001461069561*^9, 3.8110014799295874`*^9}, {3.8110015106996307`*^9, 
   3.811001753402971*^9}, {3.811001796433031*^9, 3.811001949245245*^9}, {
   3.811002082417432*^9, 3.811002098807454*^9}, {3.8110021618145494`*^9, 
   3.8110021839545803`*^9}, {3.811002217426628*^9, 3.81100221833663*^9}, {
   3.811002305277751*^9, 3.8110023323277893`*^9}, {3.8110024245289183`*^9, 
   3.8110024986800222`*^9}, {3.81100256884212*^9, 3.8110026073121743`*^9}, {
   3.81100268892529*^9, 3.811002755987384*^9}, {3.8110029251266413`*^9, 
   3.811002941156664*^9}, {3.8110031618209753`*^9, 3.8110031674909835`*^9}, {
   3.8110443530585084`*^9, 3.8110443898585596`*^9}, {3.8110445118257446`*^9, 
   3.8110445128757467`*^9}, 3.811044812360326*^9, {3.81165195115164*^9, 
   3.811651981535378*^9}, {3.8116522635135064`*^9, 3.8116522723290105`*^9}, {
   3.8116524006163483`*^9, 3.8116524017714143`*^9}, {3.811652520619212*^9, 
   3.811652520749219*^9}, 3.8116529074293365`*^9, {3.8116529924161973`*^9, 
   3.81165299560938*^9}, {3.811654097611411*^9, 3.811654106381912*^9}, {
   3.8116541420729537`*^9, 3.811654156293767*^9}, {3.8116545276310062`*^9, 
   3.811654535166437*^9}, {3.8117428237457075`*^9, 3.8117428458557377`*^9}, {
   3.811743320287402*^9, 3.811743321997405*^9}, {3.81183913307277*^9, 
   3.8118391578228054`*^9}, {3.811839292673994*^9, 3.811839355554082*^9}, {
   3.811839431077188*^9, 3.811839431187188*^9}, {3.8118398079697156`*^9, 
   3.811839833199751*^9}, {3.811840751402043*^9, 3.811840776042077*^9}, {
   3.8118408257121468`*^9, 3.8118408257521467`*^9}, 3.8118409107222652`*^9, {
   3.811841173098895*^9, 3.811841206568942*^9}, {3.811841240302992*^9, 
   3.811841271853036*^9}, 3.8118413236331086`*^9, 3.812344237251094*^9, {
   3.812345646961871*^9, 3.8123456633498087`*^9}, {3.8123456940385637`*^9, 
   3.812345749863757*^9}, {3.8131156849770627`*^9, 3.8131156945970764`*^9}, {
   3.8131157798871956`*^9, 3.813115810817239*^9}, {3.813115880567337*^9, 
   3.8131158919173527`*^9}, {3.8132002673799314`*^9, 
   3.8132003197818575`*^9}, {3.8132004982077613`*^9, 3.813200499845853*^9}, {
   3.8132008775546284`*^9, 3.8132010066548047`*^9}, 3.8132010469650574`*^9, {
   3.813201095790788*^9, 3.813201121206187*^9}, {3.813201215360421*^9, 
   3.8132013006341553`*^9}, {3.813201357098297*^9, 3.813201363202634*^9}, {
   3.813202309786787*^9, 3.8132023308179493`*^9}, {3.8132958125596437`*^9, 
   3.813295865231567*^9}, {3.813295943297935*^9, 3.813295961888975*^9}, {
   3.813296081403657*^9, 3.813296152547629*^9}, {3.8132962058816032`*^9, 
   3.813296215933159*^9}, {3.8132962867001085`*^9, 3.813296287830168*^9}, 
   3.8132963833275003`*^9, 3.8132964207126102`*^9, {3.813296844576432*^9, 
   3.813296846489539*^9}, {3.8132971609221096`*^9, 3.813297164313297*^9}, {
   3.813300620415958*^9, 3.813300632588975*^9}, {3.8135534433788733`*^9, 
   3.8135534436988735`*^9}, 3.8135535426000123`*^9, {3.8135561778454123`*^9, 
   3.8135561988646145`*^9}, {3.813558482721132*^9, 3.8135584829961476`*^9}, {
   3.81355943711272*^9, 3.813559437480741*^9}, {3.8135594709526553`*^9, 
   3.8135594953050485`*^9}, {3.8135597973733253`*^9, 3.813559805857811*^9}, 
   3.8139019430415583`*^9, 3.813901980111641*^9, {3.814171145988372*^9, 
   3.8141711465524035`*^9}, {3.844848232024497*^9, 3.844848232474947*^9}, {
   3.844848315419135*^9, 3.844848371392188*^9}, {3.84484840666076*^9, 
   3.8448484118901973`*^9}, {3.8448485971331215`*^9, 
   3.8448486078332195`*^9}, {3.8448487472806187`*^9, 3.844848792002654*^9}, {
   3.8448488591720486`*^9, 3.844848878891443*^9}, {3.8448489448820887`*^9, 
   3.84484894808078*^9}, {3.8448498565766115`*^9, 3.8448500067961626`*^9}, {
   3.8448500466356783`*^9, 3.8448500910096965`*^9}, {3.844850389259141*^9, 
   3.844850396187687*^9}, {3.844850526418844*^9, 3.8448505381149235`*^9}, {
   3.8448506122595434`*^9, 3.844850614198965*^9}, {3.844850818360935*^9, 
   3.844850861164255*^9}, {3.844850906987276*^9, 3.8448509150757627`*^9}, {
   3.844850946196908*^9, 3.844850958912001*^9}, {3.8448509935681114`*^9, 
   3.8448510217712154`*^9}, {3.8448511442744985`*^9, 3.844851144575088*^9}, {
   3.844851291882165*^9, 3.844851306116029*^9}, {3.8448513382115617`*^9, 
   3.844851345599746*^9}, {3.8448513851282086`*^9, 3.844851387843917*^9}, 
   3.8449308719312115`*^9, {3.8449309882872505`*^9, 3.8449309919047403`*^9}, {
   3.8450106857258315`*^9, 3.8450107263606553`*^9}, {3.8450110517147636`*^9, 
   3.845011069654033*^9}, {3.8461302697182207`*^9, 3.846130370295285*^9}, {
   3.84613067954843*^9, 3.8461307189625235`*^9}, {3.846139742236244*^9, 
   3.8461398241176004`*^9}, {3.8462569911665974`*^9, 
   3.8462570068959875`*^9}, {3.8462571974970446`*^9, 3.846257198398964*^9}, {
   3.8608561103661556`*^9, 3.860856112742649*^9}, {3.860856148540577*^9, 
   3.860856156177037*^9}, {3.860856190593668*^9, 3.8608561954761753`*^9}, {
   3.860856251955059*^9, 3.8608562929946146`*^9}, {3.8608563816020823`*^9, 
   3.860856520109243*^9}, {3.860856555721017*^9, 3.8608566259124126`*^9}, {
   3.8608566599202757`*^9, 3.860856671562099*^9}, {3.860856705263324*^9, 
   3.860856708903969*^9}, {3.8610857621659327`*^9, 3.86108576639919*^9}, {
   3.861085802446398*^9, 3.8610858240376167`*^9}, 3.8610859111168137`*^9, {
   3.8610859740505595`*^9, 3.8610860786911726`*^9}, {3.8610861200268946`*^9, 
   3.861086144612587*^9}, {3.8610861928556433`*^9, 3.8610861972743187`*^9}, {
   3.861086227390586*^9, 3.8610862319470577`*^9}, {3.861161335198688*^9, 
   3.8611613428177385`*^9}, {3.8611614054768343`*^9, 3.861161427818837*^9}, {
   3.8611617387682834`*^9, 3.861161745618683*^9}, {3.8611626275427017`*^9, 
   3.861162644831419*^9}, {3.8611629755542192`*^9, 3.861163024055162*^9}, {
   3.8611632024386206`*^9, 3.8611632149925356`*^9}, {3.8611632939961357`*^9, 
   3.861163294512856*^9}, {3.8611634876499696`*^9, 3.861163490017808*^9}, {
   3.8611646007656918`*^9, 3.861164642958883*^9}, {3.8611647434344816`*^9, 
   3.861164774098789*^9}, {3.8738721853005204`*^9, 3.873872195181426*^9}, {
   3.8738723908765535`*^9, 3.873872396141539*^9}, {3.873872599906548*^9, 
   3.8738726240469637`*^9}, {3.873872757912739*^9, 3.873872790751478*^9}, {
   3.8738803024052906`*^9, 3.873880306654028*^9}, {3.873880973897497*^9, 
   3.873880993272869*^9}, {3.873881057336488*^9, 3.873881095361596*^9}, {
   3.874306671759351*^9, 3.8743066787687464`*^9}, {3.8743067457002125`*^9, 
   3.874306784114363*^9}, {3.8743071065373573`*^9, 3.874307138183612*^9}, {
   3.874307181408496*^9, 3.874307225852158*^9}, {3.874307577269801*^9, 
   3.874307647608138*^9}, {3.8743076953921413`*^9, 3.8743077032295046`*^9}, {
   3.8743079969234743`*^9, 3.8743080236399393`*^9}, {3.8743092436037817`*^9, 
   3.874309255284383*^9}, {3.874309298672677*^9, 3.87430931785058*^9}, {
   3.874309352771764*^9, 3.8743093638550076`*^9}, {3.8743094239498873`*^9, 
   3.874309428582249*^9}, {3.8743094670771885`*^9, 3.8743094869072*^9}, {
   3.8743097006595*^9, 3.874309720135279*^9}, 3.874309754021268*^9, 
   3.8743097870005145`*^9, {3.874309826021949*^9, 3.8743098476875734`*^9}, {
   3.8743858065376263`*^9, 3.8743858444037704`*^9}, {3.8743858863565245`*^9, 
   3.8743858871149817`*^9}, {3.8743859228822975`*^9, 3.874385922994087*^9}, 
   3.8743869356254826`*^9, {3.874387012805065*^9, 3.8743870135226297`*^9}, 
   3.87438705523984*^9, {3.874387221748072*^9, 3.874387228610885*^9}, {
   3.874387314674119*^9, 3.874387315824092*^9}, 3.874387572328885*^9, {
   3.874387606685082*^9, 3.8743876070863395`*^9}, {3.874387646500284*^9, 
   3.874387646815897*^9}, {3.8860564941313305`*^9, 
   3.8860565007514243`*^9}},ExpressionUUID->"bedeaedf-90f6-43e2-91d9-\
e93a0d5d07b8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot dataset", "Subsection",
 CellChangeTimes->{{3.8117458793111644`*^9, 
  3.811745880991167*^9}},ExpressionUUID->"c5946410-9ed4-4627-ba9b-\
74fdf7578332"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$save", "=", 
   RowBox[{"Setting", "@", 
    CheckboxBox[True]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$imageSize", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$streamPoints", "=", "30"}], ";"}], 
  RowBox[{"(*", " ", "arrows", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$flowPoints", "=", "300"}], ";"}], 
  RowBox[{"(*", " ", "flowlines", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$majorTrajectoryStyle", "=", 
   RowBox[{"Directive", "[", 
    RowBox[{"Red", ",", 
     RowBox[{"AbsoluteThickness", "@", "2"}], ",", 
     RowBox[{"CapForm", "@", "\"\<Round\>\""}], ",", 
     RowBox[{"JoinForm", "@", "\"\<Round\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$streamColorFunction", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Opacity", "@", ".3"}], ",", 
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<BlueGreenYellow\>\"", "]"}], "[", "#3",
         "]"}]}], "]"}], "&"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$pointStyle", "=", 
    RowBox[{"AbsolutePointSize", "@", "7"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"simplex", "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fx", ",", "fy", ",", "fp", ",", "gridPts", ",", "streamPlot"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Random", " ", "stramline", " ", "arrows"}], ",", " ", 
        RowBox[{"background", " ", "flow", " ", "field"}], ",", " ", 
        RowBox[{"including", " ", "the", " ", "initial", " ", "point"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gridPts", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"Hue", "[", 
               RowBox[{".6", ",", ".5", ",", ".6"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"randomCartesianPoint", "@", "$streamPoints"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ternaryToCartesian", "@", "init"}], "}"}], ",", 
          RowBox[{"randomCartesianPoint", "@", "$flowPoints"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fx", ",", "fy"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Simplify", "/@", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"n", "=", 
                RowBox[{"anPar", "@", "n"}]}], ",", 
               RowBox[{"k", "=", 
                RowBox[{"anPar", "@", "k"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"fLa", "[", 
                RowBox[{"x", ",", "y"}], "]"}], ",", 
               RowBox[{"fTr", "[", 
                RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "]"}]}], "/.", 
          "anPar"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"streamPlot", "=", 
        RowBox[{"StreamPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"{", 
            RowBox[{"fx", ",", "fy"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"Take", "[", 
            RowBox[{"$SimplexLabels", ",", "2"}], "]"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"!", " ", "True"}]}], ",", 
          RowBox[{"Mesh", "->", "False"}], ",", 
          RowBox[{"Ticks", "->", "False"}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "$imageSize"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"RegionFunction", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0", "<", 
              RowBox[{"1", "-", "#1", "-", "#2"}]}], "&"}], ")"}]}], ",", 
          RowBox[{"RegionBoundaryStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"RegionFillingStyle", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "\[Rule]", "White"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StreamColorFunction", "\[Rule]", "$streamColorFunction"}], 
          ",", 
          RowBox[{"StreamColorFunctionScaling", "\[Rule]", "True"}], ",", 
          RowBox[{"StreamStyle", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StreamPoints", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"gridPts", ",", "Automatic", ",", "20"}], "}"}]}], 
          RowBox[{"(*", "Fine", "*)"}], ",", 
          RowBox[{"StreamMarkers", "\[Rule]", "\"\<Line\>\""}], ",", 
          RowBox[{"StreamScale", "\[Rule]", ".1"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"streamPlot", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Arrow", "[", "c_List", "]"}], "\[RuleDelayed]", 
            RowBox[{"Arrow", "[", 
             RowBox[{"cartesianToSimplex", "/@", "c"}], "]"}]}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GraphicsComplex", "[", 
            RowBox[{"c_List", ",", "x___"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"GraphicsComplex", "[", 
            RowBox[{
             RowBox[{"cartesianToSimplex", "/@", "c"}], ",", "x"}], "]"}]}], 
          "}"}]}], ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"GrayLevel", "@", ".5"}], ",", "$SimplexBoundary"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "$SimplexCornerLabels"}], "}"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", "$SimplexPlotRange"}], ",", 
          RowBox[{"Background", "\[Rule]", "White"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "20"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "$imageSize"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "$SimplexAspectRatio"}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "12"}], "]"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", "simplex", ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"$majorTrajectoryStyle", ",", "#1"}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "$SimplexPlotRange"}]}], "]"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"$pointStyle", ",", "Red", ",", 
             RowBox[{"Point", "@", 
              RowBox[{"ternaryToSimplex", "@", "init"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"$pointStyle", ",", "Green", ",", 
             RowBox[{"Point", "@", 
              RowBox[{"ternaryToSimplex", "@", "end"}]}]}], "}"}]}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "$imageSize"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"parName", "\[Equal]", "#2"}], ")"}]}]}], "]"}], "&"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"lineData", ",", "parRange"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"grid", "=", 
  RowBox[{"Grid", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"FileNameTake", "@", "dir"}], ",", "Black", ",", 
            RowBox[{"LineIndent", "\[Rule]", "0"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "$imageSize"}]}], "]"}], ",", 
        "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"file", ",", "Black", ",", 
            RowBox[{"LineIndent", "\[Rule]", "0"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "$imageSize"}]}], "]"}], ",", 
        "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"anPar", ",", "Black", ",", 
          RowBox[{"LineIndent", "\[Rule]", "0"}]}], "]"}], ",", 
        "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Downsample", "[", 
       RowBox[{"all", ",", "5"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    
    RowBox[{"Background", "\[Rule]", "White"}], ",", 
    RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
    RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"$save", ",", 
   RowBox[{"PathButton", "@", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FileNameJoin", "@", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "file"}], "}"}]}], "<>", "\"\<.jpg\>\""}], ",", 
      RowBox[{"Rasterize", "@", "grid"}], ",", "\"\<JPEG\>\"", ",", 
      RowBox[{"RasterSize", "\[Rule]", "3000"}]}], "]"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.795499101833632*^9, 3.7954991115936594`*^9}, {
   3.795501193936863*^9, 3.795501195750866*^9}, {3.795501235298974*^9, 
   3.795501250704012*^9}, {3.7955017450980344`*^9, 3.7955017491780443`*^9}, 
   3.8109847215424776`*^9, {3.8110024131789026`*^9, 3.8110024191789107`*^9}, {
   3.8110025352110734`*^9, 3.811002535421074*^9}, {3.8110026158421865`*^9, 
   3.8110026861052856`*^9}, {3.8110027880494366`*^9, 3.811002799529453*^9}, {
   3.8110028325315013`*^9, 3.81100283869151*^9}, 3.8110031972010775`*^9, {
   3.811044273807397*^9, 3.8110442766084013`*^9}, {3.811045434286044*^9, 
   3.811045435036087*^9}, {3.81165214521474*^9, 3.811652178398638*^9}, {
   3.811652530015749*^9, 3.811652560386486*^9}, {3.811652743518961*^9, 
   3.811652746461129*^9}, {3.811653021369853*^9, 3.811653022049892*^9}, {
   3.8116540159647408`*^9, 3.811654061689356*^9}, {3.8116541206377277`*^9, 
   3.811654122903857*^9}, {3.8116541839763503`*^9, 3.811654205904605*^9}, {
   3.8118387759922705`*^9, 3.8118387893622894`*^9}, {3.8118388637223935`*^9, 
   3.8118390143426046`*^9}, {3.811839367525099*^9, 3.8118393682451*^9}, {
   3.811839674259528*^9, 3.811839684069542*^9}, {3.811839735279614*^9, 
   3.8118397754896703`*^9}, 3.81183981832973*^9, {3.8118406384718847`*^9, 
   3.8118406505319014`*^9}, {3.811840721522001*^9, 3.8118407332320175`*^9}, {
   3.811841380423188*^9, 3.8118413839131927`*^9}, {3.811841421073245*^9, 
   3.8118414265032525`*^9}, {3.8123443703807087`*^9, 3.812344372869851*^9}, {
   3.813116398698062*^9, 3.813116407978075*^9}, {3.813116705148491*^9, 
   3.813116767788579*^9}, {3.8132011295956526`*^9, 3.8132011376331053`*^9}, {
   3.813202025811129*^9, 3.813202073997789*^9}, {3.813202112326918*^9, 
   3.8132021142490234`*^9}, {3.8132022903106947`*^9, 
   3.8132022965370393`*^9}, {3.8132033729296827`*^9, 
   3.8132033994041576`*^9}, {3.8132036578505707`*^9, 
   3.8132036907904124`*^9}, {3.8132961612271185`*^9, 
   3.8132963227370872`*^9}, {3.8132963572710347`*^9, 3.813296361282262*^9}, {
   3.813296463534018*^9, 3.81329646667019*^9}, {3.813296606562105*^9, 
   3.813296632326538*^9}, {3.81329668471649*^9, 3.8132967233296556`*^9}, {
   3.813296861343368*^9, 3.8132969459520864`*^9}, {3.813296979351965*^9, 
   3.813297068125903*^9}, 3.8132971979751773`*^9, {3.81329727612057*^9, 
   3.8132974371665115`*^9}, {3.81329838289235*^9, 3.813298391821846*^9}, {
   3.8132991660558825`*^9, 3.813299230333974*^9}, {3.8132992687840276`*^9, 
   3.8132993323031187`*^9}, {3.813299366513167*^9, 3.813299431163257*^9}, {
   3.8132994869733353`*^9, 3.813299528703394*^9}, {3.8132995732334557`*^9, 
   3.8132996046235*^9}, {3.8132996692235904`*^9, 3.8132997212446632`*^9}, {
   3.813299795444767*^9, 3.81329992576495*^9}, {3.8132999561249924`*^9, 
   3.813300077475162*^9}, {3.813300108745206*^9, 3.813300225957371*^9}, 
   3.813300513975809*^9, {3.813300642038988*^9, 3.8133006833290462`*^9}, {
   3.813300753623147*^9, 3.8133007568131514`*^9}, {3.813553577960062*^9, 
   3.813553720304261*^9}, {3.8135537560443115`*^9, 3.8135539186695414`*^9}, {
   3.813553951909588*^9, 3.8135540050196624`*^9}, 3.8135540445297174`*^9, {
   3.813556258071001*^9, 3.813556258155006*^9}, {3.813556289557802*^9, 
   3.8135562901758375`*^9}, {3.84484917138918*^9, 3.8448491800248475`*^9}, {
   3.8448494092966695`*^9, 3.8448494574606447`*^9}, {3.844849706264885*^9, 
   3.844849717064839*^9}, 3.844849762327182*^9, {3.844849814678935*^9, 
   3.844849814772098*^9}, {3.844930887470471*^9, 3.844930968583619*^9}, {
   3.845010771364913*^9, 3.845010847185177*^9}, {3.8450109859604745`*^9, 
   3.8450110086929655`*^9}, 3.846130432087426*^9, {3.8461304825070686`*^9, 
   3.846130543381918*^9}, {3.846130575445608*^9, 3.846130666500499*^9}, {
   3.8611646573870883`*^9, 3.8611646695240297`*^9}, 3.8611647232654185`*^9, {
   3.861164798322785*^9, 3.861164800835264*^9}, 3.8611711872852516`*^9, 
   3.861172074307914*^9, {3.8612434359508257`*^9, 3.8612434612377553`*^9}, {
   3.873880315256948*^9, 3.8738803378345327`*^9}, {3.8738803841923966`*^9, 
   3.8738804857719655`*^9}, {3.8738806469685335`*^9, 3.873880651013034*^9}, {
   3.8738807065788984`*^9, 3.8738808629782352`*^9}, {3.8738809085814233`*^9, 
   3.873880945814567*^9}, {3.8738810309002953`*^9, 3.873881045586644*^9}, {
   3.874307053755666*^9, 3.8743070538114443`*^9}, {3.8743077418164635`*^9, 
   3.874307778748091*^9}, {3.87430784705446*^9, 3.874307880771758*^9}, {
   3.8743079228772736`*^9, 3.8743079833819985`*^9}, {3.8743080287324977`*^9, 
   3.874308070825072*^9}, {3.874308175911471*^9, 3.8743081782616234`*^9}, {
   3.87430826336553*^9, 3.8743083019299526`*^9}, 3.874308418006976*^9, {
   3.874308451193669*^9, 3.8743084529592175`*^9}, {3.874308489504036*^9, 
   3.8743085258554287`*^9}, 3.87430866561703*^9, {3.8743087362267375`*^9, 
   3.8743087438475013`*^9}, {3.874308823436174*^9, 3.8743088649663076`*^9}, {
   3.8743089003618326`*^9, 3.8743089091120644`*^9}, {3.874308948056838*^9, 
   3.8743089497581835`*^9}, {3.874309687681464*^9, 3.8743096903183775`*^9}, {
   3.8743097620465016`*^9, 3.8743097626954193`*^9}, {3.8743860849852176`*^9, 
   3.8743861128970785`*^9}, {3.8743861545830755`*^9, 3.874386389852641*^9}, {
   3.8743864267553606`*^9, 3.874386430551979*^9}, {3.874386489411337*^9, 
   3.8743865505764647`*^9}, {3.8743866027043877`*^9, 3.874386679200243*^9}, {
   3.874386737490794*^9, 3.874386743160559*^9}, {3.87438679165745*^9, 
   3.874386871728253*^9}, 
   3.8824376346813765`*^9},ExpressionUUID->"692c1314-ff39-4117-96d2-\
e0d811395a42"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot simulated CF with major trajectory (Fig. 4, Row 3)", "Subsection",
 CellChangeTimes->{{3.8139018105161686`*^9, 3.813901811427221*^9}, {
   3.8851164257597013`*^9, 3.8851164367401147`*^9}, {3.8852830805352163`*^9, 
   3.8852830985452986`*^9}, 3.8852836361755652`*^9, {3.8860578768896794`*^9, 
   3.88605787733048*^9}, {3.8860627639053855`*^9, 
   3.8860627826295166`*^9}},ExpressionUUID->"c6ef5b1c-22db-48b4-9e67-\
38c1b870409d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"x", ",", "y", ",", "n", ",", "k", ",", "c", ",", "r"}], "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\221008 Tom \
CF\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$save", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$labelled", "=", 
   RowBox[{"!", "$save"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$imageSize", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$flowPoints", "=", "500"}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "distinct", " ", "flow", " ", "lines"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"$streamPoints", "=", "60"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$streamColorFunction", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"Opacity", "@", ".7"}], ",", 
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<BlueGreenYellow\>\"", "]"}], "[", 
         "#3", "]"}]}], "]"}], "&"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Trajectory", " ", "data"}], " ", "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"$genotypes", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<Lazy\>\"", ",", "\"\<Trusty\>\"", ",", "\"\<Smart\>\""}], 
     "}"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Plot", " ", "the", " ", "trajectory", " ", "of", " ", "these", " ", 
      "strategies"}], ",", " ", 
     RowBox[{"corresponding", " ", "to", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], " ", "simplex", " ", 
      RowBox[{"coordinates", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"$majorTrajectoryStyle", "=", 
    RowBox[{"Directive", "[", 
     RowBox[{
      RowBox[{"Darker", "@", "Red"}], ",", 
      RowBox[{"AbsoluteThickness", "@", "3"}], ",", 
      RowBox[{"CapForm", "@", "\"\<Round\>\""}], ",", 
      RowBox[{"JoinForm", "@", "\"\<Round\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"FileNames", "[", 
     RowBox[{"\"\<*.out\>\"", ",", "dir", ",", "\[Infinity]", ",", 
      RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"par", ",", "fx", ",", "fy", ",", "major", ",", "plot", ",", 
        RowBox[{"gridPts", "=", 
         RowBox[{"randomCartesianPoint", "@", "$flowPoints"}]}], ",", 
        RowBox[{"name", "=", "\"\<SimulatedCF\>\""}], ",", "flowPlot", ",", 
        "streamPlot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"par", "=", 
         RowBox[{"getParameters", "@", "file"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"par", "=", 
        RowBox[{"MapAt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "/", "100."}], "&"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"$DefaultAnalyticParameters", ",", 
            RowBox[{"Association", "@", 
             RowBox[{"readParameterStamp", "@", "#"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Key", "@", "c"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Key", "@", "r"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Key", "@", "c0"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"major", "=", 
        RowBox[{"ReadList", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"Number", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Length", "@", "$GenotypeLabels"}], "+", "1"}], "}"}]}],
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"major", "=", 
        RowBox[{"Line", "@", 
         RowBox[{"First", "@", 
          RowBox[{"trajectory", "[", 
           RowBox[{"major", ",", "$genotypes"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fx", ",", "fy"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Simplify", "@", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"n", "=", 
                RowBox[{"par", "@", "n"}]}], ",", 
               RowBox[{"k", "=", 
                RowBox[{"par", "@", "k"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"fLa", "[", 
                RowBox[{"x", ",", "y"}], "]"}], ",", 
               RowBox[{"fTr", "[", 
                RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "]"}]}], "/.", 
          "par"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"flowPlot", "=", 
        RowBox[{"StreamPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"{", 
            RowBox[{"fx", ",", "fy"}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
           "$SimplexCartesianRegion"}], ",", "\[IndentingNewLine]", 
          RowBox[{"RegionFunction", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0", "<", 
              RowBox[{"1", "-", "#1", "-", "#2"}]}], "&"}], ")"}]}], ",", 
          RowBox[{"RegionBoundaryStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"RegionFillingStyle", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "False"}], ",", 
          RowBox[{"Mesh", "->", "False"}], ",", 
          RowBox[{"FrameTicks", "->", "False"}], ",", 
          RowBox[{"Ticks", "->", "False"}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"$labelled", ",", 
             RowBox[{"Column", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"name", ",", "inDir", ",", "par"}], "}"}], ",", 
               RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
             "None"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Prolog", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FaceForm", "@", "None"}], ",", 
               RowBox[{"EdgeForm", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "@", ".3"}], ",", 
                  RowBox[{"AbsoluteThickness", "@", "3"}], ",", 
                  RowBox[{"CapForm", "@", "\"\<Round\>\""}], ",", 
                  RowBox[{"JoinForm", "@", "\"\<Round\>\""}]}], "}"}]}], ",", 
               "$SimplexPolygon"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"If", "[", 
                RowBox[{"$labelled", ",", "$SimplexCornerLabels", ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"$majorTrajectoryStyle", ",", "major"}], "}"}], "}"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "$imageSize"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"$labelled", ",", "All", ",", "5"}], "]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotRangePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Scaled", "@", "0.05"}], ",", 
             RowBox[{"Scaled", "@", "0.05"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
          RowBox[{"Background", "\[Rule]", "White"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StreamColorFunction", "\[Rule]", "$streamColorFunction"}], 
          ",", 
          RowBox[{"StreamColorFunctionScaling", "\[Rule]", "True"}], ",", 
          RowBox[{"StreamStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"StreamPoints", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"gridPts", ",", "Automatic", ",", "20"}], "}"}]}], 
          RowBox[{"(*", "Fine", "*)"}], ",", 
          RowBox[{"StreamMarkers", "\[Rule]", "\"\<Line\>\""}], ",", 
          RowBox[{"StreamScale", "\[Rule]", ".1"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"streamPlot", "=", 
        RowBox[{"StreamPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"{", 
            RowBox[{"fx", ",", "fy"}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
           "$SimplexCartesianRegion"}], ",", "\[IndentingNewLine]", 
          RowBox[{"RegionFunction", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0", "<", 
              RowBox[{"1", "-", "#1", "-", "#2"}]}], "&"}], ")"}]}], ",", 
          RowBox[{"RegionBoundaryStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"RegionFillingStyle", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Background", "\[Rule]", "White"}], ",", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
          RowBox[{"Frame", "->", "False"}], ",", "\[IndentingNewLine]", 
          RowBox[{"StreamColorFunction", "\[Rule]", "$streamColorFunction"}], 
          ",", 
          RowBox[{"StreamColorFunctionScaling", "\[Rule]", "True"}], ",", 
          RowBox[{"StreamStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"StreamPoints", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"randomCartesianPoint", "@", "$streamPoints"}], ",", 
             "Automatic", ",", "20"}], "}"}]}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"StreamMarkers", "\[Rule]", "Automatic"}], ","}], "*)"}], 
          
          RowBox[{"StreamScale", "\[Rule]", ".1"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plot", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"flowPlot", ",", "streamPlot"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Arrow", "[", "c_List", "]"}], "\[RuleDelayed]", 
            RowBox[{"Arrow", "[", 
             RowBox[{"cartesianToSimplex", "/@", "c"}], "]"}]}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GraphicsComplex", "[", 
            RowBox[{"c_List", ",", "x___"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"GraphicsComplex", "[", 
            RowBox[{
             RowBox[{"cartesianToSimplex", "/@", "c"}], ",", "x"}], "]"}]}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Echo", "@", "plot"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"$save", ",", 
         RowBox[{"Echo", "@", 
          RowBox[{"PathButton", "@", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "@", 
              RowBox[{"{", 
               RowBox[{"dir", ",", 
                RowBox[{"name", "<>", "\"\<_\>\"", "<>", 
                 RowBox[{"FileBaseName", "@", "#"}], "<>", 
                 RowBox[{"If", "[", 
                  RowBox[{
                  "$labelled", ",", "\"\<_labelled\>\"", ",", "\"\<\>\""}], 
                  "]"}], "<>", "\"\<.jpg\>\""}]}], "}"}]}], ",", "plot", ",", 
             "\"\<JPEG\>\"", ",", 
             RowBox[{"ImageResolution", "->", "600"}]}], "]"}]}]}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], "&"}], "/@", "files"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8860579095750813`*^9, 3.8860583167826624`*^9}, {
   3.8860584391142488`*^9, 3.8860586647510633`*^9}, {3.886059154470773*^9, 
   3.8860591607170005`*^9}, {3.886059517602333*^9, 3.886059681211647*^9}, {
   3.886059751003368*^9, 3.886059772675009*^9}, {3.886059825036125*^9, 
   3.8860598394324074`*^9}, {3.886059873848635*^9, 3.886059906702286*^9}, {
   3.8860599473491693`*^9, 3.886060127957289*^9}, {3.886060179770706*^9, 
   3.88606020164948*^9}, {3.8860602419588485`*^9, 3.8860604306786127`*^9}, {
   3.8860604610382614`*^9, 3.886060480339328*^9}, {3.8860605180822983`*^9, 
   3.8860605372820635`*^9}, {3.8860605726233745`*^9, 3.886060582185175*^9}, {
   3.8860606398122463`*^9, 3.8860606696394*^9}, {3.8860607195785027`*^9, 
   3.8860608189357157`*^9}, {3.886060855507861*^9, 3.886060911533479*^9}, {
   3.8860609620454903`*^9, 3.8860610048349504`*^9}, {3.8860611057371516`*^9, 
   3.8860612583044324`*^9}, {3.8860613034721484`*^9, 3.886061322686352*^9}, {
   3.8860613786486096`*^9, 3.8860614419394693`*^9}, 3.8860614851675596`*^9, {
   3.8860615254782*^9, 3.886061527018014*^9}, {3.886061710560956*^9, 
   3.8860617206623187`*^9}, {3.8860617648777227`*^9, 
   3.8860619470667896`*^9}, {3.8860619913791437`*^9, 3.886062096899412*^9}, {
   3.8860621582449627`*^9, 3.8860622479220138`*^9}, {3.886062288913113*^9, 
   3.8860624088730383`*^9}, {3.886062441248863*^9, 3.8860624754134693`*^9}, {
   3.8860625966882205`*^9, 3.8860625971411705`*^9}, {3.886062639642145*^9, 
   3.886062664036418*^9}},
 CellLabel->
  "In[1149]:=",ExpressionUUID->"fb855bb2-7817-4525-b67a-d33be639b4b0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Batched plotting data", "Subsection",
 CellChangeTimes->{{3.8136556567214594`*^9, 3.8136556573314605`*^9}, {
  3.861094313293597*^9, 
  3.861094315593749*^9}},ExpressionUUID->"e76bb5f6-b649-4c7d-b8e7-\
59831f019216"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "n", ",", "k", ",", "c", ",", "r", ",", "b", ",", "d", ",", "c0"}], "]"}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\201206 \
Dec_6_Tests_Tom\\\\Tom_2_Win\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\Dec_18\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\210113\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\210113\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\220506 Tom Fig5 \
spatial\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\201219 \
Article_figure\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "dir", "=", 
    "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\221008 Tom \
CF\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ind", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<Lazy\>\"", ",", "\"\<Trusty\>\"", ",", "\"\<Smart\>\""}], 
     "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Plot", " ", "the", " ", "trajectory", " ", "of", " ", "these", " ", 
     "strategies"}], ",", " ", 
    RowBox[{"corresponding", " ", "to", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], " ", "simplex", " ", 
     RowBox[{"coordinates", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$saveSimplex", "=", 
   RowBox[{"Setting", "@", 
    CheckboxBox[False]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$saveAnimationGif", "=", 
    RowBox[{"Setting", "@", 
     CheckboxBox[False]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flowLines", "=", "200"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"streamLines", "=", "40"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$majorTrajectoryStyle", "=", 
   RowBox[{"Directive", "[", 
    RowBox[{
     RowBox[{"Darker", "@", "Red"}], ",", 
     RowBox[{"AbsoluteThickness", "@", "3"}], ",", 
     RowBox[{"CapForm", "@", "\"\<Round\>\""}], ",", 
     RowBox[{"JoinForm", "@", "\"\<Round\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$streamColorFunction", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Opacity", "@", ".5"}], ",", 
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<BlueGreenYellow\>\"", "]"}], "[", "#3",
         "]"}]}], "]"}], "&"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fileMask", "=", "\"\<*.out\>\""}], 
   RowBox[{"(*", "\"\<*output*.dat\>\"", "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"fileMask", ",", "dir", ",", "\[Infinity]", ",", 
     RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Column", "@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FileNameTake", "@", "#"}], "->", 
      RowBox[{"getParameters", "@", "#"}]}], "&"}], "/@", "files"}], 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.813559812294179*^9, 3.8135602865433044`*^9}, {
   3.813560372703233*^9, 3.8135603745733395`*^9}, 3.8135608741783066`*^9, {
   3.813561035757549*^9, 3.8135610662982955`*^9}, {3.813561125858702*^9, 
   3.8135612693799114`*^9}, 3.8135615596295123`*^9, {3.813561763463171*^9, 
   3.8135617806581545`*^9}, {3.8135619238733463`*^9, 
   3.8135619592703705`*^9}, {3.813561995819461*^9, 3.8135620228650084`*^9}, {
   3.8135621463290696`*^9, 3.8135621589337907`*^9}, {3.8135622967586737`*^9, 
   3.8135623008679085`*^9}, {3.813562332253704*^9, 3.813562371605955*^9}, {
   3.813562656729263*^9, 3.8135626570142794`*^9}, {3.813562755429715*^9, 
   3.8135629658540106`*^9}, {3.813562996914054*^9, 3.8135630008140593`*^9}, {
   3.8135630318741035`*^9, 3.813563035354108*^9}, {3.8135630681741543`*^9, 
   3.813563093344189*^9}, 3.81356332105651*^9, {3.813563488197148*^9, 
   3.8135635187771907`*^9}, {3.813655678931491*^9, 3.813655698661518*^9}, {
   3.813655970842907*^9, 3.8136559719929085`*^9}, {3.8136563693544655`*^9, 
   3.8136563694744654`*^9}, {3.8136564640445976`*^9, 
   3.8136565000646477`*^9}, {3.813901872914623*^9, 3.8139018778429046`*^9}, {
   3.8139019148049793`*^9, 3.813901915546022*^9}, {3.8139020162086687`*^9, 
   3.8139020377938848`*^9}, {3.813902164133004*^9, 3.8139021647250385`*^9}, {
   3.813902585308592*^9, 3.8139027389762278`*^9}, 3.813903414810389*^9, {
   3.813903993152155*^9, 3.8139039967223597`*^9}, {3.813904035438574*^9, 
   3.8139040649942646`*^9}, {3.8139042977068653`*^9, 
   3.8139042993609605`*^9}, {3.813912691291245*^9, 3.8139127011612587`*^9}, {
   3.8139127587393403`*^9, 3.813912773511361*^9}, {3.8140730403461857`*^9, 
   3.814073062496217*^9}, {3.814073374016654*^9, 3.8140733810066633`*^9}, {
   3.8140735109811306`*^9, 3.8140735117811317`*^9}, {3.8140951654007816`*^9, 
   3.814095207660841*^9}, {3.8140952544009066`*^9, 3.814095265460922*^9}, 
   3.8140952996339703`*^9, {3.814095345638049*^9, 3.814095347928052*^9}, {
   3.8140954161381474`*^9, 3.814095418538151*^9}, {3.814095495283259*^9, 
   3.814095497003261*^9}, {3.8141628699551888`*^9, 3.814162901893015*^9}, {
   3.8141629616078196`*^9, 3.814162963217822*^9}, {3.8141633122451077`*^9, 
   3.814163328439034*^9}, 3.8141633617129374`*^9, {3.8141696194420557`*^9, 
   3.814169876130482*^9}, {3.8141699781302423`*^9, 3.814169981205418*^9}, {
   3.8141700151523304`*^9, 3.814170031239237*^9}, 3.814171092878354*^9, {
   3.814171165338478*^9, 3.814171167241581*^9}, {3.8141748515962334`*^9, 
   3.81417489576476*^9}, {3.8141760064352865`*^9, 3.81417601470776*^9}, 
   3.814176665815001*^9, 3.81417828905108*^9, {3.8141787722128115`*^9, 
   3.814178818452876*^9}, {3.8141793981937346`*^9, 3.8141794226137686`*^9}, {
   3.8142455788331814`*^9, 3.8142456166032343`*^9}, {3.814257230611601*^9, 
   3.814257266841652*^9}, 3.8142574679569397`*^9, {3.8142575611670723`*^9, 
   3.814257573277089*^9}, {3.814257692580272*^9, 3.8142576941302743`*^9}, {
   3.8142587940137014`*^9, 3.814258795083703*^9}, {3.814259613379056*^9, 
   3.8142596595791206`*^9}, {3.8142637615889945`*^9, 3.814263763598997*^9}, {
   3.8142638206510773`*^9, 3.8142638230310802`*^9}, {3.814767690883994*^9, 
   3.8147677080549765`*^9}, 3.814768771848051*^9, 3.8147725370299563`*^9, 
   3.814772706679205*^9, {3.8171865706597633`*^9, 3.8171865964682393`*^9}, {
   3.817186833390791*^9, 3.817186836666978*^9}, {3.817186874414137*^9, 
   3.8171868879049087`*^9}, {3.8171869373287354`*^9, 3.81718693740774*^9}, 
   3.8171870837671113`*^9, 3.817187507702376*^9, 3.817187635814704*^9, {
   3.8171883977792854`*^9, 3.817188414849262*^9}, {3.8171889121647067`*^9, 
   3.8171889421804237`*^9}, {3.8171889966885414`*^9, 
   3.8171890315345345`*^9}, {3.8171893052441893`*^9, 
   3.8171893289685464`*^9}, {3.8171893608273687`*^9, 3.817189386606843*^9}, 
   3.8171894202287664`*^9, {3.817189476504985*^9, 3.8171894781000767`*^9}, {
   3.8172026657675037`*^9, 3.8172026719975123`*^9}, {3.817202905014841*^9, 
   3.817202923064866*^9}, {3.8172030870600977`*^9, 3.8172030899301023`*^9}, {
   3.8172031311001596`*^9, 3.817203155690194*^9}, {3.817203219964285*^9, 
   3.817203263484346*^9}, {3.817203372057499*^9, 3.817203379417509*^9}, {
   3.8172034960576725`*^9, 3.8172034963176727`*^9}, {3.817203561517764*^9, 
   3.8172035691077747`*^9}, 3.817203601089904*^9, {3.8172826906124973`*^9, 
   3.8172826964225054`*^9}, {3.8172828841148267`*^9, 
   3.8172828871648307`*^9}, {3.817283002888995*^9, 3.817283052569065*^9}, 
   3.817283121239161*^9, 3.8172832286393113`*^9, {3.817283279019382*^9, 
   3.8172833078104224`*^9}, {3.8172836713843737`*^9, 
   3.8172838369186106`*^9}, {3.8172838781186686`*^9, 
   3.8172838838386765`*^9}, {3.817283945352765*^9, 3.8172839806451545`*^9}, {
   3.8172840147752028`*^9, 3.8172840156852036`*^9}, 3.817284065477277*^9, {
   3.8172841583614388`*^9, 3.8172841631114454`*^9}, {3.8172843563317537`*^9, 
   3.817284380361788*^9}, {3.8173740493688126`*^9, 3.8173741913190117`*^9}, {
   3.8173742575091047`*^9, 3.8173743676892586`*^9}, {3.8173746745196877`*^9, 
   3.8173747754698296`*^9}, {3.8173748521499367`*^9, 3.817374931430048*^9}, {
   3.817374973830107*^9, 3.817374975010109*^9}, {3.8173751098702974`*^9, 
   3.817375151850356*^9}, {3.8173752144104443`*^9, 3.817375215480446*^9}, 
   3.817375263500513*^9, {3.8173753079705753`*^9, 3.8173753089905767`*^9}, 
   3.817375340760621*^9, {3.817375385820684*^9, 3.8173754662207966`*^9}, {
   3.81737549703084*^9, 3.8173754979408407`*^9}, {3.8173756379490433`*^9, 
   3.8173756407990475`*^9}, {3.8173756915171432`*^9, 
   3.8173757262071915`*^9}, {3.817375843569376*^9, 3.8173758717494154`*^9}, 
   3.81737591070947*^9, {3.817375956861539*^9, 3.817376018811626*^9}, {
   3.8173760588916817`*^9, 3.817376162861828*^9}, {3.8173762027018833`*^9, 
   3.8173762343419275`*^9}, {3.8173762734919825`*^9, 
   3.8173762791119905`*^9}, {3.8173763091820326`*^9, 3.817376329482061*^9}, {
   3.81737645103226*^9, 3.8173764561922665`*^9}, {3.817376786078109*^9, 
   3.8173768004481287`*^9}, {3.817376861688229*^9, 3.8173769840984006`*^9}, {
   3.817377021498453*^9, 3.817377029948465*^9}, 3.817377095020567*^9, {
   3.817547773797*^9, 3.817547803347041*^9}, {3.8175478382470903`*^9, 
   3.817547840497093*^9}, {3.8176323302717566`*^9, 3.8176323603817987`*^9}, {
   3.817632433095911*^9, 3.817632495395998*^9}, {3.8176328727267094`*^9, 
   3.817632896656743*^9}, {3.817633176977135*^9, 3.8176331810971413`*^9}, {
   3.8176332206771965`*^9, 3.8176332871672897`*^9}, {3.81763335732146*^9, 
   3.817633363561469*^9}, {3.8176334328115654`*^9, 3.817633503201664*^9}, {
   3.817633589213786*^9, 3.8176336302458444`*^9}, {3.817633743704013*^9, 
   3.817633775574058*^9}, {3.817633916246257*^9, 3.817633922868267*^9}, {
   3.817634147140582*^9, 3.8176341472505827`*^9}, {3.817634191180644*^9, 
   3.817634220580685*^9}, {3.817634354623157*^9, 3.8176345333334074`*^9}, {
   3.817634648283568*^9, 3.8176346492235694`*^9}, {3.8176346978836374`*^9, 
   3.8176347875537634`*^9}, {3.8176348533238554`*^9, 
   3.8176348638238697`*^9}, {3.8176349013159237`*^9, 3.8176349169759455`*^9}, 
   3.8176349946241007`*^9, {3.8176350355291643`*^9, 3.8176350430091743`*^9}, {
   3.8176350883052397`*^9, 3.8176350996152554`*^9}, {3.8176351566523495`*^9, 
   3.81763515671235*^9}, {3.8176352855845337`*^9, 3.8176352856545343`*^9}, {
   3.8176353803346663`*^9, 3.817635406464703*^9}, {3.8176354794758053`*^9, 
   3.8176354798558064`*^9}, {3.8176355721879373`*^9, 3.817635585677956*^9}, {
   3.817635810182273*^9, 3.817635830532301*^9}, {3.817635879684371*^9, 
   3.8176358801343718`*^9}, {3.81763593412845*^9, 3.817635935538452*^9}, {
   3.819525327621194*^9, 3.8195253358136625`*^9}, {3.8195254577996397`*^9, 
   3.819525481017968*^9}, {3.81952560518307*^9, 3.8195256177997913`*^9}, {
   3.819525665066495*^9, 3.819525665130499*^9}, {3.8195257693264585`*^9, 
   3.819525772595645*^9}, {3.8195259201750865`*^9, 3.8195259218061795`*^9}, {
   3.8610916826748796`*^9, 3.8610916847374086`*^9}, {3.8610917265125637`*^9, 
   3.861091740009327*^9}, {3.861091779976717*^9, 3.8610917975790586`*^9}, {
   3.861091831301392*^9, 3.861091854766228*^9}, {3.861091906622859*^9, 
   3.8610919194297595`*^9}, 3.8610919685020328`*^9, {3.861092083191675*^9, 
   3.861092087847752*^9}, {3.8610928059007034`*^9, 3.8610928147613297`*^9}, {
   3.8610928535796804`*^9, 3.861092874970023*^9}, {3.861092940057573*^9, 
   3.861092940264887*^9}, {3.861093120225546*^9, 3.8610931383438797`*^9}, {
   3.874308921162613*^9, 3.874308924267029*^9}, 3.8860565903582735`*^9, {
   3.8860569141996098`*^9, 3.8860569618885307`*^9}, {3.8860569957524395`*^9, 
   3.886057002817507*^9}, {3.886057394679531*^9, 3.8860574374554615`*^9}},
 CellLabel->
  "In[414]:=",ExpressionUUID->"66b0c4f3-1594-4b0f-994e-7af228c5fe22"],

Cell[BoxData[{
 RowBox[{"Dynamic", "@", 
  RowBox[{"FileNameTake", "@", "file"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "par", ",", "data", ",", "m", ",", "total", ",", "init", ",", "end", 
       ",", "lineData", ",", "simplex", ",", "plot", ",", "img", ",", "min", 
       ",", "max"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"par", "=", 
       RowBox[{"getParameters", "@", "file"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"ReadList", "[", 
        RowBox[{"file", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"Number", ",", 
           RowBox[{"{", "col", "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "total", "}"}], "=", 
       RowBox[{"Union", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "@*", "Rest"}], "/@", "data"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"init", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Rest", "@", 
           RowBox[{"data", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"ind", "/.", "posInd"}], "]"}], "]"}], "]"}], "/", 
        RowBox[{"N", "@", "total"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"end", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Rest", "@", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"ind", "/.", "posInd"}], "]"}], "]"}], "]"}], "/", 
        RowBox[{"N", "@", "total"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Echo", "@", 
       RowBox[{"Column", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FileNameTake", "[", 
           RowBox[{"file", ",", 
            RowBox[{"-", "2"}]}], "]"}], ",", "par", ",", 
          RowBox[{"Length", "@", "data"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lineData", "=", 
       RowBox[{"trajectory", "[", 
        RowBox[{"data", ",", "ind", ",", "par"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"min", ",", "max"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"simplex", "=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "fx", ",", "fy", ",", "fp", ",", "gridPts", ",", "flowPlot", ",", 
           "streamPlot"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"gridPts", "=", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"NOTE", ":", " ", 
              RowBox[{"Random", " ", "trajectories"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", "#", 
                RowBox[{"(*", 
                 RowBox[{",", 
                  RowBox[{"Hue", "[", 
                   RowBox[{".6", ",", ".5", ",", ".6"}], "]"}]}], "*)"}], 
                "}"}], "&"}], "/@", 
              RowBox[{"randomCartesianPoint", "@", "streamLines"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"NOTE", ":", " ", 
               RowBox[{
               "Trajectory", " ", "through", " ", "the", " ", "initial", " ", 
                "point", " ", "of", " ", "the", " ", "simulation"}]}], " ", 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ternaryToCartesian", "@", "init"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"AbsoluteThickness", "@", "2.5"}], ",", 
                   RowBox[{"Arrowheads", "@", "1.5"}], ",", "Purple"}], 
                  "*)"}], 
                 RowBox[{"Hue", "[", 
                  RowBox[{".6", ",", ".5", ",", ".6"}], "]"}], "]"}]}], "}"}],
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"gridPts", "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"randomCartesianPoint", "@", "streamLines"}], ",", 
             RowBox[{"ternaryToCartesian", "@", "init"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"fx", ",", "fy"}], "}"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Simplify", "/@", 
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"n", "=", 
                   RowBox[{"par", "@", "n"}]}], ",", 
                  RowBox[{"k", "=", 
                   RowBox[{"par", "@", "k"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"fLa", "[", 
                   RowBox[{"x", ",", "y"}], "]"}], ",", 
                  RowBox[{"fTr", "[", 
                   RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "]"}]}], "/.", 
             "par"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"flowPlot", "=", 
           RowBox[{"StreamPlot", "[", 
            RowBox[{
             RowBox[{"Evaluate", "@", 
              RowBox[{"{", 
               RowBox[{"fx", ",", "fy"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"RegionFunction", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"0", "<", 
                 RowBox[{"1", "-", "#1", "-", "#2"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"RegionBoundaryStyle", "\[Rule]", "None"}], ",", 
             RowBox[{"RegionFillingStyle", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Background", "\[Rule]", "White"}], ",", 
             RowBox[{"Frame", "\[Rule]", "False"}], ",", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
             RowBox[{"StreamPoints", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"randomCartesianPoint", "@", "flowLines"}], ",", 
                "Automatic", ",", "20"}], "}"}]}], 
             RowBox[{"(*", "Fine", "*)"}], ",", 
             RowBox[{"StreamScale", "\[Rule]", ".1"}], ",", 
             RowBox[{"StreamMarkers", "\[Rule]", "\"\<Line\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StreamStyle", "\[Rule]", 
              RowBox[{"GrayLevel", "[", ".75", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"StreamColorFunction", "\[Rule]", "None"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}], "=", 
           RowBox[{"MinMax", "@", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Norm", "@", 
                RowBox[{"Evaluate", "@", 
                 RowBox[{"{", 
                  RowBox[{"fx", ",", "fy"}], "}"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "1", ",", ".05"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", "0", ",", "1", ",", ".05"}], "}"}]}], 
              "]"}]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"streamPlot", "=", 
           RowBox[{"StreamPlot", "[", 
            RowBox[{
             RowBox[{"Evaluate", "@", 
              RowBox[{"{", 
               RowBox[{"fx", ",", "fy"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"Take", "[", 
               RowBox[{"$SimplexLabels", ",", "2"}], "]"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"RegionFunction", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"0", "<", 
                 RowBox[{"1", "-", "#1", "-", "#2"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"RegionBoundaryStyle", "\[Rule]", "None"}], ",", 
             RowBox[{"RegionFillingStyle", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Background", "\[Rule]", "White"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"AbsolutePointSize", "@", "6"}], ",", "Red", ",", 
                RowBox[{"Point", "@", 
                 RowBox[{"ternaryToCartesian", "@", "init"}]}]}], "}"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"StreamPoints", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"gridPts", ",", "Automatic", ",", "20"}], "}"}]}], 
             RowBox[{"(*", "Fine", "*)"}], ",", 
             RowBox[{"StreamScale", "\[Rule]", ".1"}], 
             RowBox[{"(*", 
              RowBox[{",", 
               RowBox[{"StreamMarkers", "\[Rule]", "\"\<Line\>\""}]}], "*)"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"StreamStyle", "\[Rule]", 
                RowBox[{"GrayLevel", "[", ".75", "]"}]}], ","}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
             "StreamColorFunction", "\[Rule]", "$streamColorFunction"}], ",", 
             
             RowBox[{"StreamColorFunctionScaling", "\[Rule]", "True"}], ",", 
             RowBox[{"StreamStyle", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "@", 
             RowBox[{"StreamDensityPlot", "[", 
              RowBox[{
               RowBox[{"Evaluate", "@", 
                RowBox[{"{", 
                 RowBox[{"fx", ",", "fy"}], "}"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"Take", "[", 
                 RowBox[{"$SimplexLabels", ",", "2"}], "]"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               RowBox[{"RegionFunction", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0", "<", 
                   RowBox[{"1", "-", "#1", "-", "#2"}]}], "&"}], ")"}]}], ",", 
               RowBox[{"RegionBoundaryStyle", "\[Rule]", "None"}], ",", 
               RowBox[{"RegionFillingStyle", "\[Rule]", "None"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Background", "\[Rule]", "White"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Epilog", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"AbsolutePointSize", "@", "6"}], ",", "Red", ",", 
                  RowBox[{"Point", "@", 
                   RowBox[{"ternaryToCartesian", "@", "init"}]}]}], "}"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"StreamPoints", "\[Rule]", 
                RowBox[{"(*", 
                 RowBox[{"{", 
                  RowBox[{"gridPts", ",", "Automatic", ",", "20"}], "}"}], 
                 "*)"}], "Fine"}], ",", 
               RowBox[{"StreamScale", "\[Rule]", ".1"}], 
               RowBox[{"(*", 
                RowBox[{",", 
                 RowBox[{"StreamMarkers", "\[Rule]", "\"\<Line\>\""}]}], 
                "*)"}], ",", "\[IndentingNewLine]", 
               RowBox[{"StreamStyle", "\[Rule]", "White"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"StreamColorFunction", "\[Rule]", "None"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ColorFunction", "\[Rule]", "$streamColorFunction"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], 
              "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"GrayLevel", "@", ".3"}], ",", "$SimplexBoundary"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", "$SimplexPlotRange"}], ",", 
              RowBox[{"Background", "\[Rule]", "White"}], ",", 
              RowBox[{"ImagePadding", "\[Rule]", "25"}], ",", 
              RowBox[{"AspectRatio", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Sqrt", "@", "3"}], "/", "2"}], ")"}]}], ",", 
              RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"FileNameTake", "[", 
                    RowBox[{"file", ",", 
                    RowBox[{"-", "2"}]}], "]"}], ",", "par"}], "}"}], ",", 
                 RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}]}], "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"flowPlot", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"GraphicsComplex", "[", 
                RowBox[{"c_List", ",", "x___"}], "]"}], "\[RuleDelayed]", 
               RowBox[{"GraphicsComplex", "[", 
                RowBox[{
                 RowBox[{"cartesianToSimplex", "/@", "c"}], ",", "x"}], 
                "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"streamPlot", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Arrow", "[", "c_List", "]"}], "\[RuleDelayed]", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"cartesianToSimplex", "/@", "c"}], "]"}]}], "}"}]}], 
             "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"GraphicsComplex", "[", 
                RowBox[{"c_List", ",", "x___"}], "]"}], "\[RuleDelayed]", 
               RowBox[{"GraphicsComplex", "[", 
                RowBox[{
                 RowBox[{"cartesianToSimplex", "/@", "c"}], ",", "x"}], 
                "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"$majorTrajectoryStyle", ",", "lineData"}], "}"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"AbsolutePointSize", "@", "8"}], ",", "Red", ",", 
                 RowBox[{"Point", "@", 
                  RowBox[{"ternaryToSimplex", "@", "init"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"AbsolutePointSize", "@", "8"}], ",", "Green", ",", 
                 RowBox[{"Point", "@", 
                  RowBox[{"ternaryToSimplex", "@", "end"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Black", ",", "$SimplexCornerLabels"}], "}"}]}], 
              "\[IndentingNewLine]", "}"}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Show", "[", "simplex", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"BarLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"$streamColorFunction", ",", 
                RowBox[{"{", 
                 RowBox[{"min", ",", "max"}], "}"}]}], "}"}], ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", "14"}], "]"}]}], ",", 
              RowBox[{"ColorFunctionScaling", "\[Rule]", "True"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]}], "}"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Background", "\[Rule]", "White"}], ",", 
         RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"img", "=", 
       RowBox[{"Rasterize", "@", "plot"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Echo", "@", "img"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"$saveSimplex", ",", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"file", "<>", "\"\<.jpg\>\""}], ",", "img", ",", 
          "\"\<JPEG\>\"", ",", 
          RowBox[{"RasterSize", "\[Rule]", "3000"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"NOTE", ":", " ", 
        RowBox[{"Animate", " ", "trajectory"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"$saveAnimationGif", ",", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ds", "=", "100"}], ",", "pts", ",", "list"}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pts", "=", 
            RowBox[{"Downsample", "[", 
             RowBox[{
              RowBox[{"First", "@", "lineData"}], ",", 
              RowBox[{"{", 
               RowBox[{"ds", ",", "1"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"list", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Gray", ",", "$SimplexBoundary"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Gray", ",", 
                    RowBox[{"Line", "@", 
                    RowBox[{"Take", "[", 
                    RowBox[{"pts", ",", "i"}], "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Red", ",", 
                    RowBox[{"AbsolutePointSize", "@", "8"}], ",", 
                    RowBox[{"Point", "@", 
                    RowBox[{"pts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Background", "\[Rule]", "White"}], ",", 
                RowBox[{"Frame", "\[Rule]", "All"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Sqrt", "@", "3"}], "/", "2"}]}], "}"}]}], 
                  "}"}]}], ",", 
                RowBox[{"ImagePadding", "\[Rule]", "5"}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<T = \>\"", ",", 
                    RowBox[{"i", "*", "ds"}]}], "}"}]}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "@", "pts"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Print", "@", 
             RowBox[{"ListAnimate", "@", "list"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"file", "<>", "\"\<.gif\>\""}], ",", "list", ",", 
             "\"\<GIF\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"file", ",", 
     RowBox[{"Take", "[", 
      RowBox[{"files", ",", 
       RowBox[{"(*", 
        RowBox[{"{", "1", "}"}], "*)"}], "All"}], "]"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.813559812294179*^9, 3.8135602865433044`*^9}, {
   3.813560372703233*^9, 3.8135603745733395`*^9}, 3.8135608741783066`*^9, {
   3.813561035757549*^9, 3.8135610662982955`*^9}, {3.813561125858702*^9, 
   3.8135612693799114`*^9}, 3.8135615596295123`*^9, {3.813561763463171*^9, 
   3.8135617806581545`*^9}, {3.8135619238733463`*^9, 
   3.8135619592703705`*^9}, {3.813561995819461*^9, 3.8135620228650084`*^9}, {
   3.8135621463290696`*^9, 3.8135621589337907`*^9}, {3.8135622967586737`*^9, 
   3.8135623008679085`*^9}, {3.813562332253704*^9, 3.813562371605955*^9}, {
   3.813562656729263*^9, 3.8135626570142794`*^9}, {3.813562755429715*^9, 
   3.8135629658540106`*^9}, {3.813562996914054*^9, 3.8135630008140593`*^9}, {
   3.8135630318741035`*^9, 3.813563035354108*^9}, {3.8135630681741543`*^9, 
   3.813563093344189*^9}, 3.81356332105651*^9, {3.813563488197148*^9, 
   3.8135635187771907`*^9}, {3.813655678931491*^9, 3.813655698661518*^9}, {
   3.813655970842907*^9, 3.8136559719929085`*^9}, {3.8136563693544655`*^9, 
   3.8136563694744654`*^9}, {3.8136564640445976`*^9, 
   3.8136565000646477`*^9}, {3.813901872914623*^9, 3.8139018778429046`*^9}, {
   3.8139019148049793`*^9, 3.813901915546022*^9}, {3.8139020162086687`*^9, 
   3.8139020377938848`*^9}, {3.813902164133004*^9, 3.8139021647250385`*^9}, {
   3.813902585308592*^9, 3.8139027389762278`*^9}, 3.813903414810389*^9, {
   3.813903993152155*^9, 3.8139039967223597`*^9}, {3.813904035438574*^9, 
   3.8139040649942646`*^9}, {3.8139042977068653`*^9, 
   3.8139042993609605`*^9}, {3.813912691291245*^9, 3.8139127011612587`*^9}, {
   3.8139127587393403`*^9, 3.813912773511361*^9}, {3.8140730403461857`*^9, 
   3.814073062496217*^9}, {3.814073374016654*^9, 3.8140733810066633`*^9}, {
   3.8140735109811306`*^9, 3.8140735117811317`*^9}, {3.8140951654007816`*^9, 
   3.814095207660841*^9}, {3.8140952544009066`*^9, 3.814095265460922*^9}, 
   3.8140952996339703`*^9, {3.814095345638049*^9, 3.814095347928052*^9}, {
   3.8140954161381474`*^9, 3.814095418538151*^9}, {3.814095495283259*^9, 
   3.814095497003261*^9}, {3.8141628699551888`*^9, 3.814162901893015*^9}, {
   3.8141629616078196`*^9, 3.814162963217822*^9}, {3.8141633122451077`*^9, 
   3.814163328439034*^9}, 3.8141633617129374`*^9, {3.8141696194420557`*^9, 
   3.814169876130482*^9}, {3.8141699781302423`*^9, 3.814169981205418*^9}, {
   3.8141700151523304`*^9, 3.814170031239237*^9}, 3.814171092878354*^9, {
   3.814171165338478*^9, 3.814171167241581*^9}, {3.8141748515962334`*^9, 
   3.81417489576476*^9}, {3.8141760064352865`*^9, 3.81417601470776*^9}, 
   3.814176665815001*^9, 3.81417828905108*^9, {3.8141787722128115`*^9, 
   3.814178818452876*^9}, {3.8141793981937346`*^9, 3.8141794226137686`*^9}, {
   3.8142455788331814`*^9, 3.8142456166032343`*^9}, {3.814257230611601*^9, 
   3.814257266841652*^9}, 3.8142574679569397`*^9, {3.8142575611670723`*^9, 
   3.814257573277089*^9}, {3.814257692580272*^9, 3.8142576941302743`*^9}, {
   3.8142587940137014`*^9, 3.814258795083703*^9}, {3.814259613379056*^9, 
   3.8142596595791206`*^9}, {3.8142637615889945`*^9, 3.814263763598997*^9}, {
   3.8142638206510773`*^9, 3.8142638230310802`*^9}, {3.814767690883994*^9, 
   3.8147677080549765`*^9}, 3.814768771848051*^9, 3.8147725370299563`*^9, 
   3.814772706679205*^9, {3.8171865706597633`*^9, 3.8171865964682393`*^9}, {
   3.817186833390791*^9, 3.817186836666978*^9}, {3.817186874414137*^9, 
   3.8171868879049087`*^9}, {3.8171869373287354`*^9, 3.81718693740774*^9}, 
   3.8171870837671113`*^9, 3.817187507702376*^9, 3.817187635814704*^9, {
   3.8171883977792854`*^9, 3.817188414849262*^9}, {3.8171889121647067`*^9, 
   3.8171889421804237`*^9}, {3.8171889966885414`*^9, 
   3.8171890315345345`*^9}, {3.8171893052441893`*^9, 
   3.8171893289685464`*^9}, {3.8171893608273687`*^9, 3.817189386606843*^9}, 
   3.8171894202287664`*^9, {3.817189476504985*^9, 3.8171894781000767`*^9}, {
   3.8172026657675037`*^9, 3.8172026719975123`*^9}, {3.817202905014841*^9, 
   3.817202923064866*^9}, {3.8172030870600977`*^9, 3.8172030899301023`*^9}, {
   3.8172031311001596`*^9, 3.817203155690194*^9}, {3.817203219964285*^9, 
   3.817203263484346*^9}, {3.817203372057499*^9, 3.817203379417509*^9}, {
   3.8172034960576725`*^9, 3.8172034963176727`*^9}, {3.817203561517764*^9, 
   3.8172035691077747`*^9}, 3.817203601089904*^9, {3.8172826906124973`*^9, 
   3.8172826964225054`*^9}, {3.8172828841148267`*^9, 
   3.8172828871648307`*^9}, {3.817283002888995*^9, 3.817283052569065*^9}, 
   3.817283121239161*^9, 3.8172832286393113`*^9, {3.817283279019382*^9, 
   3.8172833078104224`*^9}, {3.8172836713843737`*^9, 
   3.8172838369186106`*^9}, {3.8172838781186686`*^9, 
   3.8172838838386765`*^9}, {3.817283945352765*^9, 3.8172839806451545`*^9}, {
   3.8172840147752028`*^9, 3.8172840156852036`*^9}, 3.817284065477277*^9, {
   3.8172841583614388`*^9, 3.8172841631114454`*^9}, {3.8172843563317537`*^9, 
   3.817284380361788*^9}, {3.8173740493688126`*^9, 3.8173741913190117`*^9}, {
   3.8173742575091047`*^9, 3.8173743676892586`*^9}, {3.8173746745196877`*^9, 
   3.8173747754698296`*^9}, {3.8173748521499367`*^9, 3.817374931430048*^9}, {
   3.817374973830107*^9, 3.817374975010109*^9}, {3.8173751098702974`*^9, 
   3.817375151850356*^9}, {3.8173752144104443`*^9, 3.817375215480446*^9}, 
   3.817375263500513*^9, {3.8173753079705753`*^9, 3.8173753089905767`*^9}, 
   3.817375340760621*^9, {3.817375385820684*^9, 3.8173754662207966`*^9}, {
   3.81737549703084*^9, 3.8173754979408407`*^9}, {3.8173756379490433`*^9, 
   3.8173756407990475`*^9}, {3.8173756915171432`*^9, 
   3.8173757262071915`*^9}, {3.817375843569376*^9, 3.8173758717494154`*^9}, 
   3.81737591070947*^9, {3.817375956861539*^9, 3.817376018811626*^9}, {
   3.8173760588916817`*^9, 3.817376162861828*^9}, {3.8173762027018833`*^9, 
   3.8173762343419275`*^9}, {3.8173762734919825`*^9, 
   3.8173762791119905`*^9}, {3.8173763091820326`*^9, 3.817376329482061*^9}, {
   3.81737645103226*^9, 3.8173764561922665`*^9}, {3.817376786078109*^9, 
   3.8173768004481287`*^9}, {3.817376861688229*^9, 3.8173769840984006`*^9}, {
   3.817377021498453*^9, 3.817377029948465*^9}, 3.817377095020567*^9, {
   3.817547773797*^9, 3.817547803347041*^9}, {3.8175478382470903`*^9, 
   3.817547840497093*^9}, {3.8176323302717566`*^9, 3.8176323603817987`*^9}, {
   3.817632433095911*^9, 3.817632495395998*^9}, {3.8176328727267094`*^9, 
   3.817632896656743*^9}, {3.817633176977135*^9, 3.8176331810971413`*^9}, {
   3.8176332206771965`*^9, 3.8176332871672897`*^9}, {3.81763335732146*^9, 
   3.817633363561469*^9}, {3.8176334328115654`*^9, 3.817633503201664*^9}, {
   3.817633589213786*^9, 3.8176336302458444`*^9}, {3.817633743704013*^9, 
   3.817633775574058*^9}, {3.817633916246257*^9, 3.817633922868267*^9}, {
   3.817634147140582*^9, 3.8176341472505827`*^9}, {3.817634191180644*^9, 
   3.817634220580685*^9}, {3.817634354623157*^9, 3.8176345333334074`*^9}, {
   3.817634648283568*^9, 3.8176346492235694`*^9}, {3.8176346978836374`*^9, 
   3.8176347875537634`*^9}, {3.8176348533238554`*^9, 
   3.8176348638238697`*^9}, {3.8176349013159237`*^9, 3.8176349169759455`*^9}, 
   3.8176349946241007`*^9, {3.8176350355291643`*^9, 3.8176350430091743`*^9}, {
   3.8176350883052397`*^9, 3.8176350996152554`*^9}, {3.8176351566523495`*^9, 
   3.81763515671235*^9}, {3.8176352855845337`*^9, 3.8176352856545343`*^9}, {
   3.8176353803346663`*^9, 3.817635406464703*^9}, {3.8176354794758053`*^9, 
   3.8176354798558064`*^9}, {3.8176355721879373`*^9, 3.817635585677956*^9}, {
   3.817635810182273*^9, 3.817635830532301*^9}, {3.817635879684371*^9, 
   3.8176358801343718`*^9}, {3.81763593412845*^9, 3.817635935538452*^9}, {
   3.819525327621194*^9, 3.8195253358136625`*^9}, {3.8195254577996397`*^9, 
   3.819525481017968*^9}, {3.81952560518307*^9, 3.8195256177997913`*^9}, {
   3.819525665066495*^9, 3.819525665130499*^9}, {3.8195257693264585`*^9, 
   3.819525772595645*^9}, {3.8195259201750865`*^9, 3.8195259218061795`*^9}, {
   3.8610916826748796`*^9, 3.8610916847374086`*^9}, {3.8610917265125637`*^9, 
   3.861091740009327*^9}, {3.861091779976717*^9, 3.8610917975790586`*^9}, {
   3.861091831301392*^9, 3.861091854766228*^9}, {3.861091906622859*^9, 
   3.8610919194297595`*^9}, 3.8610919685020328`*^9, 3.861092083191675*^9, {
   3.8610928883602095`*^9, 3.861092894625721*^9}, {3.8610929911805305`*^9, 
   3.8610929932167296`*^9}, {3.8610931417666893`*^9, 3.86109314201383*^9}, {
   3.861164724237626*^9, 3.861164725140597*^9}, 3.8611648180951815`*^9, {
   3.8611711881410837`*^9, 3.8611711891129527`*^9}, 3.8611720842523117`*^9, {
   3.861243437127819*^9, 3.8612434627547445`*^9}, {3.874308931695631*^9, 
   3.874308985131976*^9}, {3.8743090547232533`*^9, 3.8743090909538684`*^9}, 
   3.8824376400196476`*^9},
 CellLabel->
  "In[394]:=",ExpressionUUID->"0a142bf8-ca68-4079-bda9-45955e8b2678"]
}, Closed]],

Cell[CellGroupData[{

Cell["Run model and plot data", "Subsection",
 CellChangeTimes->{{3.8613363895846276`*^9, 3.8613363922538757`*^9}, {
  3.8825233463184404`*^9, 
  3.882523348323627*^9}},ExpressionUUID->"da5d2469-f2c6-4011-8ffa-\
cb07ccedc166"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"par", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<GenerationNumber\>\"", "->", "100"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Cost\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "30"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<BaseMetabolicCost\>\"", "->", "100"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<QSThreshold\>\"", "->", "3"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<CooperationBenefit\>\"", "->", "0.5"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<GridSize\>\"", "->", "300"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<RandomSeed\>\"", "->", "123"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<InitialFrequency\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", 
           ",", "0"}], "}"}]}]}], " ", "\[IndentingNewLine]", "|>"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"$StochasticParameterSet", "@", "\"\<B\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{"\"\<DiffusionStep\>\"", "->", "0"}], "|>"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DatasetForm", "@", "par"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dir", "=", 
   "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\\\\230111 Fig2 Row2 B \
no diff\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DatasetForm", "@", 
   RowBox[{"(", 
    RowBox[{"run", "=", 
     RowBox[{"runModel", "[", 
      RowBox[{"dir", ",", "par", ",", 
       RowBox[{"\"\<Verbose\>\"", "->", "True"}]}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"major", "=", 
    RowBox[{"readModelData", "@", "run"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GrayLevel", "@", ".5"}], ",", "$SimplexBoundary"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Black", ",", "$SimplexCornerLabels"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"AbsoluteThickness", "@", "2"}], ",", "major"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "$SimplexPlotRange"}], ",", 
     RowBox[{"Background", "\[Rule]", "White"}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", "20"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "$SimplexAspectRatio"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "->", 
      RowBox[{"Column", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FileNameTake", "@", "dir"}], ",", 
          RowBox[{"Normal", "@", "par"}]}], "}"}]}]}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{"dir", ",", 
      RowBox[{
       RowBox[{"FileNameTake", "@", "dir"}], "<>", "\"\<.jpg\>\""}]}], 
     "}"}]}], ",", "plot", ",", "\"\<JPEG\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.8613364393863883`*^9, 3.8613364556887445`*^9}, {
   3.8613365741284075`*^9, 3.8613365801332536`*^9}, 3.861336644184308*^9, {
   3.8613366786128197`*^9, 3.861336726468439*^9}, {3.8613390639883604`*^9, 
   3.8613390659716496`*^9}, {3.86133913413169*^9, 3.861339134945713*^9}, {
   3.8613393082391834`*^9, 3.861339309134165*^9}, {3.861339375345129*^9, 
   3.861339401814641*^9}, {3.861877690976696*^9, 3.861877694807674*^9}, {
   3.8824367875808306`*^9, 3.8824368108228207`*^9}, {3.8824368506575613`*^9, 
   3.8824368718575583`*^9}, {3.8824373148858566`*^9, 3.8824373316476526`*^9}, 
   3.8824373802641897`*^9, {3.8824374499593067`*^9, 3.882437496170046*^9}, {
   3.88243756979754*^9, 3.8824375860848484`*^9}, 3.8824376425356026`*^9, {
   3.8824377668234863`*^9, 3.8824378502869186`*^9}, {3.882503308377166*^9, 
   3.8825033288323917`*^9}, 3.882518688087514*^9, {3.8825187376657696`*^9, 
   3.8825187808449345`*^9}, {3.8825188375973215`*^9, 
   3.8825188894312897`*^9}, {3.8825189620860333`*^9, 3.8825189735793056`*^9}, 
   3.8825233008607564`*^9},ExpressionUUID->"0f2c3c93-9873-46ba-b392-\
68129404a697"]
}, Closed]],

Cell[CellGroupData[{

Cell["Batch model and plot data", "Subsection",
 CellChangeTimes->{{3.861094325647352*^9, 3.861094332852316*^9}, {
   3.8611607637065372`*^9, 3.861160766766086*^9}, 3.8611806691315174`*^9, {
   3.861336752519664*^9, 3.8613367529554267`*^9}, {3.8613393400994205`*^9, 
   3.8613393404298763`*^9}},ExpressionUUID->"cb9ceb8f-d7e0-4cb2-b2a7-\
b52c3faae5fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"k", ",", "c", ",", "r", ",", "b", ",", "c0"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subplot", "=", "\"\<D\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"par", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"$DefaultStochasticParamaters", ",", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<Cost\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "30"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<BaseMetabolicCost\>\"", "->", "100"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<QSThreshold\>\"", "->", "3"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<CooperationBenefit\>\"", "->", "0.6"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<GridSize\>\"", "->", "300"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<GenerationNumber\>\"", "->", "10"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<RandomSeed\>\"", "->", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<InitialFrequency\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", 
           ",", "0"}], "}"}]}]}], " ", "\[IndentingNewLine]", "|>"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"$StochasticParameterSet", "@", "subplot"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{"\"\<DiffusionStep\>\"", "->", "10"}], "|>"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stamp", "=", 
   RowBox[{"\"\<QS_Diffusion_Fig\>\"", "<>", "subplot", "<>", "\"\<_\>\"", "<>", 
    RowBox[{"parameterStamp", "[", 
     RowBox[{
      RowBox[{"stochasticToAnalyticParameters", "@", "par"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "c", ",", "r", ",", "b", ",", "c0"}], "}"}]}], "]"}],
     "<>", "\"\<_grid_\>\"", "<>", 
    RowBox[{"ToString", "@", "step"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dir", "=", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
     "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\>\"", ",", "stamp"}],
      "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8610943395258183`*^9, 3.861094537955598*^9}, {
   3.8610951766183167`*^9, 3.861095239006422*^9}, {3.8610952839959354`*^9, 
   3.8610953083090477`*^9}, {3.8610954360944614`*^9, 
   3.8610955342885046`*^9}, {3.8610955847283473`*^9, 3.86109566145392*^9}, {
   3.861096610252472*^9, 3.8610966133635983`*^9}, {3.8610966480568733`*^9, 
   3.8610966944455366`*^9}, 3.861097091557826*^9, 3.8610972275062237`*^9, {
   3.861158771557372*^9, 3.8611587720550666`*^9}, {3.861159819616567*^9, 
   3.8611598225901575`*^9}, {3.8611598870317917`*^9, 3.861159889261606*^9}, 
   3.8611602403195662`*^9, {3.861160392720628*^9, 3.861160488622713*^9}, {
   3.861160561997671*^9, 3.8611605983469267`*^9}, 3.8611622566437674`*^9, 
   3.8611650786320295`*^9, {3.8611695996637397`*^9, 3.8611696182397957`*^9}, {
   3.8611698359198217`*^9, 3.8611698522678404`*^9}, {3.8611715497694736`*^9, 
   3.861171556720086*^9}, 3.8611715925473456`*^9, {3.861172018593642*^9, 
   3.8611720245400033`*^9}, {3.861177144184074*^9, 3.8611771449241*^9}, {
   3.861178739481017*^9, 3.8611788435456495`*^9}, {3.8611789683893785`*^9, 
   3.8611791525913315`*^9}, {3.8611792170815105`*^9, 
   3.8611792406818056`*^9}, {3.8611793124692016`*^9, 
   3.8611793640386424`*^9}, {3.8611795417502837`*^9, 3.861179551808081*^9}, {
   3.8611796079340324`*^9, 3.8611796409481773`*^9}, {3.8611797039984856`*^9, 
   3.8611798253523045`*^9}, {3.8611799186231513`*^9, 3.8611799313608284`*^9}, 
   3.861179969538169*^9, {3.861180002657691*^9, 3.8611800027253337`*^9}, {
   3.8611802099355545`*^9, 3.8611802185679593`*^9}, {3.8611802692633276`*^9, 
   3.8611803427253027`*^9}, {3.861180688132182*^9, 3.8611807151008606`*^9}, {
   3.86118075352398*^9, 3.8611809079927464`*^9}, {3.86118136988585*^9, 
   3.861181403850134*^9}, {3.8611814538589854`*^9, 3.8611815277608833`*^9}, 
   3.861181671834257*^9, {3.861181955554422*^9, 3.8611819707368536`*^9}, 
   3.8611821819230905`*^9, {3.86119136444516*^9, 3.8611913671573467`*^9}, {
   3.8611914475442953`*^9, 3.8611914489299717`*^9}, {3.861191546732259*^9, 
   3.861191616375242*^9}, 3.8611917316524067`*^9, {3.8611917963964767`*^9, 
   3.8611918207595215`*^9}, 3.861200822763833*^9, 3.861200978705472*^9, 
   3.861201146732757*^9, {3.861243665713303*^9, 3.8612437066669054`*^9}, 
   3.861334493853281*^9, {3.8613366691580763`*^9, 3.8613366750327034`*^9}, {
   3.861336733859973*^9, 3.861336735160889*^9}, {3.8618777165867505`*^9, 
   3.8618777606016574`*^9}, 3.8618784943746223`*^9, 3.8618795257445345`*^9, 
   3.8618827222986794`*^9, {3.861883425298263*^9, 3.861883438856841*^9}, {
   3.8618834803876824`*^9, 3.8618835336043186`*^9}, {3.861883627044366*^9, 
   3.861883627942353*^9}, 3.8618837898627105`*^9, {3.861883954235074*^9, 
   3.8618839599046907`*^9}, {3.861884100408655*^9, 3.8618841308547106`*^9}, 
   3.861884884544546*^9, 3.861884929715476*^9, 3.861884975839054*^9, {
   3.8618853515802274`*^9, 3.861885379946742*^9}, {3.8618854200458374`*^9, 
   3.86188548473512*^9}},
 CellLabel->
  "In[447]:=",ExpressionUUID->"1ec656ad-7a97-4251-9f3f-4e90a43c4cd4"],

Cell[CellGroupData[{

Cell["Run major trajectory", "Subsubsection",
 CellChangeTimes->{{3.861884183118681*^9, 
  3.8618841892043085`*^9}},ExpressionUUID->"56ec83cc-4f01-49f6-971c-\
c7251a70eae6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aStamp", "=", 
   RowBox[{"\"\<QS_Diffusion_Fig\>\"", "<>", "subplot", "<>", "\"\<_\>\"", "<>", 
    RowBox[{"parameterStamp", "[", 
     RowBox[{
      RowBox[{"stochasticToAnalyticParameters", "@", "par"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "c", ",", "r", ",", "b", ",", "c0"}], "}"}]}], "]"}],
     "<>", "\"\<_major\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"aDir", "=", 
  RowBox[{"FileNameJoin", "@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FileNameDrop", "@", "dir"}], ",", "aStamp"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aPar", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"par", ",", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<GenerationNumber\>\"", "->", "100"}], 
       RowBox[{"(*", "00", "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<RandomSeed\>\"", "->", 
        RowBox[{"RandomInteger", "@", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SuperscriptBox["10", "6"]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<InitialFrequency\>\"", "->", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",",
           "0"}], "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"major", "=", 
   RowBox[{"readModelData", "@", 
    RowBox[{"runModel", "[", 
     RowBox[{"aDir", ",", "aPar", ",", 
      RowBox[{"\"\<Verbose\>\"", "->", "False"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"$save", ",", 
   RowBox[{"Save", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "@", 
      RowBox[{"{", 
       RowBox[{"aDir", ",", 
        RowBox[{"aStamp", "<>", "\"\<_trajectories.wl\>\""}]}], "}"}]}], ",", 
     "major"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8618842227724533`*^9, 3.8618843578142786`*^9}, {
   3.861884398507818*^9, 3.8618844295747433`*^9}, 3.861884496837405*^9, {
   3.8618845422148886`*^9, 3.861884565418494*^9}, {3.8618846802479463`*^9, 
   3.861884748055171*^9}, {3.861884792529081*^9, 3.8618848491236377`*^9}, 
   3.8618849453889246`*^9, 3.861884980221913*^9, {3.8618853452739024`*^9, 
   3.8618854276200457`*^9}},
 CellLabel->
  "In[453]:=",ExpressionUUID->"dde99155-543d-44d2-97df-0087e878db91"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot major trajectory", "Subsubsection",
 CellChangeTimes->{{3.861884862785324*^9, 
  3.8618848670714226`*^9}},ExpressionUUID->"9d0b399a-f38c-4d2e-8faa-\
4dadbde7ea8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$save", "=", 
   RowBox[{"!", "False"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GrayLevel", "@", ".5"}], ",", "$SimplexBoundary"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", "$SimplexCornerLabels"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"$majorTrajectoryStyle", ",", "major"}], 
       RowBox[{"(*", 
        RowBox[{"/.", 
         RowBox[{"Line", "->", "Arrow"}]}], "*)"}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "$SimplexPlotRange"}], ",", 
    RowBox[{"Background", "\[Rule]", "White"}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", "20"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "$SimplexAspectRatio"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotLabel", "->", "aStamp"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"$save", ",", 
   RowBox[{"PathButton", "@", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "@", 
       RowBox[{"{", 
        RowBox[{"aDir", ",", 
         RowBox[{"aStamp", "<>", "\"\<.jpg\>\""}]}], "}"}]}], ",", 
      RowBox[{"Rasterize", "@", "plot"}], ",", "\"\<JPEG\>\"", ",", 
      RowBox[{"RasterSize", "\[Rule]", "3000"}]}], "]"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.8618842227724533`*^9, 3.8618843578142786`*^9}, {
   3.861884398507818*^9, 3.8618844295747433`*^9}, 3.861884496837405*^9, 
   3.8618845422148886`*^9, {3.8618845822055044`*^9, 3.8618846036377897`*^9}, 
   3.86188475038342*^9, {3.861884795662613*^9, 3.8618847959706144`*^9}, {
   3.8618848414156637`*^9, 3.861884850929997*^9}, 3.8743089948561087`*^9, 
   3.8824376462499037`*^9},ExpressionUUID->"74701eb1-ccdb-4a60-a4ee-\
dd9afeb9dc6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run batched data", "Subsubsection",
 CellChangeTimes->{{3.8618837923905983`*^9, 
  3.861883794729737*^9}},ExpressionUUID->"cf578d56-02aa-4734-a1a8-\
e882dfdea9cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$save", "=", 
    RowBox[{"!", "False"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{"ternaryGridCoordinate", "[", 
    RowBox[{
     RowBox[{"1", "/", "step"}], ",", ".012"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"trajectories", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z", ",", "aPar", ",", "aDir"}], "}"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "=", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"pts", "[", 
               RowBox[{"[", "c", "]"}], "]"}], "*", "1000"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"aDir", "=", 
            RowBox[{"FileNameJoin", "@", 
             RowBox[{"{", 
              RowBox[{"dir", ",", 
               RowBox[{"\"\<QS_grid_(\>\"", "<>", 
                RowBox[{"ToString", "@", "c"}], "<>", "\"\<)_\>\"", "<>", 
                RowBox[{"ToString", "@", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}]}], "}"}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"aPar", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"par", ",", 
              RowBox[{"<|", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<GenerationNumber\>\"", "->", "10"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<RandomSeed\>\"", "->", 
                 RowBox[{"RandomInteger", "@", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    SuperscriptBox["10", "6"]}], "}"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<InitialFrequency\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{
                  "x", ",", "0", ",", "0", ",", "0", ",", "y", ",", "z", ",", 
                   "0", ",", "0"}], "}"}]}]}], "\[IndentingNewLine]", 
               "|>"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"readModelData", "@", 
            RowBox[{"runModel", "[", 
             RowBox[{"aDir", ",", "aPar", ",", 
              RowBox[{"\"\<Verbose\>\"", "->", "False"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", 
          RowBox[{"Length", "@", "pts"}]}], "}"}]}], "]"}]}], ";"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Row", "@", 
     RowBox[{"{", 
      RowBox[{"\"\<Iteration #\>\"", ",", 
       RowBox[{"Dynamic", "@", "c"}], ",", "\"\< of \>\"", ",", 
       RowBox[{"Length", "@", "pts"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"$save", ",", 
   RowBox[{"Save", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FileNameJoin", "@", 
       RowBox[{"{", 
        RowBox[{"dir", ",", "stamp"}], "}"}]}], "<>", 
      "\"\<_trajectories.wl\>\""}], ",", "trajectories"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8610943395258183`*^9, 3.861094537955598*^9}, {
   3.8610951766183167`*^9, 3.861095239006422*^9}, {3.8610952839959354`*^9, 
   3.8610953083090477`*^9}, {3.8610954360944614`*^9, 
   3.8610955342885046`*^9}, {3.8610955847283473`*^9, 3.86109566145392*^9}, {
   3.861096610252472*^9, 3.8610966133635983`*^9}, {3.8610966480568733`*^9, 
   3.8610966944455366`*^9}, 3.861097091557826*^9, 3.8610972275062237`*^9, {
   3.861158771557372*^9, 3.8611587720550666`*^9}, {3.861159819616567*^9, 
   3.8611598225901575`*^9}, {3.8611598870317917`*^9, 3.861159889261606*^9}, 
   3.8611602403195662`*^9, {3.861160392720628*^9, 3.861160488622713*^9}, {
   3.861160561997671*^9, 3.8611605983469267`*^9}, 3.8611622566437674`*^9, 
   3.8611650786320295`*^9, {3.8611695996637397`*^9, 3.8611696182397957`*^9}, {
   3.8611698359198217`*^9, 3.8611698522678404`*^9}, {3.8611715497694736`*^9, 
   3.861171556720086*^9}, 3.8611715925473456`*^9, {3.861172018593642*^9, 
   3.8611720245400033`*^9}, {3.861177144184074*^9, 3.8611771449241*^9}, {
   3.861178739481017*^9, 3.8611788435456495`*^9}, {3.8611789683893785`*^9, 
   3.8611791525913315`*^9}, {3.8611792170815105`*^9, 
   3.8611792406818056`*^9}, {3.8611793124692016`*^9, 
   3.8611793640386424`*^9}, {3.8611795417502837`*^9, 3.861179551808081*^9}, {
   3.8611796079340324`*^9, 3.8611796409481773`*^9}, {3.8611797039984856`*^9, 
   3.8611798253523045`*^9}, {3.8611799186231513`*^9, 3.8611799313608284`*^9}, 
   3.861179969538169*^9, {3.861180002657691*^9, 3.8611800027253337`*^9}, {
   3.8611802099355545`*^9, 3.8611802185679593`*^9}, {3.8611802692633276`*^9, 
   3.8611803427253027`*^9}, {3.861180688132182*^9, 3.8611807151008606`*^9}, {
   3.86118075352398*^9, 3.8611809079927464`*^9}, {3.86118136988585*^9, 
   3.861181403850134*^9}, {3.8611814538589854`*^9, 3.8611815277608833`*^9}, 
   3.861181671834257*^9, {3.861181955554422*^9, 3.8611819707368536`*^9}, 
   3.8611821819230905`*^9, {3.86119136444516*^9, 3.8611913671573467`*^9}, {
   3.8611914475442953`*^9, 3.8611914489299717`*^9}, {3.861191546732259*^9, 
   3.861191616375242*^9}, 3.8611917316524067`*^9, {3.8611917963964767`*^9, 
   3.8611918207595215`*^9}, 3.861200822763833*^9, 3.861200978705472*^9, 
   3.861201146732757*^9, {3.861243665713303*^9, 3.8612437066669054`*^9}, 
   3.861334493853281*^9, {3.8613366691580763`*^9, 3.8613366750327034`*^9}, {
   3.861336733859973*^9, 3.861336735160889*^9}, {3.8618777165867505`*^9, 
   3.8618777606016574`*^9}, 3.8618784943746223`*^9, 3.8618795257445345`*^9, 
   3.8618827222986794`*^9, {3.861883425298263*^9, 3.861883438856841*^9}, {
   3.8618834803876824`*^9, 3.8618835336043186`*^9}, {3.861883627044366*^9, 
   3.861883627942353*^9}, 3.8618837898627105`*^9, {3.861883961858447*^9, 
   3.861883962394992*^9}, {3.861884194861964*^9, 
   3.8618842002079344`*^9}},ExpressionUUID->"7fc3e490-a281-4f76-a702-\
b945ef816c89"]
}, Closed]],

Cell[CellGroupData[{

Cell["Read batched data", "Subsubsection",
 CellChangeTimes->{{3.861883777251768*^9, 
  3.8618837818944917`*^9}},ExpressionUUID->"ce03fbe9-56cf-48a5-8b9c-\
d784a46d6a6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$save", "=", 
    RowBox[{"!", "False"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dirs", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", 
       RowBox[{"{", "dir", "}"}]}], "]"}], ",", 
     RowBox[{"_", "?", "DirectoryQ"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"trajectories", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"readModelData", "@", 
         RowBox[{"dirs", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "dirs"}]}], "}"}]}], "]"}]}], ";"}], ",", 
    RowBox[{"Row", "@", 
     RowBox[{"{", 
      RowBox[{"\"\<Iteration #\>\"", ",", 
       RowBox[{"Dynamic", "@", "i"}], ",", "\"\< of \>\"", ",", 
       RowBox[{"Length", "@", "dirs"}]}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"$save", ",", 
   RowBox[{"Save", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FileNameJoin", "@", 
       RowBox[{"{", 
        RowBox[{"dir", ",", "stamp"}], "}"}]}], "<>", 
      "\"\<_trajectories.wl\>\""}], ",", "trajectories"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8618838143600416`*^9, 3.861883835399184*^9}, {
  3.861883868675804*^9, 3.8618839353826213`*^9}, {3.8618839661053495`*^9, 
  3.8618840066924124`*^9}, {3.861884063469633*^9, 3.8618840673893676`*^9}, {
  3.861884122528962*^9, 3.861884122647509*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"b7ee838a-5dcf-49ce-b1c3-b522c1596a1c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot batched data", "Subsubsection",
 CellChangeTimes->{{3.8618838057169456`*^9, 
  3.861883807895048*^9}},ExpressionUUID->"658ebd98-1ae1-4f75-9d60-\
1ae57977b71d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$save", "=", 
   RowBox[{"!", "False"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GrayLevel", "@", ".5"}], ",", "$SimplexBoundary"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", "$SimplexCornerLabels"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsolutePointSize", "@", "1"}], ",", "Red"}], "]"}], ",", 
        RowBox[{"Point", "@", 
         RowBox[{"ternaryToSimplex", "@", "pts"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "@", "1"}], ",", 
          RowBox[{"CapForm", "@", "\"\<Round\>\""}], ",", 
          RowBox[{"JoinForm", "@", "\"\<Round\>\""}]}], "]"}], ",", 
        "trajectories"}], 
       RowBox[{"(*", 
        RowBox[{"/.", 
         RowBox[{"Line", "->", "Arrow"}]}], "*)"}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "$SimplexPlotRange"}], ",", 
    RowBox[{"Background", "\[Rule]", "White"}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", "20"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "$SimplexAspectRatio"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotLabel", "->", "stamp"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"$save", ",", 
   RowBox[{"PathButton", "@", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FileNameJoin", "@", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "stamp"}], "}"}]}], "<>", "\"\<.jpg\>\""}], ",", 
      
      RowBox[{"Rasterize", "@", "plot"}], ",", "\"\<JPEG\>\"", ",", 
      RowBox[{"RasterSize", "\[Rule]", "3000"}]}], "]"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.861171685684511*^9, 3.8611718376962504`*^9}, {
   3.8611719219612007`*^9, 3.8611720292826185`*^9}, 3.861172087947462*^9, 
   3.8611721552135086`*^9, {3.8611721958149853`*^9, 3.8611723243278885`*^9}, 
   3.8611771242812977`*^9, {3.8611777497398615`*^9, 3.861177869482463*^9}, {
   3.8611798520367975`*^9, 3.8611798733365335`*^9}, {3.861180134093492*^9, 
   3.8611801388617096`*^9}, {3.8611814159590425`*^9, 3.86118144613344*^9}, {
   3.8612006581425*^9, 3.861200705078928*^9}, {3.8612007474384546`*^9, 
   3.8612007531695213`*^9}, {3.861243439543538*^9, 3.8612434638856792`*^9}, {
   3.8618833625443945`*^9, 3.8618833654298935`*^9}, {3.8618834229459333`*^9, 
   3.8618834231672287`*^9}, {3.861884139752659*^9, 3.861884140148513*^9}, {
   3.88243765189843*^9, 
   3.8824376529812274`*^9}},ExpressionUUID->"08e3ebcd-c10e-4cf5-b7dd-\
4d925e412c66"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Replot .wl data (Fig. 4, Row 1, 2)", "Subsection",
 CellChangeTimes->{{3.8612444478507195`*^9, 3.861244448115668*^9}, {
   3.861246541038169*^9, 3.8612465487808037`*^9}, 3.886056468072049*^9, {
   3.8860627876511374`*^9, 
   3.886062791790732*^9}},ExpressionUUID->"acd0cbe2-7ea8-4f4c-ae56-\
f37543dc4932"],

Cell[TextData[{
 "Calculates the vector of the initial trajectory, as the difference ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "10"], "-", 
    SubscriptBox["p", "1"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8d2a1ed7-478a-40f1-8d2d-28103f0f2485"],
 ".  "
}], "Text",
 CellChangeTimes->{{3.861249647072509*^9, 
  3.861249707132799*^9}},ExpressionUUID->"9554146f-bc44-474a-826c-\
732f042a093a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$majorTrajectoryStyle", "=", 
   RowBox[{"Directive", "[", 
    RowBox[{"Red", ",", 
     RowBox[{"AbsoluteThickness", "@", "4"}], ",", 
     RowBox[{"CapForm", "@", "\"\<Round\>\""}], ",", 
     RowBox[{"JoinForm", "@", "\"\<Round\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$save", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "dataDir", "=", "\"\<C:\\\\Zac\\\\Science\\\\Quorum sensing\\\\Data\>\""}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Row", " ", "2"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fieldLineFiles", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<220518 Fig 2 Row \
2\\\\QS_Diffusion_FigA_k=3_c=0.3_r=0.01_b=0.3_c0=1._grid_20\\\\QS_Diffusion_\
FigA_k=3_c=0.3_r=0.01_b=0.3_c0=1._grid_20_trajectories.wl\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<220518 Fig 2 Row \
2\\\\QS_Diffusion_FigB_k=3_c=0.3_r=0.01_b=0.5_c0=1._grid_20\\\\QS_Diffusion_\
FigB_k=3_c=0.3_r=0.01_b=0.5_c0=1._grid_20_trajectories.wl\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<220518 Fig 2 Row \
2\\\\QS_Diffusion_FigC_k=3_c=0.3_r=0.2_b=0.65_c0=1._grid_20\\\\QS_Diffusion_\
FigC_k=3_c=0.3_r=0.2_b=0.65_c0=1._grid_20_trajectories.wl\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<220518 Fig 2 Row \
2\\\\QS_Diffusion_FigD_k=3_c=0.3_r=0.01_b=0.6_c0=1._grid_20\\\\QS_Diffusion_\
FigD_k=3_c=0.3_r=0.01_b=0.6_c0=1._grid_20_trajectories.wl\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"majorTrajectoryFiles", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<220518 Fig 2 Row \
2\\\\QS_Diffusion_FigA_k=3_c=0.3_r=0.01_b=0.3_c0=1._major\\\\QS_Diffusion_\
FigA_k=3_c=0.3_r=0.01_b=0.3_c0=1._major_trajectories.wl\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<220518 Fig 2 Row \
2\\\\QS_Diffusion_FigB_k=3_c=0.3_r=0.01_b=0.5_c0=1._major\\\\QS_Diffusion_\
FigB_k=3_c=0.3_r=0.01_b=0.5_c0=1._major_trajectories.wl\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<220518 Fig 2 Row \
2\\\\QS_Diffusion_FigC_k=3_c=0.3_r=0.2_b=0.65_c0=1._major\\\\QS_Diffusion_\
FigC_k=3_c=0.3_r=0.2_b=0.65_c0=1._major_trajectories.wl\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<220518 Fig 2 Row \
2\\\\QS_Diffusion_FigD_k=3_c=0.3_r=0.01_b=0.6_c0=1._major\\\\QS_Diffusion_\
FigD_k=3_c=0.3_r=0.01_b=0.6_c0=1._major_trajectories.wl\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"read", "=", 
    RowBox[{"Line", "@*", "First", "@*", "Get"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Row", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"fieldLineFiles", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<220510 Fig 2 Row \
1\\\\QS_A_220510-215228_k=3_c=0.3_r=0.01_b=0.3_c0=1._grid_20\\\\QS_Cue_\
Spatial_K=3_R=01_S=00_Diff=0.0.out_trajectories.wl\>\"", ",", 
       "\[IndentingNewLine]", 
       "\"\<220510 Fig 2 Row \
1\\\\QS_B_220510-214939_k=3_c=0.3_r=0.01_b=0.5_c0=1._grid_20\\\\QS_Cue_\
Spatial_K=3_R=01_S=00_Diff=0.0.out_trajectories.wl\>\"", ",", 
       "\[IndentingNewLine]", 
       "\"\<220510 Fig 2 Row \
1\\\\QS_C_220510-214704_k=3_c=0.3_r=0.2_b=0.65_c0=1._grid_20\\\\QS_Cue_\
Spatial_K=3_R=01_S=00_Diff=0.0.out_trajectories.wl\>\"", ",", 
       "\[IndentingNewLine]", 
       "\"\<220510 Fig 2 Row \
1\\\\QS_D_220510-191702_k=3_c=0.3_r=0.01_b=0.6_c0=1._grid_20\\\\QS_Cue_\
Spatial_K=3_R=01_S=00_Diff=0.0.out_trajectories.wl\>\""}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"majorTrajectoryFiles", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<220506 Tom Fig5 \
spatial\\\\Fig5a_Spatial_K=3_C=30_R=1_b=0.3_Diff=0.0.out\>\"", ",", 
       "\[IndentingNewLine]", 
       "\"\<220506 Tom Fig5 \
spatial\\\\Fig5b_Spatial_K=3_C=30_R=1_b=0.5_Diff=0.0.out\>\"", ",", 
       "\[IndentingNewLine]", 
       "\"\<220506 Tom Fig5 \
spatial\\\\Fig5c_Spatial_K=3_C=30_R=20_b=0.65_Diff=0.0.out\>\"", ",", 
       "\[IndentingNewLine]", 
       "\"\<220506 Tom Fig5 \
spatial\\\\Fig5d_Spatial_K=3_C=30_R=1_b=0.6_Diff=0.0.out\>\""}], "}"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"read", "=", 
     RowBox[{"Line", "@*", "First", "@*", "readModelData"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"field", ",", 
         RowBox[{"major", "=", 
          RowBox[{"read", "@", "#2"}]}], ",", 
         RowBox[{"stamp", "=", 
          RowBox[{"FileBaseName", "@", "#1"}]}], ",", "plot"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"field", "=", 
         RowBox[{
          RowBox[{"Get", "@", "#1"}], "/.", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"pts_", ",", "___"}], "]"}], ":>", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "@", "pts"}], ",", 
             RowBox[{
              RowBox[{"pts", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "-", 
              RowBox[{"pts", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"NOTE", ":", " ", 
          RowBox[{"Converts", " ", "tajectory", " ", "to", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"vx", ",", "vy"}], "}"}]}], "}"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"plot", "=", 
         RowBox[{"Echo", "@", 
          RowBox[{"ListStreamPlot", "[", 
           RowBox[{"field", ",", "\[IndentingNewLine]", 
            RowBox[{"RegionFunction", "\[Rule]", "$SimplexRegionFunction"}], 
            ",", 
            RowBox[{"RegionBoundaryStyle", "\[Rule]", "None"}], ",", 
            RowBox[{"RegionFillingStyle", "\[Rule]", "None"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", "$SimplexPlotRange"}], ",", 
            RowBox[{"PlotRangePadding", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Scaled", "@", ".02"}], ",", 
               RowBox[{"Scaled", "@", ".02"}]}], "}"}]}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "5"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "1000"}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "$SimplexAspectRatio"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Background", "\[Rule]", "White"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"Frame", "->", "False"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"PlotLabel", "->", "stamp"}], ","}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"StreamPoints", "\[Rule]", "Fine"}], ",", 
            RowBox[{"StreamStyle", "->", "Thick"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Prolog", "->", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"FaceForm", "@", "None"}], ",", 
                RowBox[{"EdgeForm", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"GrayLevel", "@", ".5"}], ",", 
                   RowBox[{"AbsoluteThickness", "@", "4"}], ",", 
                   RowBox[{"CapForm", "@", "\"\<Round\>\""}], ",", 
                   RowBox[{"JoinForm", "@", "\"\<Round\>\""}]}], "}"}]}], ",",
                 "$SimplexPolygon"}], "}"}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"{", 
                 RowBox[{"Black", ",", "$SimplexCornerLabels"}], "}"}]}], 
               "*)"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Epilog", "->", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Yellow", ",", 
                  RowBox[{"Point", "[", 
                   RowBox[{"First", "/@", "field"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"AbsolutePointSize", "@", "6"}], ",", "Green", ",", 
                  
                  RowBox[{
                   RowBox[{"Point", "@*", "First"}], "/@", "field"}]}], "}"}],
                 ","}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"$majorTrajectoryStyle", ",", "major"}], "}"}], 
              "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"$save", ",", 
          RowBox[{"Echo", "@", 
           RowBox[{"PathButton", "@", 
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"FileNameDrop", "@", "#1"}], ",", 
                 RowBox[{"stamp", "<>", "\"\<_stream.jpg\>\""}]}], "}"}]}], 
              ",", 
              RowBox[{"Rasterize", "@", "plot"}], ",", "\"\<JPEG\>\"", ",", 
              RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}]}]}]}], 
         "]"}]}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FileNameJoin", "@", 
        RowBox[{"{", 
         RowBox[{"dataDir", ",", "#"}], "}"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"fieldLineFiles", ",", "majorTrajectoryFiles"}], "}"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.861244449443076*^9, 3.8612445183245077`*^9}, {
   3.86124456491165*^9, 3.861244596045188*^9}, {3.861244937298221*^9, 
   3.861244965167389*^9}, {3.8612450379299574`*^9, 3.861245041095724*^9}, 
   3.861245120841441*^9, {3.8612451515265703`*^9, 3.8612451723460484`*^9}, {
   3.8612455592737913`*^9, 3.861245594273346*^9}, {3.86124629392313*^9, 
   3.8612466122116623`*^9}, {3.8612470916737814`*^9, 
   3.8612472815128365`*^9}, {3.86124877828218*^9, 3.861248808987383*^9}, {
   3.8612488411420155`*^9, 3.8612489047826834`*^9}, {3.861248944244626*^9, 
   3.8612490302006197`*^9}, {3.8612490992112446`*^9, 
   3.8612492477524447`*^9}, {3.8612493178990836`*^9, 
   3.8612493461013975`*^9}, {3.8612494334116993`*^9, 3.8612494336737523`*^9}, 
   3.8612494991411037`*^9, {3.86188502525216*^9, 3.861885204769704*^9}, {
   3.8618852416947813`*^9, 3.861885266790841*^9}, {3.8738805205066185`*^9, 
   3.8738805269053288`*^9}, 3.8738805685385375`*^9, 3.874309038073008*^9, 
   3.882437657365881*^9, {3.882523373811624*^9, 3.8825233743654885`*^9}, {
   3.8860526156440425`*^9, 3.886052715008894*^9}, {3.8860527672246504`*^9, 
   3.886052784498563*^9}, {3.8860529874983425`*^9, 3.886052998588378*^9}, {
   3.8860530760657454`*^9, 3.886053076846659*^9}, {3.8860531091266546`*^9, 
   3.8860531260727854`*^9}, {3.886053187327565*^9, 3.886053220538808*^9}, {
   3.8860532538167458`*^9, 3.8860532557380347`*^9}, {3.88605336775397*^9, 
   3.8860534100002813`*^9}, {3.8860534634969797`*^9, 3.886053481842097*^9}, {
   3.8860535160737147`*^9, 3.886053519183563*^9}, {3.8860535543671227`*^9, 
   3.8860535592826324`*^9}, {3.8860535948382406`*^9, 
   3.8860535969679193`*^9}, {3.886053667821843*^9, 3.8860537081348076`*^9}, {
   3.886053742624449*^9, 3.8860537823795424`*^9}, {3.886053815125058*^9, 
   3.8860538337797413`*^9}, {3.886053868265214*^9, 3.8860538698355584`*^9}, {
   3.886053903290594*^9, 3.886053926136994*^9}, {3.886054026274663*^9, 
   3.8860540758283925`*^9}, {3.8860541062222433`*^9, 3.886054169227205*^9}, {
   3.886054206701166*^9, 3.886054386198097*^9}, {3.8860544319097233`*^9, 
   3.8860545213999915`*^9}, {3.8860546368842144`*^9, 
   3.8860546473062134`*^9}, {3.886055312220729*^9, 3.8860553264885287`*^9}, {
   3.8860560014830513`*^9, 3.8860560502996917`*^9}, 3.8860561022691994`*^9, {
   3.8860564180079346`*^9, 
   3.886056423738775*^9}},ExpressionUUID->"3a76dfa4-1caa-47ac-938f-\
f1825dac09b2"]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1141.2, 549.6},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>1. Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (June 3, 2023)",
StyleDefinitions->"ReverseColor.nb",
ExpressionUUID->"3948b473-984c-4509-9d60-6412dd0cfe20"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 278, 6, 160, "Title",ExpressionUUID->"70d7690e-4dc0-4eb2-a4be-733c3bf31cac"],
Cell[860, 30, 264, 6, 38, "Text",ExpressionUUID->"50f96ca6-1b50-46d9-84e5-81dd301c6c9b"],
Cell[1127, 38, 258, 5, 38, "Text",ExpressionUUID->"a21ef56f-a7df-47a5-a8c8-81d8e4a55f51"],
Cell[1388, 45, 432, 11, 142, "Text",ExpressionUUID->"863d7be9-c337-4100-8a53-5276d881a30d"],
Cell[CellGroupData[{
Cell[1845, 60, 237, 5, 67, "Section",ExpressionUUID->"29c07cb6-1388-4d0c-b2da-859cc1f93271"],
Cell[2085, 67, 418, 8, 38, "Text",ExpressionUUID->"cbb891d0-c635-4351-ad2b-d133d3c07d5a"],
Cell[2506, 77, 669, 16, 32, "Item",ExpressionUUID->"2086680c-92a1-4ef2-92d9-5f09756b2de2"],
Cell[3178, 95, 928, 25, 32, "Item",ExpressionUUID->"268846a2-de3b-4a74-94de-266fb1d06774"],
Cell[4109, 122, 751, 20, 32, "Item",ExpressionUUID->"339474ea-7745-4a4a-ac08-04f3605ef33e"],
Cell[4863, 144, 627, 15, 32, "Item",ExpressionUUID->"9b54de51-51b9-44a1-9178-fc68f6b0075b"],
Cell[5493, 161, 735, 19, 32, "Item",ExpressionUUID->"c86d9cf2-e412-4f48-9554-343a4a95e657"],
Cell[6231, 182, 718, 16, 32, "Item",ExpressionUUID->"bc4501cc-a909-4595-a279-e4c411289739"],
Cell[6952, 200, 520, 11, 32, "Item",ExpressionUUID->"1799c1da-d2f7-4bbd-ac6c-9eb78cfb60e8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7509, 216, 343, 5, 67, "Section",ExpressionUUID->"e534b636-9ea2-4e8e-9d87-2d8b2c719afa"],
Cell[7855, 223, 567, 14, 32, "Item",ExpressionUUID->"f87658d0-34b4-4a47-a739-9bb22d0f674f"],
Cell[8425, 239, 377, 8, 32, "Item",ExpressionUUID->"9c0393a7-193a-45a1-9ccc-319828ab561b"],
Cell[8805, 249, 301, 6, 32, "Item",ExpressionUUID->"b039fcc2-020b-4973-a2fe-1e91ffd2dd92"],
Cell[CellGroupData[{
Cell[9131, 259, 161, 3, 54, "Subsection",ExpressionUUID->"3441cbe2-3af0-4df4-aeea-ef08821e10c8"],
Cell[9295, 264, 24314, 566, 1326, "Input",ExpressionUUID->"abbfc219-d2db-4e84-9f80-a1ab6a4479eb",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33658, 836, 174, 3, 67, "Section",ExpressionUUID->"e041ea1c-78ce-4044-bee5-1c7d582d2471"],
Cell[33835, 841, 978, 25, 32, "Item",ExpressionUUID->"5b6f323f-0447-4d33-b391-a505ed746527"],
Cell[34816, 868, 330, 5, 32, "Item",ExpressionUUID->"44f0b048-050e-4f3c-9387-254d37db0f76"],
Cell[35149, 875, 908, 22, 32, "Item",ExpressionUUID->"23c64fba-9dc1-40d5-934c-8ab4210e12ca"],
Cell[36060, 899, 609, 15, 32, "Item",ExpressionUUID->"688b2df6-417b-4126-ac21-19975288786f"],
Cell[36672, 916, 773, 15, 32, "Item",ExpressionUUID->"d8a57532-619e-4bb3-94dc-ba126d848317"],
Cell[37448, 933, 1435, 37, 32, "Item",ExpressionUUID->"0a90f1be-d92e-4de0-be71-c04995dfb716"],
Cell[CellGroupData[{
Cell[38908, 974, 161, 3, 54, "Subsection",ExpressionUUID->"da53e5d3-a203-4658-be4c-c7425d3f10d0"],
Cell[39072, 979, 12299, 307, 692, "Input",ExpressionUUID->"4cb064fb-5714-4cd8-9464-99c05db5a5e0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[51408, 1291, 156, 3, 38, "Subsection",ExpressionUUID->"d2cdc98f-99e0-4f93-b2e7-d5d42a756b9e"],
Cell[51567, 1296, 4639, 130, 390, "Input",ExpressionUUID->"ea293745-7669-49a3-86b1-fab1880f5ada"]
}, Closed]],
Cell[CellGroupData[{
Cell[56243, 1431, 173, 3, 38, "Subsection",ExpressionUUID->"15023f5c-8254-4db7-873d-c9e31942ad91"],
Cell[56419, 1436, 11131, 257, 523, "Input",ExpressionUUID->"c2861478-42fa-4316-8126-181eaec65142"]
}, Closed]],
Cell[CellGroupData[{
Cell[67587, 1698, 389, 5, 38, "Subsection",ExpressionUUID->"a217b5a8-5a1e-4bec-8dac-ca8b933dc812"],
Cell[67979, 1705, 28551, 522, 771, "Input",ExpressionUUID->"de87deb4-3513-40f1-8496-ec2745e6ea29"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[96579, 2233, 286, 4, 67, "Section",ExpressionUUID->"e5fde226-5f5e-4939-8dd4-305777cfdc82"],
Cell[96868, 2239, 881, 23, 32, "Item",ExpressionUUID->"17676dcd-917f-4ecb-8f1f-2258baceecd1"],
Cell[CellGroupData[{
Cell[97774, 2266, 210, 4, 54, "Subsection",ExpressionUUID->"02ec88f7-d43b-4d63-b768-2187ce968b75"],
Cell[97987, 2272, 19183, 415, 635, "Input",ExpressionUUID->"2dd1f368-30e7-4800-a5e7-3502d943c42f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[117207, 2692, 424, 6, 38, "Subsection",ExpressionUUID->"e1dcb94a-74b5-4dff-a892-8e966e2a3972"],
Cell[117634, 2700, 10429, 244, 485, "Input",ExpressionUUID->"7e39ba62-bec7-4b95-a76d-148e6646845f"]
}, Closed]],
Cell[CellGroupData[{
Cell[128100, 2949, 389, 5, 38, "Subsection",ExpressionUUID->"fe204cbe-ddf3-4b7c-96b6-ea29b72df94c"],
Cell[128492, 2956, 27448, 504, 752, "Input",ExpressionUUID->"2e9ea5fa-cbe0-4800-8228-9958aa4b8da8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155977, 3465, 399, 6, 54, "Subsection",ExpressionUUID->"cfbb4476-4c23-4b52-9e28-9512fd92390d"],
Cell[156379, 3473, 241, 4, 32, "Item",ExpressionUUID->"f07ac1b0-4c9f-4766-9204-595fdda056b1"],
Cell[CellGroupData[{
Cell[156645, 3481, 269, 6, 32, "Item",ExpressionUUID->"2a6dda3d-f190-4b24-982f-806bddc132d9"],
Cell[156917, 3489, 2056, 52, 86, "Input",ExpressionUUID->"77e63bb4-fa93-4467-9ded-d39338557d7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159010, 3546, 398, 6, 45, "Subsubsection",ExpressionUUID->"57c78dec-8064-4231-870e-ea7c89627251"],
Cell[159411, 3554, 16905, 416, 866, "Input",ExpressionUUID->"7c7ac75e-bec1-45d4-ab6a-d2cd5808e7f4"]
}, Closed]],
Cell[CellGroupData[{
Cell[176353, 3975, 525, 8, 37, "Subsubsection",ExpressionUUID->"5c261de3-2db8-4fd2-90fb-b44de9ca0bef"],
Cell[176881, 3985, 16853, 403, 809, "Input",ExpressionUUID->"c96d02e7-dfbc-4629-a775-caf941aa33dc"]
}, Closed]],
Cell[CellGroupData[{
Cell[193771, 4393, 290, 4, 37, "Subsubsection",ExpressionUUID->"fee68fe1-54d6-4fd1-8f74-071920b858db"],
Cell[194064, 4399, 296, 7, 32, "Item",ExpressionUUID->"3baec400-7f59-4668-a457-e97ee0faa401"],
Cell[CellGroupData[{
Cell[194385, 4410, 644, 17, 32, "Item",ExpressionUUID->"6dcd1545-a8fc-4a2e-a197-75565208b2f0"],
Cell[195032, 4429, 12126, 306, 677, "Input",ExpressionUUID->"c4ce7d8e-8fea-404c-b426-304659b57700"],
Cell[207161, 4737, 7293, 159, 428, "Input",ExpressionUUID->"a4042f45-6529-4ae6-b6fd-af55e542d15c"],
Cell[214457, 4898, 6540, 159, 409, "Input",ExpressionUUID->"53498f5d-46dc-405d-9d77-39dd0d1feb5d"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[221070, 5065, 288, 4, 67, "Section",ExpressionUUID->"c230bbbf-fdb6-43c9-ae5d-cdd6607c1237"],
Cell[CellGroupData[{
Cell[221383, 5073, 161, 3, 54, "Subsection",ExpressionUUID->"b0d4ef7a-a511-4ff8-a707-f5791fc967cf"],
Cell[221547, 5078, 6758, 179, 563, "Input",ExpressionUUID->"3aadb621-a584-4560-a486-33c6fb01fe6b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[228342, 5262, 328, 5, 38, "Subsection",ExpressionUUID->"5673af70-2390-4687-ba5c-ea45ec1134fa"],
Cell[228673, 5269, 54532, 1281, 4094, "Input",ExpressionUUID->"ccf58817-bcb5-4a7f-bf3c-4184e59df603",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[283242, 6555, 159, 3, 38, "Subsection",ExpressionUUID->"5550dfff-2356-4fc5-b19a-3c9cd0f998e1"],
Cell[283404, 6560, 14664, 312, 676, "Input",ExpressionUUID->"bedeaedf-90f6-43e2-91d9-e93a0d5d07b8"]
}, Closed]],
Cell[CellGroupData[{
Cell[298105, 6877, 162, 3, 38, "Subsection",ExpressionUUID->"c5946410-9ed4-4627-ba9b-74fdf7578332"],
Cell[298270, 6882, 15496, 326, 676, "Input",ExpressionUUID->"692c1314-ff39-4117-96d2-e0d811395a42"]
}, Closed]],
Cell[CellGroupData[{
Cell[313803, 7213, 439, 6, 38, "Subsection",ExpressionUUID->"c6ef5b1c-22db-48b4-9e67-38c1b870409d"],
Cell[314245, 7221, 13907, 320, 847, "Input",ExpressionUUID->"fb855bb2-7817-4525-b67a-d33be639b4b0"]
}, Closed]],
Cell[CellGroupData[{
Cell[328189, 7546, 222, 4, 38, "Subsection",ExpressionUUID->"e76bb5f6-b649-4c7d-b8e7-59831f019216"],
Cell[328414, 7552, 12378, 229, 428, "Input",ExpressionUUID->"66b0c4f3-1594-4b0f-994e-7af228c5fe22"],
Cell[340795, 7783, 30798, 620, 1570, "Input",ExpressionUUID->"0a142bf8-ca68-4079-bda9-45955e8b2678"]
}, Closed]],
Cell[CellGroupData[{
Cell[371630, 8408, 226, 4, 38, "Subsection",ExpressionUUID->"da5d2469-f2c6-4011-8ffa-cb07ccedc166"],
Cell[371859, 8414, 4703, 109, 523, "Input",ExpressionUUID->"0f2c3c93-9873-46ba-b392-68129404a697"]
}, Closed]],
Cell[CellGroupData[{
Cell[376599, 8528, 352, 5, 38, "Subsection",ExpressionUUID->"cb9ceb8f-d7e0-4cb2-b2a7-b52c3faae5fa"],
Cell[376954, 8535, 5540, 104, 409, "Input",ExpressionUUID->"1ec656ad-7a97-4251-9f3f-4e90a43c4cd4"],
Cell[CellGroupData[{
Cell[382519, 8643, 173, 3, 45, "Subsubsection",ExpressionUUID->"56ec83cc-4f01-49f6-971c-c7251a70eae6"],
Cell[382695, 8648, 2361, 58, 189, "Input",ExpressionUUID->"dde99155-543d-44d2-97df-0087e878db91"]
}, Open  ]],
Cell[CellGroupData[{
Cell[385093, 8711, 174, 3, 45, "Subsubsection",ExpressionUUID->"9d0b399a-f38c-4d2e-8faa-4dadbde7ea8b"],
Cell[385270, 8716, 2046, 47, 162, "Input",ExpressionUUID->"74701eb1-ccdb-4a60-a4ee-dd9afeb9dc6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[387353, 8768, 169, 3, 45, "Subsubsection",ExpressionUUID->"cf578d56-02aa-4734-a1a8-e882dfdea9cd"],
Cell[387525, 8773, 6235, 128, 311, "Input",ExpressionUUID->"7fc3e490-a281-4f76-a702-b945ef816c89"]
}, Closed]],
Cell[CellGroupData[{
Cell[393797, 8906, 170, 3, 37, "Subsubsection",ExpressionUUID->"ce03fbe9-56cf-48a5-8b9c-d784a46d6a6c"],
Cell[393970, 8911, 1706, 49, 124, "Input",ExpressionUUID->"b7ee838a-5dcf-49ce-b1c3-b522c1596a1c"]
}, Closed]],
Cell[CellGroupData[{
Cell[395713, 8965, 170, 3, 37, "Subsubsection",ExpressionUUID->"658ebd98-1ae1-4f75-9d60-1ae57977b71d"],
Cell[395886, 8970, 2981, 68, 181, "Input",ExpressionUUID->"08e3ebcd-c10e-4cf5-b7dd-4d925e412c66"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[398916, 9044, 311, 5, 38, "Subsection",ExpressionUUID->"acd0cbe2-7ea8-4f4c-ae56-f37543dc4932"],
Cell[399230, 9051, 444, 13, 38, "Text",ExpressionUUID->"9554146f-bc44-474a-826c-732f042a093a"],
Cell[399677, 9066, 12438, 269, 942, "Input",ExpressionUUID->"3a76dfa4-1caa-47ac-938f-f1825dac09b2"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

